<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0065)http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script charset="utf-8" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/probe.js.下载" async="" mod_name="tanxssp-probe"></script><script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/ex" async=""></script><script charset="utf-8" async="" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/tanxssp.js.下载"></script><script type="text/javascript" charset="gbk" id="tanx-s-mm_11220363_1101997_26568831" async="" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/ex(1)"></script>
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/hm.js.下载"></script><script type="text/javascript">
        if (window.location.toString().indexOf("shtml?") > 0) {
            self.location = window.location.toString().replace(window.location.search.toString(), "");
        }
        function doccheckart(json) {
            if (json[0].result == "1") {
                self.location = "http://www.360doc.com/noarticle.aspx";
            }
        }
    </script>
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/jquery1.js.下载" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
        if (navigator.userAgent.indexOf("iPhone") > 0 || navigator.userAgent.indexOf("Android") > 0 || navigator.userAgent.indexOf("iPod") > 0) {  //手机端跳转
            var patt1 = new RegExp("[0-9]*_[0-9]*");
            var url = patt1.exec(location.href);
            if (url != "") {
                self.location = "http://www.360doc.cn/article/" + url + ".html";
            }
        }
    </script>
<meta content="360doc" name="classification"><link rel="alternate" media="only screen and (max-width: 640px)" href="http://www.360doc.cn/article/16002580_513612029.html"><meta content="pointdomain,drools,规则" name="keywords"><meta content="[Drools]JAVA规则引擎(非常好的一篇教程)" name="description"><meta name="mobile-agent" content="format=html5;url=http://www.360doc.cn/article/16002580_513612029.html"><meta content="[Drools]JAVA规则引擎(非常好的一篇教程)drools提供了一些api，可以对当前传入workingMemory中的Fact对象进行修改或者个数的增减，比如上述的update方法，就是将当前的workingMemory中的Message类型的Fact对象进行属性更新，这种操作会触发规则的重新匹配执行，可以理解为Fact对象更新了，所以规则需要重新匹配一遍，那么疑问是之前规则执行过并且修改过的那些Fact对象的属性的数据会不会被重置？" name="360docabstract"><meta content="www.360doc.com" name="author"><title>
[Drools]JAVA规则引擎(非常好的一篇教程)
</title>
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/showarticlefollow20160329.js.下载" type="text/javascript" charset="utf-8"></script>
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/jQuery.md5.min.js.下载" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?d86954201130d615136257dde062a503";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
<link rel="stylesheet" type="text/css" href="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/wzhead-cleaned.css"><link rel="stylesheet" type="text/css" href="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/newArticle20160509.css">
<script type="text/javascript" language="javascript">
        window.onerror = ignoreError;
        function ignoreError() {
            return true;
        }
    </script>
<link href="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/newheader.css" rel="stylesheet" type="text/css"><script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/share.js.下载"></script><script type="text/javascript" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/EssayforIE120425.js.下载"></script><script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/tanxssp.js(1).下载"></script><div style="display: none;"><script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/z_stat.php"></script></div><script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/test-js-idc-ha.js.下载" charset="utf-8" async="" defer=""></script><link href="about:blank" rel="styleSheet" type="text/css"></head>
<body onmouseup="setDragEnd()" onclick="delAllDiv(event)"><iframe src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/acbeacon2.html" style="width: 0px; height: 0px; display: none;"></iframe>
<span id="LayerLogin"></span>
<div style="position: fixed; width: 100%; z-index: 1000;">
<div class="header" style="background-color: #ffffff;">
<div class="header_1">
<a href="http://www.360doc.com/index.html">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/nlogo.jpg" class="f_left"></a>
<div class="mylibrary">
<a id="userInfoUrl" href="http://www.360doc.com/login.aspx?reurl=http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" class="a1">
<div class="h_user">
<img id="divuserinfonew" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/dingtu.gif"><span></span>
</div>
我的图书馆
</a>
<ul class="hm_list hm_account" style="display: none;">
<li><a href="http://www.360doc.com/myindex.aspx">首页</a></li>
<li><a href="http://www.360doc.com/myfiles.aspx?app=1&amp;type=3">馆藏</a></li>
<li><a href="http://www.360doc.com/myreadroom.aspx">阅览室</a></li>
<li><a href="http://www.360doc.com/mycontacts.aspx">通讯录</a></li>
<li><a href="javascript:void(0);" onclick="displaylogin();">退出帐号</a></li>
</ul>
</div>
<div class="headmail f_left" style="display: none;">
<p class="h_icon1" id="newMsg"></p>
<span class="h_border"></span>
<ul class="hm_list" id="msgtips">
<li id="msgicon"><a href="http://www.360doc.com/mymsg.aspx?app=2">查看信箱</a></li>
<li id="sysmsgicon"><a href="http://www.360doc.com/mymsg.aspx?app=9">系统消息</a></li>
<li id="sysicon"><a href="http://www.360doc.com/mymsg.aspx?app=4">官方通知</a></li>
<li class="hm_color2" style="background-color: #f4f4f4"><a href="http://www.360doc.com/mymsg.aspx?app=6">设置</a></li>
</ul>
</div>
<div class="headtalker f_left" style="display: none;">
<p class="h_icon1" id="newDialog"></p>
<span class="h_border"></span>
<ul class="hm_list">
<li id="li1chat"><a href="javascript:void(0)" onclick="initchatnew()">开始对话</a></li>
<li id="li2chat" style="display: none;"><a href="javascript:void(0)" style="color: #141414;">有<span>11</span>人和你对话，<span onclick="initchatnew()" style="color: #4578b4">查看</span>&nbsp;<span onclick="clearinfochat()" style="color: #4578b4">忽略</span></a></li>
<li><a href="http://www.360doc.com/mycontacts.aspx?app=8">历史对话记录</a></li>
<li class="hm_color2" style="background-color: #f4f4f4"><a href="http://www.360doc.com/mycontacts.aspx?app=7">通知设置</a></li>
</ul>
</div>
<a href="http://www.360doc.com/advice.html" target="_blank" class="head_talk f_right">留言交流</a>
<div class="headsearch f_right">
<div class="zcomdiv">
<input type="text" class="headsearch_inp f_left" value="搜文章 找馆友">
<span class="headsearch_btn f_right" id="searchlinkid"></span>
</div>
<div class="headsearch_select" style="display: none;">
<p class="hs_title">请选择搜索范围</p>
<a href="javascript:goSearch();" class="cur">含&nbsp;<span></span>&nbsp;的文章</a>
<a href="javascript:goSearch();">昵称为&nbsp;<span></span>&nbsp;的馆友</a>
<a href="javascript:goSearch();">兴趣为&nbsp;<span></span>&nbsp;的馆友</a>
</div>
</div>
</div>
</div>
<div class="arti_type_shadow" style="display: block;"></div>
</div>
<div style="height: 68px; _height: 0px; width: 100%;"></div>
<div class="clear360doc"></div>
<div class="doc360article_content" style="width: 1016px;">
<div style="height: 90px; padding-top: 13px;">
<script async="" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/adsbygoogle.js.下载"></script><ins class="adsbygoogle" style="display: inline-block; width: 970px; height: 90px" data-ad-client="ca-pub-6625678643128649" data-ad-slot="2709112222"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({ }); </script>
</div>
<p class="clearboth"></p>
<div class="a_left" style="width: 686px;">
<div id="bgchange" style="width: 660px;">
<div class="fontsize_bgcolor_controler">
<div class="a_bgcolor">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/bgcolor.jpg">
<div class="a_colorlist">
<span class="a_color1" onclick="artStatistics(&#39;20-11-1&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
<span class="a_color2" onclick="artStatistics(&#39;20-11-2&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
<span class="a_color3" onclick="artStatistics(&#39;20-11-3&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
<span class="a_color4" onclick="artStatistics(&#39;20-11-4&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
<span class="a_color5" onclick="artStatistics(&#39;20-11-5&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
<span class="a_color6 cur" onclick="artStatistics(&#39;20-11-6&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/yes.gif"></span>
</div>
</div>
<div class="a_fontsize">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/fontSize.jpg">
<div class="fschange">
<label>
<input type="radio" name="font_Size" id="" value="18" onclick="artStatistics(&#39;20-10-1&#39;);">大
</label>
&nbsp;
<label>
<input type="radio" name="font_Size" id="" value="16" onclick="artStatistics(&#39;20-10-2&#39;);">中
</label>
&nbsp;
<label>
<input type="radio" name="font_Size" id="" value="14" onclick="artStatistics(&#39;20-10-3&#39;);">小
</label>
</div>
</div>
</div>
<h2 id="titiletext">[Drools]JAVA规则引擎(非常好的一篇教程)</h2>
<div class="article_data">
<div class="article_data_left">
2015-11-16
<span class="a_username">&nbsp;<a href="http://www.360doc.com/userhome/16002580" id="savernickname" target="_blank" onclick="artStatistics(&#39;20-7-1&#39;);" title="飞鹰飞龙飞天">飞鹰飞龙...</a>
</span>
<span id="articleinfo">
<span id="docsource" class="a_from">&nbsp;<a href="http://blog.csdn.net/quzishen/article/details/6163012" target="_blank" onclick="artStatistics(&#39;20-12&#39;);">文章来源</a></span><span id="360doc_Readnum">&nbsp;&nbsp;阅&nbsp;33241&nbsp;</span><span id="360docResaveCount"><span onclick="ShowSaverUser();artStatistics(&#39;20-13&#39;);" id="360doc_saverNum" style="cursor: pointer;">&nbsp;转&nbsp;<span style="cursor:pointer;" onclick="javascript:ShowSaverUser();">178</span></span>
<span id="360doc_saverUser"><div id="sameArtOuter" style="display:none;position: absolute; height:305px;width:144px;left:0px;margin-top:15px;z-index:100000;"><div id="sameArt" style=" overflow-y: auto;  height:300px;overflow-x: hidden; z-index: 100;right:0px;margin-top:-10px;" onclick="event.cancelBubble=true;"></div></div></span>
</span>
</span>
</div>
<div id="resavelayer1" class="bdsharebuttonbox article_data_right bdshare-button-style0-16" data-bd-bind="1502863023608"><div class="zcommond"><a class="p2" href="javascript:void(0);" onclick="SaveArt();artStatistics(&#39;20-3-1&#39;);">转藏到我的图书馆</a><div class="s2 f_right" onclick="setTimeout(function(){$(&#39;.article_data_right .sharelist_new&#39;).slideToggle(0);},10);"><span onclick="artStatistics(&#39;20-8-2&#39;);"></span></div><a class="p1" href="javascript:void(0);" onclick="shareWeixin();artStatistics(&#39;20-8-5&#39;);">微信</a> <span class="s1" onclick="setTimeout(function(){$(&#39;.article_data_right .sharelist_new&#39;).slideToggle(0);},10);artStatistics(&#39;20-8-1&#39;);" onmouseover="this.style.color=&#39;#0f659c&#39;" onmouseout="this.style.color=&#39;&#39;">分享：</span></div><div class="sharelist_new" id="fenxiangLayer" style="display: none;"> <a class="slbg1" href="javascript:void(0);" data-cmd="qzone" onclick="artStatistics(&#39;20-8-7&#39;);">QQ空间</a> <a class="slbg2" href="javascript:void(0);" data-cmd="sqq" onclick="artStatistics(&#39;20-8-9&#39;);">QQ好友</a> <a class="slbg3" href="javascript:void(0);" data-cmd="tsina" onclick="artStatistics(&#39;20-8-11&#39;);">新浪微博</a><a class="slbg5" href="javascript:void(0);" onclick="showdivemail1();artStatistics(&#39;20-8-15&#39;);">推荐给朋友</a> </div><div style="position: absolute;display:none;z-index:1;left:143px;" id="fuzhitishidiv"></div></div>
</div>
<div id="articlecontent" class="article_container" onmousedown="newhighlight = true;" onmouseup="NewHighlight(event);">
<table>
<tbody>
<tr>
<td id="artContent">
<div style="width: 656px; margin: 0; padding: 0; height: 0;"></div>
<p>Drools是一个基于java的规则引擎，开源的，可以将复杂多变的规则从硬编码中解放出来，以规则脚本的形式存放在文件中，使得规则的变更不需要修正代码重启机器就可以立即在线上环境生效。</p>
<p>&nbsp;本文所使用的demo已上传 <a href="http://download.csdn.net/source/3002213">http://download.csdn.net/source/3002213</a></p>
<h2><a name="t0"></a>1、Drools语法</h2>
<p>开始语法之前首先要了解一下drools的基本工作过程，通常而言我们使用一个接口来做事情，首先要穿进去参数，其次要获取到接口的实现执行完毕后的结果，而drools也是一样的，我们需要传递进去数据，用于规则的检查，调用外部接口，同时还可能需要获取到规则执行完毕后得到的结果。在drools中，这个传递数据进去的对象，术语叫 Fact对象。Fact对象是一个普通的java bean，规则中可以对当前的对象进行任何的读写操作，调用该对象提供的方法，当一个java bean插入到workingMemory中，规则使用的是原有对象的引用，规则通过对fact对象的读写，实现对应用数据的读写，对于其中的属性，需要提供getter setter访问器，规则中，可以动态的往当前workingMemory中插入删除新的fact对象。</p>
<p>规则文件可以使用 .drl文件，也可以是xml文件，这里我们使用drl文件。</p>
<p>规则语法：</p>
<p><strong>package</strong>：对一个规则文件而言，package是必须定义的，必须放在规则文件第一行。特别的是，package的名字是随意的，不必必须对应物理路径，跟java的package的概念不同，这里只是逻辑上的一种区分。同样的package下定义的function和query等可以直接使用。</p>
<p>比如：package com.drools.demo.point</p>
<p><strong>import</strong>：导入规则文件需要使用到的外部变量，这里的使用方法跟java相同，但是不同于java的是，这里的import导入的不仅仅可以是一个类，也可以是这个类中的某一个可访问的静态方法。</p>
<p>比如：</p>
<p>import com.drools.demo.point.PointDomain;</p>
<p>import com.drools.demo.point.PointDomain.getById;</p>
<p><strong>rule</strong>：定义一个规则。rule "ruleName"。一个规则可以包含三个部分：</p>
<p>属性部分：定义当前规则执行的一些属性等，比如是否可被重复执行、过期时间、生效时间等。</p>
<p>条件部分，即LHS，定义当前规则的条件，如&nbsp; when Message(); 判断当前workingMemory中是否存在Message对象。</p>
<p>结果部分，即RHS，这里可以写普通java代码，即当前规则条件满足后执行的操作，可以直接调用Fact对象的方法来操作应用。</p>
<p>规则事例：</p>
<p>rule "name"</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no-loop true</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $message:Message(status == 0)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; then</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("fit");</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $message.setStatus(1);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; update($message);</p>
<p>end</p>
<p>上述的属性中：</p>
<p><strong>no-loop</strong> : 定义当前的规则是否不允许多次循环执行，默认是false，也就是当前的规则只要满足条件，可以无限次执行。什么情况下会出现一条规则执行过一次又被多次重复执行呢？drools提供了一些api，可以对当前传入workingMemory中的Fact对象进行修改或者个数的增减，比如上述的update方法，就是将当前的workingMemory中的Message类型的Fact对象进行属性更新，这种操作会触发规则的重新匹配执行，可以理解为Fact对象更新了，所以规则需要重新匹配一遍，那么疑问是之前规则执行过并且修改过的那些Fact对象的属性的数据会不会被重置？结果是不会，已经修改过了就不会被重置，update之后，之前的修改都会生效。当然对Fact对象数据的修改并不是一定需要调用update才可以生效，简单的使用set方法设置就可以完成，这里类似于java的引用调用，所以何时使用update是一个需要仔细考虑的问题，一旦不慎，极有可能会造成规则的死循环。上述的no-loop true，即设置当前的规则，只执行一次，如果本身的RHS部分有update等触发规则重新执行的操作，也不要再次执行当前规则。</p>
<p>但是其他的规则会被重新执行，岂不是也会有可能造成多次重复执行，数据紊乱甚至死循环？答案是使用其他的标签限制，也是可以控制的：lock-on-active true</p>
<p><strong>lock-on-active</strong> true：通过这个标签，可以控制当前的规则只会被执行一次，因为一个规则的重复执行不一定是本身触发的，也可能是其他规则触发的，所以这个是no-loop的加强版。当然该标签正规的用法会有其他的标签的配合，后续提及。</p>
<p><strong>date-expires</strong>：设置规则的过期时间，默认的时间格式：“日-月-年”，中英文格式相同，但是写法要用各自对应的语言，比如中文：<span style="widows: 2; border-collapse: separate; font-stretch: normal; font-size: medium; line-height: normal; font-family: Simsun; orphans: 2; border-spacing: 0px;"><span style="line-height: 18px; font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; font-size: 12px;">"29-七月-2010"，但是还是推荐使用更为精确和习惯的格式，这需要手动在java代码中设置当前系统的时间格式，后续提及。属性用法举例：</span></span>date-expires "2011-01-31 23:59:59" // 这里我们使用了更为习惯的时间格式</p>
<p><strong>date-effective</strong>：设置规则的生效时间，时间格式同上。</p>
<p><strong>duration</strong>：规则定时，duration 3000&nbsp;&nbsp; 3秒后执行规则</p>
<p><strong>salience</strong>：优先级，数值越大越先执行，这个可以控制规则的执行顺序。</p>
<p>其他的属性可以参照相关的api文档查看具体用法，此处略。</p>
<p>&nbsp;</p>
<p>规则的条件部分，即LHS部分：</p>
<p><strong>when</strong>：规则条件开始。条件可以单个，也可以多个，多个条件一次排列，比如</p>
<p>&nbsp;when</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; eval(true)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer:Customer()</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message:Message(status==0)</p>
<p>上述罗列了三个条件，当前规则只有在这三个条件都匹配的时候才会执行RHS部分，三个条件中第一个</p>
<p><strong>eval(true)：</strong>是一个默认的api，true 无条件执行，类似于 while(true)</p>
<p><strong>$message:Message(status==0)</strong> 这句话标示的：当前的workingMemory存在Message类型并且status属性的值为0的Fact对象，这个对象通常是通过外部java代码插入或者自己在前面已经执行的规则的RHS部分中insert进去的。</p>
<p>前面的$message代表着当前条件的引用变量，在后续的条件部分和RHS部分中，可以使用当前的变量去引用符合条件的FACT对象，修改属性或者调用方法等。可选，如果不需要使用，则可以不写。</p>
<p>条件可以有组合，比如：</p>
<p>Message(status==0&nbsp;|| (status &gt; 1 &amp;&amp; status &lt;=100))</p>
<p>RHS中对Fact对象private属性的操作必须使用getter和setter方法，而RHS中则必须要直接用.的方法去使用，比如</p>
<p>&nbsp; $order:Order(name=="qu")<br>&nbsp;&nbsp;$message:Message(status==0 &amp;&amp; orders contains $order &amp;&amp; $order.name=="qu")</p>
<p>特别的是，如果条件全部是 &amp;&amp;关系，可以使用“,”来替代，但是两者不能混用</p>
<p>如果现在Fact对象中有一个List，需要判断条件，如何判断呢？</p>
<p>看一个例子：</p>
<p>Message {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int status; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; names;</p>
<p>}</p>
<p>$message:Message(status==0 &amp;&amp; names contains "网易" &amp;&amp; names.size &gt;= 1)</p>
<p>上述的条件中，status必须是0，并且names列表中含有“网易”并且列表长度大于等于1</p>
<p><strong>contains</strong>：对比是否包含操作，操作的被包含目标可以是一个复杂对象也可以是一个简单的值。<strong>&nbsp;</strong></p>
<p>Drools提供了十二中类型比较操作符： </p>
<p><strong>&gt;&nbsp; &gt;=&nbsp; &lt;&nbsp; &lt;=&nbsp; ==&nbsp; !=&nbsp; contains&nbsp;/ not contains / memberOf / not memberOf /matches/ not matches</strong></p>
<p><strong>not contains：</strong>与contains相反。</p>
<p><strong>memberOf</strong>：判断某个Fact属性值是否在某个集合中，与contains不同的是他被比较的对象是一个集合，而contains被比较的对象是单个值或者对象。</p>
<p><strong>not memberOf</strong>：正好相反。</p>
<p><strong>matches</strong>：正则表达式匹配，与java不同的是，不用考虑'/'的转义问题</p>
<p><strong>not matches</strong>:正好相反。</p>
<p>&nbsp;</p>
<p>规则的结果部分</p>
<p>当规则条件满足，则进入规则结果部分执行，结果部分可以是纯java代码，比如：</p>
<p><strong>then</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("OK"); //会在控制台打印出ok</p>
<p>end</p>
<p>当然也可以调用Fact的方法，比如&nbsp; $message.execute();操作数据库等等一切操作。</p>
<p>结果部分也有drools提供的方法：</p>
<p><strong>insert</strong>：往当前workingMemory中插入一个新的Fact对象，会触发规则的再次执行，除非使用no-loop限定；</p>
<p><strong>update</strong>：更新</p>
<p><strong>modify</strong>：修改，与update语法不同，结果都是更新操作</p>
<p><strong>retract</strong>：删除</p>
<p>RHS部分除了调用Drools提供的api和Fact对象的方法，也可以调用规则文件中定义的方法，方法的定义使用 function 关键字</p>
<p><strong>function</strong> void&nbsp;console {</p>
<p>&nbsp;&nbsp; System.out.println();</p>
<p>&nbsp;&nbsp; StringUtils.getId();// 调用外部静态方法，StringUtils必须使用import导入，getId()必须是静态方法</p>
<p>}</p>
<p>Drools还有一个可以定义类的关键字：</p>
<p><strong>declare</strong> 可以再规则文件中定义一个class，使用起来跟普通java对象相似，你可以在RHS部分中new一个并且使用getter和setter方法去操作其属性。</p>
<p>declare Address<br>&nbsp;@author(quzishen) // 元数据，仅用于描述信息</p>
<p>&nbsp;@createTime(2011-1-24)<br>&nbsp;city : String @maxLengh(100)<br>&nbsp;postno : int<br>end</p>
<p>上述的<strong>'@'</strong>是什么呢？是元数据定义，用于描述数据的数据~，没什么执行含义</p>
<p>你可以在RHS部分中使用Address address = new Address()的方法来定义一个对象。</p>
<p>&nbsp;</p>
<p>更多的规则语法，可以参考其他互联网资料，推荐：</p>
<p><a href="http://wenku.baidu.com/view/a6516373f242336c1eb95e7c.html">http://wenku.baidu.com/view/a6516373f242336c1eb95e7c.html</a></p>
<p>（写的很基础，但是部分语法写的有些简单，含糊不好理解）</p>
<h2><a name="t1"></a>2、Drools应用实例：</h2>
<p>现在我们模拟一个应用场景：网站伴随业务产生而进行的积分发放操作。比如支付宝信用卡还款奖励积分等。</p>
<p>发放积分可能伴随不同的运营策略和季节性调整，发放数目和规则完全不同，如果使用硬编码的方式去伴随业务调整而修改，代码的修改、管理、优化、测试、上线将是一件非常麻烦的事情，所以，将发放规则部分提取出来，交给Drools管理，可以极大程度的解决这个问题。</p>
<p>（注意一点的是，并非所有的规则相关内容都建议使用Drools，这其中要考虑系统会运行多久，规则变更频率等一系列条件，如果你的系统只会在线上运行一周，那根本没必要选择Drools来加重你的开发成本，java硬编码的方式则将是首选）</p>
<p>我们定义一下发放规则：</p>
<p>积分的发放参考因素有：交易笔数、交易金额数目、信用卡还款次数、生日特别优惠等。</p>
<p>定义规则：</p>
<p><span style="color: #993300;">// 过生日，则加10分，并且将当月交易比数翻倍后再计算积分</span></p>
<p><span style="color: #993300;">// 2011-01-08 - 2011-08-08每月信用卡还款3次以上，每满3笔赠送30分</span></p>
<p><span style="color: #993300;">// 当月购物总金额100以上，每100元赠送10分</span></p>
<p><span style="color: #993300;">// 当月购物次数5次以上，每五次赠送50分</span></p>
<p><span style="color: #993300;">// 特别的，如果全部满足了要求，则额外奖励100分</span></p>
<p><span style="color: #993300;">// 发生退货，扣减10分</span></p>
<p><span style="color: #993300;">// 退货金额大于100，扣减100分</span></p>
<p>在事先分析过程中，我们需要全面的考虑对于积分所需要的因素，以此整理抽象Fact对象，通过上述的假设条件，我们假设积分计算对象如下：</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 5818px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>/**&nbsp;</li><li>&nbsp;*&nbsp;积分计算对象&nbsp;</li><li>&nbsp;*&nbsp;@author&nbsp;quzishen&nbsp;</li><li>&nbsp;*/&nbsp;&nbsp;</li><li>public&nbsp;class&nbsp;PointDomain&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;用户名&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;userName;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;是否当日生日&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;boolean&nbsp;birthDay;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;增加积分数目&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;long&nbsp;point;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月购物次数&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;buyNums;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月退货次数&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;backNums;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月购物总金额&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;double&nbsp;buyMoney;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月退货总金额&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;double&nbsp;backMondy;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月信用卡还款次数&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;billThisMonth;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;记录积分发送流水，防止重复发放&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;userName&nbsp;用户名&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;type&nbsp;积分发放类型&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;recordPointLog(String&nbsp;userName,&nbsp;String&nbsp;type){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("增加对"+userName+"的类型为"+type+"的积分操作记录.");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getUserName()&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;userName;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>//&nbsp;其他getter&nbsp;setter方法省略&nbsp;&nbsp;</li><li>}&nbsp;&nbsp;</li></ol></div> <p></p>
<p>定义积分规则接口</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 6561px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_2" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>/**&nbsp;</li><li>&nbsp;*&nbsp;规则接口&nbsp;</li><li>&nbsp;*&nbsp;@author&nbsp;quzishen&nbsp;</li><li>&nbsp;*/&nbsp;&nbsp;</li><li>public&nbsp;interface&nbsp;PointRuleEngine&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;初始化规则引擎&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;initEngine();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;刷新规则引擎中的规则&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;refreshEnginRule();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;执行规则引擎&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pointDomain&nbsp;积分Fact&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;executeRuleEngine(final&nbsp;PointDomain&nbsp;pointDomain);&nbsp;&nbsp;</li><li>}&nbsp;&nbsp;</li></ol></div> <p></p>
<p>规则接口实现，Drools的API很简单，可以参考相关API文档查看具体用法：</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 7052px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_3" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=3&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>import&nbsp;java.io.File;&nbsp;&nbsp;</li><li>import&nbsp;java.io.FileNotFoundException;&nbsp;&nbsp;</li><li>import&nbsp;java.io.FileReader;&nbsp;&nbsp;</li><li>import&nbsp;java.io.IOException;&nbsp;&nbsp;</li><li>import&nbsp;java.io.Reader;&nbsp;&nbsp;</li><li>import&nbsp;java.util.ArrayList;&nbsp;&nbsp;</li><li>import&nbsp;java.util.List;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>import&nbsp;org.drools.RuleBase;&nbsp;&nbsp;</li><li>import&nbsp;org.drools.StatefulSession;&nbsp;&nbsp;</li><li>import&nbsp;org.drools.compiler.DroolsParserException;&nbsp;&nbsp;</li><li>import&nbsp;org.drools.compiler.PackageBuilder;&nbsp;&nbsp;</li><li>import&nbsp;org.drools.spi.Activation;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>/**&nbsp;</li><li>&nbsp;*&nbsp;规则接口实现类&nbsp;</li><li>&nbsp;*&nbsp;@author&nbsp;quzishen&nbsp;</li><li>&nbsp;*/&nbsp;&nbsp;</li><li>public&nbsp;class&nbsp;PointRuleEngineImpl&nbsp;implements&nbsp;PointRuleEngine&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;RuleBase&nbsp;ruleBase;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;(non-Javadoc)&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;com.drools.demo.point.PointRuleEngine#initEngine()&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;initEngine()&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置时间格式&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.setProperty("drools.dateformat",&nbsp;"yyyy-MM-dd&nbsp;HH:mm:ss");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ruleBase&nbsp;=&nbsp;RuleBaseFacatory.getRuleBase();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PackageBuilder&nbsp;backageBuilder&nbsp;=&nbsp;getPackageBuilderFromDrlFile();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ruleBase.addPackages(backageBuilder.getPackages());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(DroolsParserException&nbsp;e)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Exception&nbsp;e)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;(non-Javadoc)&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;com.drools.demo.point.PointRuleEngine#refreshEnginRule()&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;refreshEnginRule()&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ruleBase&nbsp;=&nbsp;RuleBaseFacatory.getRuleBase();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.drools.rule.Package[]&nbsp;packages&nbsp;=&nbsp;ruleBase.getPackages();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(org.drools.rule.Package&nbsp;pg&nbsp;:&nbsp;packages)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ruleBase.removePackage(pg.getName());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initEngine();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;(non-Javadoc)&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;com.drools.demo.point.PointRuleEngine#executeRuleEngine(com.drools.demo.point.PointDomain)&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;executeRuleEngine(final&nbsp;PointDomain&nbsp;pointDomain)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(null&nbsp;==&nbsp;ruleBase.getPackages()&nbsp;||&nbsp;0&nbsp;==&nbsp;ruleBase.getPackages().length)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StatefulSession&nbsp;statefulSession&nbsp;=&nbsp;ruleBase.newStatefulSession();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statefulSession.insert(pointDomain);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;fire&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statefulSession.fireAllRules(new&nbsp;org.drools.spi.AgendaFilter()&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;accept(Activation&nbsp;activation)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!activation.getRule().getName().contains("_test");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statefulSession.dispose();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;从Drl规则文件中读取规则&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;Exception&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;PackageBuilder&nbsp;getPackageBuilderFromDrlFile()&nbsp;throws&nbsp;Exception&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;获取测试脚本文件&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;&nbsp;drlFilePath&nbsp;=&nbsp;getTestDrlFile();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;装载测试脚本文件&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Reader&gt;&nbsp;readers&nbsp;=&nbsp;readRuleFromDrlFile(drlFilePath);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PackageBuilder&nbsp;backageBuilder&nbsp;=&nbsp;new&nbsp;PackageBuilder();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Reader&nbsp;r&nbsp;:&nbsp;readers)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backageBuilder.addPackageFromDrl(r);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;检查脚本是否有问题&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(backageBuilder.hasErrors())&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception(backageBuilder.getErrors().toString());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;backageBuilder;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;drlFilePath&nbsp;脚本文件路径&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;FileNotFoundException&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;List&lt;Reader&gt;&nbsp;readRuleFromDrlFile(List&lt;String&gt;&nbsp;drlFilePath)&nbsp;throws&nbsp;FileNotFoundException&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(null&nbsp;==&nbsp;drlFilePath&nbsp;||&nbsp;0&nbsp;==&nbsp;drlFilePath.size())&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Reader&gt;&nbsp;readers&nbsp;=&nbsp;new&nbsp;ArrayList&lt;Reader&gt;();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;ruleFilePath&nbsp;:&nbsp;drlFilePath)&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readers.add(new&nbsp;FileReader(new&nbsp;File(ruleFilePath)));&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;readers;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取测试规则文件&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;List&lt;String&gt;&nbsp;getTestDrlFile()&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;&nbsp;drlFilePath&nbsp;=&nbsp;new&nbsp;ArrayList&lt;String&gt;();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drlFilePath&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.add("D:/workspace2/DroolsDemo/src/com/drools/demo/point/addpoint.drl");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drlFilePath&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.add("D:/workspace2/DroolsDemo/src/com/drools/demo/point/subpoint.drl");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;drlFilePath;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>}&nbsp;&nbsp;</li></ol></div> <p></p>
<p>为了获取单实例的RuleBase，我们定义一个工厂类</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 9540px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_4" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=4&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>import&nbsp;org.drools.RuleBase;&nbsp;&nbsp;</li><li>import&nbsp;org.drools.RuleBaseFactory;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>/**&nbsp;</li><li>&nbsp;*&nbsp;RuleBaseFacatory&nbsp;单实例RuleBase生成工具&nbsp;</li><li>&nbsp;*&nbsp;@author&nbsp;quzishen&nbsp;</li><li>&nbsp;*/&nbsp;&nbsp;</li><li>public&nbsp;class&nbsp;RuleBaseFacatory&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;RuleBase&nbsp;ruleBase;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;RuleBase&nbsp;getRuleBase(){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null&nbsp;!=&nbsp;ruleBase&nbsp;?&nbsp;ruleBase&nbsp;:&nbsp;RuleBaseFactory.newRuleBase();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>}&nbsp;&nbsp;</li></ol></div> <p></p>
<p>剩下的就是定义两个规则文件，分别用于积分发放和积分扣减</p>
<p>addpoint.drl</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 9927px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_5" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=5&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>package&nbsp;com.drools.demo.point&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>import&nbsp;com.drools.demo.point.PointDomain;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;birthdayPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;过生日，则加10分，并且将当月交易比数翻倍后再计算积分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;100&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(birthDay&nbsp;==&nbsp;true)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()+10);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setBuyNums($pointDomain.getBuyNums()*2);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setBuyMoney($pointDomain.getBuyMoney()*2);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setBillThisMonth($pointDomain.getBillThisMonth()*2);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"birthdayPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;billThisMonthPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;2011-01-08&nbsp;-&nbsp;2011-08-08每月信用卡还款3次以上，每满3笔赠送30分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;99&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;date-effective&nbsp;"2011-01-08&nbsp;23:59:59"&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;date-expires&nbsp;"2011-08-08&nbsp;23:59:59"&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(billThisMonth&nbsp;&gt;=&nbsp;3)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()+$pointDomain.getBillThisMonth()/3*30);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"billThisMonthPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;buyMoneyPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月购物总金额100以上，每100元赠送10分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;98&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(buyMoney&nbsp;&gt;=&nbsp;100)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()+&nbsp;(int)$pointDomain.getBuyMoney()/100&nbsp;*&nbsp;10);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"buyMoneyPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;buyNumsPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当月购物次数5次以上，每五次赠送50分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;97&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(buyNums&nbsp;&gt;=&nbsp;5)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()+$pointDomain.getBuyNums()/5&nbsp;*&nbsp;50);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"buyNumsPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;allFitPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;特别的，如果全部满足了要求，则额外奖励100分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;96&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain:PointDomain(buyNums&nbsp;&gt;=&nbsp;5&nbsp;&amp;&amp;&nbsp;billThisMonth&nbsp;&gt;=&nbsp;3&nbsp;&amp;&amp;&nbsp;buyMoney&nbsp;&gt;=&nbsp;100)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()+&nbsp;100);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"allFitPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li></ol></div> <p></p>
<p>subpoint.drl</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 11191px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_6" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=6&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>package&nbsp;com.drools.demo.point&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>import&nbsp;com.drools.demo.point.PointDomain;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;subBackNumsPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;发生退货，扣减10分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;10&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(backNums&nbsp;&gt;=&nbsp;1)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()-10);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"subBackNumsPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li><li>&nbsp;&nbsp;</li><li>rule&nbsp;subBackMondyPoint&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;退货金额大于100，扣减100分&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;salience&nbsp;9&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;lock-on-active&nbsp;true&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain&nbsp;:&nbsp;PointDomain(backMondy&nbsp;&gt;=&nbsp;100)&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.setPoint($pointDomain.getPoint()-10);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pointDomain.recordPointLog($pointDomain.getUserName(),"subBackMondyPoint");&nbsp;&nbsp;</li><li>end&nbsp;&nbsp;</li></ol></div> <p></p>
<p>&nbsp;</p>
<p>测试方法：</p>
<p></p><div><div><div><b>[java]</b> <a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="view plain">view plain</a><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml" title="copy">copy</a><div style="position: absolute; left: 516px; top: 11776px; width: 18px; height: 18px; z-index: 0;"><embed src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_7" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=7&amp;width=18&amp;height=18" wmode="transparent" style="z-index: 0;"></div></div></div><ol start="1"><li>public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args)&nbsp;throws&nbsp;IOException&nbsp;{&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PointRuleEngine&nbsp;pointRuleEngine&nbsp;=&nbsp;new&nbsp;PointRuleEngineImpl();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(true){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;is&nbsp;=&nbsp;System.in;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader&nbsp;br&nbsp;=&nbsp;new&nbsp;BufferedReader(new&nbsp;InputStreamReader(is));&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;input&nbsp;=&nbsp;br.readLine();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(null&nbsp;!=&nbsp;input&nbsp;&amp;&amp;&nbsp;"s".equals(input)){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("初始化规则引擎...");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointRuleEngine.initEngine();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("初始化规则引擎结束.");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if("e".equals(input)){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;PointDomain&nbsp;pointDomain&nbsp;=&nbsp;new&nbsp;PointDomain();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setUserName("hello&nbsp;kity");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBackMondy(100d);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBuyMoney(500d);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBackNums(1);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBuyNums(5);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBillThisMonth(5);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setBirthDay(true);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointDomain.setPoint(0l);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointRuleEngine.executeRuleEngine(pointDomain);&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("执行完毕BillThisMonth："+pointDomain.getBillThisMonth());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("执行完毕BuyMoney："+pointDomain.getBuyMoney());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("执行完毕BuyNums："+pointDomain.getBuyNums());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("执行完毕规则引擎决定发送积分："+pointDomain.getPoint());&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if("r".equals(input)){&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("刷新规则文件...");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointRuleEngine.refreshEnginRule();&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("刷新规则文件结束.");&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li></ol></div> <p></p>
<p>执行结果：</p>
<p>-----------------</p>
<p><span style="background-color: #000000;"><span style="color: #ccffff;">增加对hello kity的类型为birthdayPoint的积分操作记录.<br>增加对hello kity的类型为billThisMonthPoint的积分操作记录.<br>增加对hello kity的类型为buyMoneyPoint的积分操作记录.<br>增加对hello kity的类型为buyNumsPoint的积分操作记录.<br>增加对hello kity的类型为allFitPoint的积分操作记录.<br>增加对hello kity的类型为subBackNumsPoint的积分操作记录.<br>增加对hello kity的类型为subBackMondyPoint的积分操作记录.<br>执行完毕BillThisMonth：10<br>执行完毕BuyMoney：1000.0<br>执行完毕BuyNums：10<br>执行完毕规则引擎决定发送积分：380</span></span></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
</td>
<script>
                                    var html = document.getElementById("artContent").innerHTML;
                                    document.getElementById("artContent").innerHTML = html;

                                </script>
</tr>
</tbody>
</table>
<div id="viewerPlaceHolder" style="width: 717px; height: 700px; display: none; margin: 0 auto;">
</div>
</div>
<table>
<tbody>
<tr>
<td>
<ul></ul>
</td>
</tr>
</tbody>
</table>
<div></div>
<span></span>
<a></a>
<p style="margin: 0; padding: 0;"></p>
<p class="clearboth"></p>
<div class="bdsharebuttonbox bottombtn bdshare-button-style0-16" data-bd-bind="1502863023608">
<div class="zcommond" style="overflow: visible;">
<a href="javascript:void(0);" class="btn_collect" onclick="SaveArt();artStatistics(&#39;20-3-2&#39;);">转藏到我的图书馆</a>
<a id="flowimg3" href="javascript:void(0);" class="btn_good" onclick="Showflowerlayer(&#39;sendedLayer1&#39;);">献花（<span id="articleflowernum">0</span>）
<span id="flowernumadd" style="display: none;">+1</span>
</a>
<span class="span1 f_left" onclick="setTimeout(function(){$(&#39;.bottombtn .sharelist_new&#39;).slideToggle(0);},10);artStatistics(&#39;20-8-3&#39;);" onmouseover="this.style.color=&#39;#0f659c&#39;" onmouseout="this.style.color=&#39;&#39;">分享：</span>
<a class="sharewx f_left" href="javascript:void(0);" onclick="shareWeixin();artStatistics(&#39;20-8-6&#39;);">微信</a>
<div class="s2 f_left" onclick="setTimeout(function(){$(&#39;.bottombtn .sharelist_new&#39;).slideToggle(0);},10);artStatistics(&#39;20-8-4&#39;);"><span></span></div>
</div>
<div class="sharelist_new" id="fenxiangLayer2" style="display: none;">
<a class="slbg1" href="javascript:void(0);" data-cmd="qzone" onclick="artStatistics(&#39;20-8-8&#39;);">QQ空间</a>
<a class="slbg2" href="javascript:void(0);" data-cmd="sqq" onclick="artStatistics(&#39;20-8-10&#39;);">QQ好友</a>
<a class="slbg3" href="javascript:void(0);" data-cmd="tsina" onclick="artStatistics(&#39;20-8-12&#39;);">新浪微博</a>
<a class="slbg5" href="javascript:void(0);" onclick="showdivemail1();artStatistics(&#39;20-8-16&#39;);">推荐给朋友</a>
</div>
</div>
<div class="bottom_controler">
<p class="bottom_cleft">
来自：
<span class="a_username" style="width: auto;">
<a href="http://www.360doc.com/userhome/16002580" id="savernickname2" target="_blank" onclick="artStatistics(&#39;20-7-2&#39;);">飞鹰飞龙飞天</a>
</span>
&gt;
<span id="cname" class="a_from"><a href="http://www.360doc.com/userhome.aspx?userid=16002580&amp;cid=66" target="_blank" onclick="artStatistics(&quot;20-6&quot;);">《Drools》</a></span>
</p>
<div class="bottom_cright">
<a href="https://www.baidu.com/s?wd=pointdomain+drools+%e8%a7%84%e5%88%99&amp;tn=SE_hldp01010_6r0gix1f" target="_blank" class="a1" onclick="artStatistics(&#39;20-19&#39;);">以文找文</a>
&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="javascript:void(0);" class="a2" onclick="showAlertLayer1();artStatistics(&#39;20-18&#39;);">举报</a>
</div>
</div>
<div class="prev_next">
<p id="lastart" class="p1" style="display: block;"> 上一篇：<a onclick="artStatistics(&quot;20-9-5&quot;);" href="http://www.360doc.com/content/14/0811/20/16002580_401132686.shtml" target="_blank">[Drools]JAVA规则引擎</a></p>
<p id="nextart" class="p2">
</p>
</div>
</div>
<p class="clearboth"></p>
<div style="width: 676px; float: left;">
<div class="str_border" style="border: none; position: relative; z-index: 2;">
<strong>猜你喜欢</strong>
</div>
<ul class="youlike" style="margin-top: -18px; position: relative; z-index: 1;">
<div style="width: 676px; height: 280px; border: 0;" id="divyoulikead"><iframe id="youlikead" style="width: 676px; height: 280px; border: 0;" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/adbaiduyoulike.html"></iframe></div>
</ul>
<div class="zcommond" style="padding: 10px 0 5px;">
<div class="bottom_article f_left">
<div class="str_border">
<strong>类似文章</strong>
</div>
<ul class="barticle_list">
<li><span><a href="http://www.360doc.com/content/17/0717/08/535749_671889722.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">来，学几招夜观天象的绝活，下次陪女朋友...</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0717/20/4441170_672153806.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">治腿抽筋的民间神奇土方，绝招*</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0626/20/30753221_666750665.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">别再浪费时间了！小学数学无非就这13种难...</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0329/01/20370273_640989412.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">找个懂得欣赏你的人在一起 </a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0424/10/2205372_648181028.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">588种中草药药用一览表，值得收藏</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0320/16/152695_638496546.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">春风十里不如你【情感美文】</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0501/21/40331844_650138555.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">五世祖传糖尿病神方</a></span></li>
<li><span><a href="http://www.360doc.com/content/17/0204/11/1353678_626418287.shtml" target="_blank" onclick="artStatistics(&quot;20-9-7&quot;);">你们说没有哪一个韩国模特能比过孙允珠，...</a></span></li>
</ul>
</div>
<div class="bottom_article f_right">
<div class="str_border">
<strong>精选文章</strong>
</div>
<ul class="barticle_list">
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/13/0506/23/22953_283378848.shtml" target="_blank">无人破解的刘谦魔术表演</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/11/0212/11/2238056_92308808.shtml" target="_blank">绝色美女集锦</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/12/1126/04/4530213_250191992.shtml" target="_blank">学唱歌网址</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/13/0715/17/6956316_300052941.shtml" target="_blank">绝代佳人绝代诗</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/13/1015/04/7436990_321455891.shtml" target="_blank">微博每日精选</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/13/1016/14/8432479_321767638.shtml" target="_blank">天安门诗抄大全</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/14/0121/21/15061035_346868303.shtml" target="_blank">百年来全球最顶尖最赚钱的公司</a></span></li>
<li><span><a onclick="artStatistics(&#39;20-9-9&#39;);" href="http://www.360doc.com/content/14/0509/20/5752064_376064264.shtml" target="_blank">54句趣味格言幽默小语</a></span></li>
</ul>
</div>
</div>
<div id="divunderad"><iframe id="underZcommondAd" style="width: 676px; height: 100px;" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/underad.html"></iframe></div>
<div id="ReflectionPart"><div style="margin: 0px 0px;"><div class="plbox" style="height:auto;"><div style="padding-left:6px;margin-top:10px;padding-bottom:14px;"><div style="height: 23px;font-size:16px;font-weight:bold;" class="titwx">发表评论</div><div class="deluwx" style="margin-top:10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请&nbsp;<span><a onclick="ReflectionLoginform();artStatistics(&#39;20-4-1&#39;);" href="javascript:void(0);">登录</a></span>&nbsp;或者&nbsp;<span><a onclick="InsertLogData(4);artStatistics(&#39;20-4-2&#39;);" href="http://www.360doc.com/register.aspx?refer=53&amp;reurl=showweb/0/0/54400091122.aspx" target="_blank">注册</a></span>&nbsp;后再进行评论</div><div class="rt360" style="height: 26px;margin:-22px 170px 0 0;_display:inline;"><span class="dsfwz">社交帐号登录：</span><a class="dsftb sf1" href="javascript:void(0);" onclick="ArtLoginTypeID=13;toSNSLogin(&#39;smb&#39;);artStatistics(&#39;20-4-3&#39;);_hmt.push([&#39;_trackEvent&#39;,&#39;loginsina&#39;,&#39;clicknum&#39;,&#39;wenzhangyeremark&#39;]);" title="新浪微博"></a><a class="dsftb sf2 " onclick="ArtLoginTypeID=13;toSNSLogin(&#39;qq&#39;);artStatistics(&#39;20-4-4&#39;);_hmt.push([&#39;_trackEvent&#39;,&#39;loginqq&#39;,&#39;clicknum&#39;,&#39;wenzhangyeremark&#39;]); " href="javascript:void(0);" title="腾讯QQ"></a><a class="dsftb sf3" href="javascript:void(0);" onclick="ArtLoginTypeID=13;toSNSLogin(&#39;wx&#39;);artStatistics(&#39;20-4-5&#39;);_hmt.push([&#39;_trackEvent&#39;,&#39;loginrenren&#39;,&#39;clicknum&#39;,&#39;wenzhangyeremark&#39;]);" title="微信"></a></div></div></div></div></div>
<div style="padding-top: 15px; padding-left: 15px;" id="Reflction"><div id="360docRefTN" class="wenzhang_bt" style="display:none;"></div><div id="360docRefCT"></div><div id="360docRefPB" style="display: none;"></div></div>
</div>
</div>
<div class="a_right">
<div class="user_info">
<div class="user_photo f_left">
<p class="user_photopic">
<a href="http://www.360doc.com/userhome/16002580" id="userphotourl" target="_blank" onclick="artStatistics(&#39;20-7-4&#39;);">
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/16002580_201407151951200297_main.jpg" id="userphoto" width="58" height="58">
</a>
</p>
<a href="javascript:void(0);" onclick="docTalk();artStatistics(&#39;20-15&#39;);" class="user_talk" title="与TA对话"></a>
</div>
<div class="user_data f_right">
<div class="user_data_name">
<a href="http://www.360doc.com/userhome/16002580" id="nickname" target="_blank" onclick="artStatistics(&#39;20-7-3&#39;);">飞鹰飞龙飞天</a>
<img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/user_name_tag.gif" alt="图书馆">
</div>
<p id="userdegree"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/userstar1.gif"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/userstar1.gif"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/userstar1.gif"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/userstar2.gif"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/userstar3.gif"></p>
<div class="user_data_num">
<a id="spanfollowstatus" class="gz_no"></a>
<script type="text/javascript">isfollow(16002580);</script>
<span id="follownum">50</span>&nbsp;&nbsp;&nbsp;&nbsp;
<span>馆藏</span>&nbsp;<span id="artnum">683</span>
</div>
</div>
</div>
<div class="his_her"><ul class="his_her_type"><li class="f_left curone">TA的最新馆藏</li></ul><div class="his_her_div" style="height:190px;"><ul class="his_her_list"><li><div><span></span><a href="http://www.360doc.com/content/17/0811/18/16002580_678464219.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">sharding-jdbc结合mybatis实现分库分表功能</a></div><div><span></span><a href="http://www.360doc.com/content/17/0710/22/16002580_670414426.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">日本人夏天必备什么药？10款止痒药膏拿走不谢！</a></div><div><span></span><a href="http://www.360doc.com/content/17/0702/01/16002580_668091939.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">用Electron开发桌面应用 | 用nodejs开发桌面应用</a></div><div><span></span><a href="http://www.360doc.com/content/17/0604/02/16002580_659688580.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">获取Android设备唯一标识码</a></div><div><span></span><a href="http://www.360doc.com/content/17/0604/02/16002580_659687635.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">Ionic2使用第三方cordova插件（非Ionic2官方支持的native cordova插件）</a></div><div><span></span><a href="http://www.360doc.com/content/17/0604/00/16002580_659679089.shtml" target="_blank" onclick="artStatistics(&#39;20-9-3&#39;);">ionic2/3使用geolocation，解决IonicNativePlugin错误</a></div></li></ul></div></div>
<div class="clear360doc" style="padding-top: 10px; height: 260px;">
<div id="divifartad1">
<script>
            var strow = document.body.offsetWidth;
            var strsw = document.body.scrollWidth;
            var strsc = window.screen.width;

            function aliad1() {
                document.write('<a style="display:none!important" id="tanx-a-mm_11220363_1101997_10218757"></a>');
                tanx_s = document.createElement("script");
                tanx_s.type = "text/javascript";
                tanx_s.charset = "gbk";
                tanx_s.id = "tanx-s-mm_11220363_1101997_10218757";
                tanx_s.async = true;
                tanx_s.src = "http://p.tanx.com/ex?i=mm_11220363_1101997_10218757";
                tanx_h = document.getElementsByTagName("head")[0];
                if (tanx_h) tanx_h.insertBefore(tanx_s, tanx_h.firstChild);
            }

            function aliad2() {
                document.write('<a style="display:none!important" id="tanx-a-mm_11220363_1101997_26568831"></a>');
                tanx_s = document.createElement("script");
                tanx_s.type = "text/javascript";
                tanx_s.charset = "gbk";
                tanx_s.id = "tanx-s-mm_11220363_1101997_26568831";
                tanx_s.async = true;
                tanx_s.src = "http://p.tanx.com/ex?i=mm_11220363_1101997_26568831";
                tanx_h = document.getElementsByTagName("head")[0];
                if (tanx_h) tanx_h.insertBefore(tanx_s, tanx_h.firstChild);
            }


            if (strsc <= 1024) {
                aliad1();
            }
            else {
                //300宽
                aliad2();
            }
        </script><ins style="display:inline-block;padding:0;margin:0;width:300px;height:250px;*zoom:1;*display:inline; position:relative;" id="tanxssp-outer-conmm_11220363_1101997_26568831"><div id="tanxssp_con_mm_11220363_1101997_26568831" style="overflow:hidden;display:inline-block;position:relative;width:300px;height:250px;*display:inline;*zoom:1;font:12px/1.5 tahoma,&#39;Hiragino Sans GB&#39;,&#39;microsoft yahei&#39;,sans-serif;"><iframe id="tanxssp-outer-iframemm_11220363_1101997_26568831" style="width: 300px; height: 250px;" border="0" frameborder="0" scrolling="no" marginwidth="0" allowtransparency="true" marginheight="0" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/saved_resource.html"></iframe><a style="display:none !important;" id="tanx_frameanchor_mm_11220363_1101997_26568831" data-mid="29628780"></a><ins style="display:inline-block;height:13px;line-height:13px;position:absolute;right:20px;bottom:0;background: url(//img.alicdn.com/tfs/TB1HaIwMVXXXXb.XFXXXXXXXXXX-1-26.png);"><ins style="font-size:9px;transform:scale(0.8);-moz-transform:scale(0.94);display:inline-block;height:13px;color:#808080;color/*\**/:#b3b3b3 \9;text-decoration:none;font-weight:normal">晶赞</ins></ins><a id="sxmm_11220363_1101997_26568831" href="javascript:;" style="width:20px;height:13px;right:0px;bottom:0px;display:block;position:absolute;cursor:pointer;z-index:250;margin:0;">   <span id="sx1mm_11220363_1101997_26568831" style="float:none;width:20px;display:block;height:13px;"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/TB1tWvVJFXXXXc_aXXXXXXXXXXX-40-26.png" style="width:20px;height:13px;margin:auto;display:block;min-height:13px;" border="0/"></span><div id="sxtipmm_11220363_1101997_26568831" style="display:none;position:absolute;left:-38px;bottom:13px;"><img src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/TB1upAiJXXXXXa5aXXXXXXXXXXX-116-30.png" style="width:58px;height:15px;margin:auto;display:block;min-height:15px;" border="0"></div></a></div></ins><a style="display:none!important" id="tanx-a-mm_11220363_1101997_26568831"></a>
</div>
<div style="height: 10px;">
</div>
</div>
<div class="his_her" id="recommendArt" style="margin-top: 5px;">
<div class="str_border" style="margin: 0;">
<span style="font-size: 14px; float: left;">喜欢该文的人也喜欢</span>
<a style="float: right;" class="a_more" onclick="artStatistics(&#39;20-9-4&#39;);" href="http://www.360doc.com/readroom.html" target="_blank">更多</a>
</div>
<div class="his_her_div" style="height: 264px;">
<ul class="his_her_list">
<li id="recommendArtLists"><div><span></span><a href="http://www.360doc.com/content/14/0507/10/16002580_375639848.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">（转）微信公众平台开发之基于百度 BAE3.0 的开发环境搭建（采用 Baidu Eclipse）</a></div><div><span></span><a href="http://www.360doc.com/content/15/0301/06/6789490_451782046.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">Drools扫盲普及贴</a></div><div><span></span><a href="http://www.360doc.com/document/14/1218/04/74563_433908940.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">增值税税负还原计算公式负担江苏省国家税务局重点税源预警分析软件指标体系</a></div><div><span></span><a href="http://www.360doc.com/content/10/0707/04/1911053_37462095.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">把基层党组织建设成贯彻落实科学发展观的坚强堡垒</a></div><div><span></span><a href="http://www.360doc.com/content/10/0714/06/1491161_39015336.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">网曝东莞酒店举行“小姐大阅兵”(组图)</a></div><div><span></span><a href="http://www.360doc.com/content/10/0808/11/350597_44643394.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">江苏·卫生厅</a></div><div><span></span><a href="http://www.360doc.com/content/15/0701/11/5054188_481895266.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">Drools学习笔记4-第一个例子</a></div><div><span></span><a href="http://www.360doc.com/content/15/0226/09/16002580_451056980.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">第七章：Shiro的Session管理</a></div><div><span></span><a href="http://www.360doc.com/content/15/1102/03/16002580_510206785.shtml" target="_blank" onclick="artStatistics(&#39;20-9-1&#39;);">基于jfinal的XssHandler，统一处理xss脚本攻击</a></div></li>
</ul>
</div>
</div>
<div class="clear360doc" style="padding-top: 10px;" id="divifartad2"><iframe id="ifartad2" height="250" width="300px" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/ad2_300.html"></iframe></div>
<br>
<div id="divifartrightsogou"><iframe id="ifartrightsogou" height="190" width="300px" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/artrightadsogou300.html"></iframe></div>
<div class="clear360doc" id="divad5" style="padding-top: 11px; zoom: 1; width: 300px; top: 80px; left: 1159.5px;">
<div id="divad4" style="">
<div id="divifartad"><iframe id="ifartad" height="250px" width="300px" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/ad4_300.html"></iframe></div>
<div class="ggwz">
<a href="javascript:void(0);" onclick="closead(2);">关闭</a>
</div>
<div style="height: 13px;">
</div>
</div>
<div style="clear: both;" id="divad6">
<div id="adfloatbaidu"><iframe id="ifartadfloadbaidu" height="250px" width="250px" frameborder="0" scrolling="no" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/ad5.html" style="width: 250px; margin: 0px auto;"></iframe></div>
<div class="ggwz" style="left: 25px;">
<a href="javascript:void(0);" onclick="closead(3);">关闭</a>
</div>
<div style="height: 13px;">
</div>
</div>
<div style="height: 75px;">
</div>
</div>
</div>
</div>
<p class="clearboth"></p>
<input type="hidden" id="artid" value="513612029">
<input type="hidden" id="docarttitle" value="%5bDrools%5dJAVA%e8%a7%84%e5%88%99%e5%bc%95%e6%93%8e(%e9%9d%9e%e5%b8%b8%e5%a5%bd%e7%9a%84%e4%b8%80%e7%af%87%e6%95%99%e7%a8%8b)">
<input type="hidden" id="firstartid" value="513612029">
<input type="hidden" id="subclassid" value="-1">
<input type="hidden" id="recommendart1" value="-1">
<input type="hidden" id="recommendart2" value="-1">
<input type="hidden" id="isowner" value="False">
<input type="hidden" id="artreadroomid" value="0">
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/showarticle.js.下载" type="text/javascript" charset="utf-8"></script>
<script>GerLookingUserInfo(1,16002580,1,0,'-1',-1,10,0);OutputSource('http://blog.csdn.net/quzishen/article/details/6163012','');OutputLastNextArt('%5bDrools%5dJAVA%e8%a7%84%e5%88%99%e5%bc%95%e6%93%8e','http://www.360doc.com/content/14/0811/20/16002580_401132686.shtml',0);</script>
<script type="text/javascript" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/newheader.js.下载"></script>
<script type="text/javascript" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/addStatistics.js.下载"></script>
<script src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/getstatusv2.ashx" type="text/javascript" charset="utf-8" async="async"></script>
<script type="text/javascript">
        var baiduImagePlus = {
            noLogo: true,
            unionId: 'u2617463',
            maxMiniAdCount: 0,
            formList: [{ formId: 10 }]
        };
    </script>
<script type="text/javascript" src="./[Drools]JAVA规则引擎(非常好的一篇教程)_files/i.js.下载"></script>


<div id="goTop2" style="left: 1479.5px; display: block;"><div id="goTop"><a href="http://www.360doc.com/content/15/1116/16/16002580_513612029.shtml#" id="go_top" onclick="artStatistics(&#39;20-20&#39;);"></a></div><div id="goTop1"><a href="javascript:void(0);" id="go_top1"></a></div><div></div></div></body></html>