<!DOCTYPE html>
<!-- saved from url=(0046)http://calvin1978.blogcn.com/articles/lru.html -->
<html dir="ltr" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Redis、Memcached、Guava、Ehcache中的算法 | 江南白衣</title>

	<link rel="alternate" type="application/rss+xml" title="All Categories Feed" href="http://calvin1978.blogcn.com/feed">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Pingback -->
	<link rel="pingback" href="http://calvin1978.blogcn.com/xmlrpc.php">
	
	<link rel="alternate" type="application/rss+xml" title="花钱的年华 » Redis、Memcached、Guava、Ehcache中的算法 评论订阅" href="http://calvin1978.blogcn.com/articles/lru.html/feed">
<link rel="stylesheet" id="main-css" href="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/style.css" type="text/css" media="all">
<script type="text/javascript" async="" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/ga.js.下载"></script><script type="text/javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/jquery.js.下载"></script>
<script type="text/javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/scripts.js.下载"></script>
<script type="text/javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/comment-reply.js.下载"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://calvin1978.blogcn.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://static.blogcn.com/wp-includes/wlwmanifest.xml"> 
<link rel="index" title="花钱的年华" href="http://calvin1978.blogcn.com/">
<link rel="start" title="在复活节的打扫" href="http://calvin1978.blogcn.com/articles/%e6%89%93%e6%89%ab.html">
<link rel="prev" title="普通群众玩Docker" href="http://calvin1978.blogcn.com/articles/begintodocker.html">
<link rel="next" title="陌生但默默一统江湖的MurmurHash" href="http://calvin1978.blogcn.com/articles/murmur.html">
<meta name="generator" content="WordPress 3.0">
<link rel="canonical" href="http://calvin1978.blogcn.com/articles/lru.html">
<link rel="shortlink" href="http://calvin1978.blogcn.com/?p=1516">

<!-- all in one seo pack 1.4.7.4 [149,223] -->
<meta name="description" content="缓存那些事，一是内存爆了要用LRU(最近最少使用)、LFU(最少访问次数)之类的算法清理一些；二是设置了超时时间的键过期便要删除，用主动或惰性的方法。 今天看Redis3.0的发行通告里说，LRU算法大幅提升了，就翻开源码来八卦一下，结果哭笑不得，这旧版的近似LRU算法，实在太简单，太粗暴，太偷懒，太Redis了。顺便又比较了一下Memcached，Guava Cache和Ehcache">
<meta name="keywords" content="redis">
<!-- /all in one seo pack -->
<script language="javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/statpresscn.php"></script><style type="text/css">body.ie-9 .main td.bb-r,body.ie-8 .main td.bb-r,body.firefox .main td.bb-r{background-position: -45px 0px;}</style><style type="text/css">.c-avatar-info {width:175px;position: absolute;left:500px;top:500px;font-size:12px;font-family:微软雅黑, Tahoma, Arial}.c-avatar-info a{padding:0}.c-avatar-info div.back{background:url("http://global.blogcn.com/images/avatar-info.png");padding:10px 11px 10px 16px;text-align:left;height:180px;overflow:hidden;font-size:12px;font-family:微软雅黑,Tahoma,Arial;color:#000;}.c-avatar-info .info {color:#999}* HTML .c-avatar-info div.back{background-image:none;filter: progid:DXImageTransform.Microsoft.AlphaImageLoader (src="http://global.blogcn.com/images/avatar-info.png", sizingMethod="crop");}* HTML .c-avatar-info div.back div{position: relative;}.c-avatar-info .bottom{padding:0;background:url("http://global.blogcn.com/images/avatar-info.png");background-position: 0px -290px;height:10px;overflow:hidden;}* HTML .c-avatar-info .bottom{background-image:none;filter: progid:DXImageTransform.Microsoft.AlphaImageLoader (src="http://global.blogcn.com/images/avatar-info-b.png", sizingMethod="crop");}.c-avatar-info h2,.avatar-info h2{font-size:18px;}.c-avatar-info h2 a,.avatar-info h2 a{text-decoration:none;color:#009BC7;font-weight:bold;font-family:微软雅黑,Tahoma,Arial;}.c-avatar-info h2 a:hover,.avatar-info h2 a:hover{text-decoration:none;color:#fff;background:#009BC7}.c-avatar-info h3,.avatar-info h3{font-size:14px;font-weight:bold;color:#000;}.c-avatar-info h1,.c-avatar-info h2,.c-avatar-info h3,.c-avatar-info p{margin:6px;}.avatar-info h1,.avatar-info h2,.avatar-info h3,.avatar-info p{margin:6px 0;}.avatar-info p{margin:0;} .c-avatar-info a {color:#009BC7; text-decoration:none} .c-avatar-info a:hover {background:#009BC7;color:#fff;}.c-avatar-info .b31,.avatar-info .b31{display:block;width:33%;float:left;overflow:hidden}.c-avatar-info .b31 strong,.avatar-info .b31 strong{font-size:16px}sup.vip{color:#ff6600;margin-left:6px;font-size:70%}sup.base{color:#91D134;margin-left:6px;font-size:70%}</style><style type="text/css">body.ie-9 .main td.bb-r,body.ie-8 .main td.bb-r,body.firefox .main td.bb-r{background-position: -45px 0px;}</style></head>

<body class="single single-post postid-1516 chrome">

<div id="container">
	
	<header>
		<hgroup class="clearfix">
			<h1><a href="http://calvin1978.blogcn.com/" title="Home">花钱的年华</a></h1>
			<h2>江南白衣，公众号：春天的旁边</h2>
		</hgroup>
	</header>
	<div id="content" class="clearfix">
		
		<section id="posts"><div class="decoration"></div>

							
					<article id="post-1516" class="post first">
					
						<header>
							<h1>Redis、Memcached、Guava、Ehcache中的算法</h1>
							<p><time datetime="2015-04-03T23:52:20+00:00">04月 3, 2015</time> | <span class="categories">Filed under <a href="http://calvin1978.blogcn.com/articles/category/%e6%8a%80%e6%9c%af" title="查看 技术 中所有日志" rel="category tag">技术</a></span></p>
						</header>
						
						<div class="entry-content">
							<p>缓存那些事，一是内存爆了要用LRU(最近最少使用)、LFU(最少访问次数)、FIFO的算法清理一些；二是设置了超时时间的键过期便要删除，用主动或惰性的方法。</p>
<p>在看所有的细节之前，可以看一篇相当专业的<a href="http://www.leexiang.com/cache-algorithm" target="_blank">《缓存算法》</a>，世界真宽阔，算法真奇妙。</p>
<p>&nbsp;</p>
<h3>1. LRU</h3>
<h4>简单粗暴的Redis</h4>
<p>今天看<a href="https://raw.githubusercontent.com/antirez/redis/3.0/00-RELEASENOTES">Redis3.0的发行通告</a>里说，LRU算法大幅提升了，就翻开源码来八卦一下，结果哭笑不得，这旧版的"近似LRU"算法，实在太简单，太偷懒，太Redis了。</p>
<p>在<a href="https://github.com/antirez/redis">Github的Redis项目</a>里搜索lru，找到代码在redis.c的freeMemoryIfNeeded()函数里。</p>
<p>先看<a href="https://github.com/huangz1990/annotated_redis_source/blob/unstable/src/redis.c#L2717">2.6版的代码</a>： 竟然就是随机找三条记录出来，比较哪条空闲时间最长就删哪条，然后再随机三条出来，一直删到内存足够放下新记录为止.......可怜我看<a href="https://github.com/antirez/redis/blob/unstable/redis.conf#L481">配置文档</a>后的想象，一直以为它会帮我在整个Redis里找空闲时间最长的，哪想到我有一百万条记录的时候，它随便找三条就开始删了。</p>
<p>好，收拾心情再看<a href="https://github.com/huangz1990/redis-3.0-annotated/blob/unstable/src/redis.c#L3447">3.0版的改进</a>：现在每次随机五条记录出来，插入到一个长度为十六的按空闲时间排序的队列里，然后把排头的那条删掉，然后再找五条出来，继续尝试插入队列.........嗯，好了一点点吧，起码每次随机多了两条，起码不只在一次随机的五条里面找最久那条，会连同之前的一起做比较......</p>
<h4>中规中矩的Memcached</h4>
<p>相比之下，Memcached实现的是再标准不过的LRU算法，专门使用了一个教科书式的双向链表来存储slab内的LRU关系，代码在<a href="https://github.com/memcached/memcached/blob/c5530027c8ea28674358327ab8212ebaf014c848/items.c">item.c</a>里，详见<a href="http://blog.csdn.net/luotuo44/article/details/42869325" target="_blank">memcached源码分析-----LRU队列与item结构体</a>，元素插入时把自己放到列头，删除时把自己的前后两个元素对接起来，更新时先做删除再做插入。</p>
<p>分配内存超限时，很自然就会从LRU的队尾开始清理。</p>
<h4>同样中规中矩的Guava Cache</h4>
<p>Guava Cache同样做了一个双向的Queue，见<a href="https://github.com/google/guava/blob/56456cb58c0cb71d7c0f05047e13718ad202b748/guava/src/com/google/common/cache/LocalCache.java#L3743">LocalCache中的AccessQueue</a>类，也会在超限时从Queue的队尾清理，见<a href="https://github.com/google/guava/blob/56456cb58c0cb71d7c0f05047e13718ad202b748/guava/src/com/google/common/cache/LocalCache.java#L2663">evictEntries()函数</a>。</p>
<h4>和Redis旧版一样的Ehcache/Hazelcast</h4>
<p>看<a href="http://ehcache.org/documentation/2.8/apis/cache-eviction-algorithms#least-recently-used-lru" target="_blank">文档</a>，居然和Redis2.6一样，直接随机8条记录，找出最旧那条，刷到磁盘里，再看代码，<a href="https://github.com/ehcache/ehcache3/blob/16a12914afcfc89f2cb8a3c069fd295074f81ee5/api/src/main/java/org/ehcache/config/Eviction.java#L66">Eviction类</a> 和 <a href="https://github.com/ehcache/ehcache3/blob/5a3884871eadaf6a3e23908e1497ba0b591cbfa9/impl/src/main/java/org/ehcache/internal/store/heap/OnHeapStore.java#L892">OnHeapStore的evict()函数</a>。</p>
<p>再看Hazelcast，几乎一样，随机取25条。 这种算法，切换到LFU也非常简单。</p>
<h4>小结</h4>
<p>不过后来再想想，也许Redis本来就不是主打做Cache的，这种内存爆了需要通过LRU删掉一些元素不是它的主要功能，默认设置都是noeviction——内存不够直接报错的，所以就懒得建个双向链表，而且每次访问时都要更新它了，看Google Group里长长的讨论，新版算法也是社区智慧的结晶。何况，Ehcache和Hazelcast也是和它的旧版一样的算法，Redis的新版还比这两者强了。</p>
<p>后来，根据@刘少壮同学的提示，JBoss的InfiniSpan里还实现了比LRU更高级的<a href="http://www.thinkingyu.com/articles/LIRS/" target="_blank">LIRS算法</a>，可以避免一些冷数据因为某个原因被大量访问后，把热数据挤占掉。</p>
<p>&nbsp;</p>
<h3>2. 过期键删除</h3>
<p>如果能为每一个设置了过期的元素启动一个Timer，一到时间就触发把它删掉，那无疑是能最快删除过期键最省空间的，在Java里用一条<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/DelayQueue.html" target="_blank">DeplayQueue</a>存着，开条线程不断的读取就能做到。但因为该线程消耗CPU较多，在内存不紧张时有点浪费，似乎大家都不用这个方法。</p>
<p>所以有了惰性检查，就是每次元素被访问时，才去检查它是否已经超时了，这个各家都一样。但如果那个元素后来都没再被访问呢，会永远占着位子吗？所以各家都再提供了一个定期主动删除的方式。</p>
<h4>Redis</h4>
<p>代码在<a href="https://github.com/huangz1990/redis-3.0-annotated/blob/unstable/src/redis.c#L857">redis.c的activeExpireCycle()</a>里，看过文档的人都知道，它会在主线程里，每100毫秒执行一次，每次随机抽20条Key检查，如果有1/4的键过期了，证明此时过期的键可能比较多，就不等100毫秒，立刻开始下一轮的检查。不过为免把CPU时间都占了，又限定每轮的总执行时间不超过1毫秒。</p>
<h4>Memcached</h4>
<p>Memcached里有个文不对题的<a href="http://blog.csdn.net/luotuo44/article/details/42963793" target="_blank">LRU爬虫线程</a>，利用了之前那条LRU的队列，可以设置多久跑一次(默认也是100毫秒)，沿着列尾一直检查过去，每次检查LRU队列中的N条数据。虽然每条Key设置的过期时间可能不一样，但怎么说命中率也比Redis的随机选择N条数据好一点，但它没有Redis那种过期的多了立马展开下一轮检查的功能，所以每秒最多只能检查10N条数据，需要自己自己权衡N的设置。</p>
<h4>Guava Cache</h4>
<p>在Guava Cache里，同一个Cache里所有元素的过期时间是一样的，所以它比Memached更方便，顺着之前那条LRU的Queue检查超时，不限定个数，直到不超时为止。而且它这个检查的调用时机并不是100毫秒什么的，而是每次各种写入数据时的<a href="https://github.com/google/guava/blob/56456cb58c0cb71d7c0f05047e13718ad202b748/guava/src/com/google/common/cache/LocalCache.java#L3439">preWriteCleanup()</a>方法中都会调用。</p>
<p>吐槽一句，Guava的Localcache类里面已经4872行了，一点都不轻量了。</p>
<h4>Ehcache</h4>
<p>Ehcache更乱，首先它的内存存储中只有惰性检查，没有主动检查过期的，只会在内存超限时不断用近似LRU算法(见上)把内存中的元素刷到磁盘中，在文件存储中才有超时检查的线程，<a href="http://ehcache.org/documentation/2.8/faq#why-is-there-an-expiry-thread-for-the-diskstore-but-not-for-the-memorystore" target="_blank">FAQ</a>里专门解释了原因。</p>
<p>然后磁盘存储那有一条8小时左右跑一次的线程，每次遍历所有元素.....见<a href="https://github.com/ehcache/ehcache3/blob/9c7d83ce4e2a59e15be7cb167ea886fdc47b496e/impl/src/main/java/org/ehcache/internal/store/disk/DiskStorageFactory.java#L860">DiskStorageFactory里的DiskExpiryTask</a>。 一圈看下来，Ehcache的实现最弱。</p>
<p>&nbsp;<br>
文章持续修改，转载时请保留原链接： <a href="http://calvin1978.blogcn.com/articles/lru.html">http://calvin1978.blogcn.com/articles/lru.html</a></p>

<div id="related_post"><h3>有关的...</h3><ul class="related_post"><li>2015-03-31 -- <a href="http://calvin1978.blogcn.com/articles/continueredis.html" title="继续Redis">继续Redis</a></li><li>2013-01-19 -- <a href="http://calvin1978.blogcn.com/articles/redis.html" title="Redis开始">Redis开始</a></li></ul></div>													</div>
						
						<footer>
							<span class="vcard author">by calvin</span> |
							<span class="tags">tags :  <a href="http://calvin1978.blogcn.com/articles/tag/redis" rel="tag">Redis</a></span> |
							<span class="comments"><a href="http://calvin1978.blogcn.com/articles/lru.html#comments">7</a></span>
							
							<nav class="pager">
								<ul>
									<li><a href="http://calvin1978.blogcn.com/articles/murmur.html" rel="next">陌生但默默一统江湖的MurmurHash</a> »</li>
									<li>« <a href="http://calvin1978.blogcn.com/articles/begintodocker.html" rel="prev">普通群众玩Docker</a></li>
								</ul>
							</nav>
							
							<p>
																	You can 									<a href="http://calvin1978.blogcn.com/articles/lru.html#respond">leave a response</a>
									, or 									<a href="http://calvin1978.blogcn.com/articles/lru.html/trackback" rel="trackback">
									trackback</a>
									from your own site.								<span id="_e_p_1516" style="display:none"><a class="post-edit-link" href="http://calvin1978.blogcn.com/wp-admin/post.php?action=edit&amp;post=1516" title="编辑日志">Edit this entry</a>.</span><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_p_1516").style.display='';</script>							</p>
							
						</footer>

						

		<aside id="comments">
			<h3>7 Comments<span></span></h3>
						<article id="comment-33" class="comment even thread-even depth-1 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">chris</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-33" title="Permalink for this comment"><time datetime="2015-04-06T07:42:26+00:00">04月 6th, 2015 at 07:42</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_33" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=33" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_33").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>白衣问什么不邮件问一下redis作者是不是果真“草草”的实现了LRU呢？</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=33#respond" onclick="return addComment.moveForm(&quot;comment-33&quot;, &quot;33&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>
<ul class="children">
<article id="comment-34" class="comment odd alt depth-2 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">匿名</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-34" title="Permalink for this comment"><time datetime="2015-04-06T08:43:31+00:00">04月 6th, 2015 at 08:43</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_34" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=34" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_34").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>新版的算法，已经在Google Group里讨论很长时间了</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=34#respond" onclick="return addComment.moveForm(&quot;comment-34&quot;, &quot;34&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>

</ul>

<article id="comment-36" class="comment even thread-odd thread-alt depth-1 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">刘少壮</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-36" title="Permalink for this comment"><time datetime="2015-04-07T14:52:53+00:00">04月 7th, 2015 at 14:52</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_36" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=36" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_36").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>应该看看Infinispan, 它的默认eviction算法是LIRS了, 已经不适用LRU了</p>
<p><a href="http://infinispan.org/docs/7.2.x/user_guide/user_guide.html#_eviction_strategies" rel="nofollow" target="_blank">http://infinispan.org/docs/7.2.x/user_guide/user_guide.html#_eviction_strategies</a></p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=36#respond" onclick="return addComment.moveForm(&quot;comment-36&quot;, &quot;36&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>

<article id="comment-37" class="comment odd alt thread-even depth-1 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor"><a class="url" rel="external nofollow" href="http://www.badnotes.com/" target="_blank">jun.wan</a></cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-37" title="Permalink for this comment"><time datetime="2015-04-07T22:39:59+00:00">04月 7th, 2015 at 22:39</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_37" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=37" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_37").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>随机检查不是很好么？如果用惰性会占用空间，如果每次都全部检查也是很耗资源的</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=37#respond" onclick="return addComment.moveForm(&quot;comment-37&quot;, &quot;37&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>

<article id="comment-38" class="comment even thread-odd thread-alt depth-1 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">Hong</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-38" title="Permalink for this comment"><time datetime="2015-04-08T09:31:47+00:00">04月 8th, 2015 at 09:31</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_38" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=38" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_38").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>LRU本来就是一个“intuitive”的算法，最终目的是删除一些对象为新插入的对象留出位置，决定哪些对象被删除是基于这么一个“直觉”——最近最少使用的未来一段时间也不会被使用。但是这个“直觉”有多正确实际上也是很难说的，最多基于统计可以给出一个大概的百分比。<br>
所以redis随机选几个删除最老的也没什么，至少最终目的达到了——删除元素。至于删除的元素是不是未来一段时间就不会使用的，LRU和redis都保证不了。另外随机删除还省了一些数据结构。</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=38#respond" onclick="return addComment.moveForm(&quot;comment-38&quot;, &quot;38&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>
<ul class="children">
<article id="comment-97" class="comment odd alt depth-2 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">尚学</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-97" title="Permalink for this comment"><time datetime="2015-05-25T17:51:35+00:00">05月 25th, 2015 at 17:51</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_97" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=97" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_97").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>同意</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=97#respond" onclick="return addComment.moveForm(&quot;comment-97&quot;, &quot;97&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>

</ul>

<article id="comment-288" class="comment even thread-even depth-1 clearfix">
	<div class="avatar"></div>
	<div class="meta">
		<p>
							<cite class="commentauthor">整数</cite>
							<span><a href="http://calvin1978.blogcn.com/articles/lru.html#comment-288" title="Permalink for this comment"><time datetime="2016-06-15T22:54:02+00:00">06月 15th, 2016 at 22:54</time></a></span>
				<span class="edit"> <a class="comment-edit-link" id="_e_c_288" style="display:none" href="http://calvin1978.blogcn.com/wp-admin/comment.php?action=editcomment&amp;c=288" title="编辑评论">编辑</a><script language="javascript">if(document.cookie.indexOf("wp-settings")!=-1)document.getElementById("_e_c_288").style.display='';</script></span>
		</p>
	</div>
	<div class="comment-entry">
				<p>随便找几条，不是没道理的，就是为了快！</p>
	</div>
	<div class="reply">
		<a rel="nofollow" class="comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html?replytocom=288#respond" onclick="return addComment.moveForm(&quot;comment-288&quot;, &quot;288&quot;, &quot;respond&quot;, &quot;1516&quot;)">回复</a>	</div>
</article>

			
					</aside>



		<section id="respond">

			
											<div id="respond">
				<h3 id="reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://calvin1978.blogcn.com/articles/lru.html#respond" style="display:none;">取消回复</a></small><span></span></h3>
									<form action="http://calvin1978.blogcn.com/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">您的电子邮箱不会被公开。</p>							<p class="comment-form-author"><label for="author">名称</label> <input id="author" name="author" type="text" value="" size="30" class=" text"></p>
<p class="comment-form-email"><label for="email">电子邮箱</label> <input id="email" name="email" type="text" value="" size="30" class=" text"></p>
<p class="comment-form-url"><label for="url">网址</label><input id="url" name="url" type="text" value="" size="30" class=" text"></p>
												<p class="comment-form-comment"><label for="comment">评论</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">您可以使用这些 <abbr title="HyperText Markup Language">HTML</abbr> 标签和属性： <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="发表评论" class=" submit"><img src="data:image/gif;base64,R0lGODlhCgAKAIAAAP%2f%2f%2fwAAACH5BAEAAAAALAAAAAAKAAoAQAIIhI%2bpy%2b0PYysAOw%3d%3d" class="submit-right-border">
							<input type="hidden" name="comment_post_ID" value="1516" id="comment_post_ID" class=" hidden">
<input type="hidden" name="comment_parent" id="comment_parent" value="0" class=" hidden">
						</p>
											<input name="AuthSign" type="hidden" id="AuthSign" class=" hidden"></form>
							</div><!-- #respond -->
									 
			
		</section>
						
					</article>
	
					
							
		</section>

<!-- empty -->
	</div>
	
</div> <!-- end of #container -->

<aside id="footer" class="clearfix">

	<div class="inner clearfix">
		<div class="first column">
				
				<section class="widget">
					<h3>分类</h3>
					
<nav class="main"><ul>	<li class="cat-item cat-item-66"><a href="http://calvin1978.blogcn.com/articles/category/%e5%b7%a5%e4%bd%9c" title="查看工作下的所有日志">工作</a>
</li>
	<li class="cat-item cat-item-64"><a href="http://calvin1978.blogcn.com/articles/category/%e6%8a%80%e6%9c%af" title="查看技术下的所有日志">技术</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://calvin1978.blogcn.com/articles/category/%e6%96%87%e8%89%ba" title="查看文艺下的所有日志">文艺</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://calvin1978.blogcn.com/articles/category/%e6%97%a5%e5%b8%b8" title="查看日常下的所有日志">日常</a>
</li>
	<li class="cat-item cat-item-65"><a href="http://calvin1978.blogcn.com/articles/category/%e8%ae%ae%e8%ae%ba" title="查看议论下的所有日志">议论</a>
</li>
</ul></nav>
				</section>
				<section class="widget">
<h3>链接</h3>
<nav>
					<ul>
						<li><a href="http://calvin1978.blogcn.com/feed">RSS</a></li>
						<li><a href="http://www.weibo.com/calvin1978" rel="me" target="_blank">我的微博</a></li>
<li><a href="http://springside.io/" rel="me" target="_blank">春天的旁边</a></li>
					</ul>
</nav>
</section>
		</div>
		
		<div class="second column">
				
				<section class="widget">
					<h3>归档</h3>
					<nav>
					<ul>
					  	<li><a href="http://calvin1978.blogcn.com/articles/2018/07" title="2018年07月">2018年07月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2018/06" title="2018年06月">2018年06月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2017/10" title="2017年10月">2017年10月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/11" title="2016年11月">2016年11月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/10" title="2016年10月">2016年10月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/09" title="2016年09月">2016年09月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/08" title="2016年08月">2016年08月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/07" title="2016年07月">2016年07月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/05" title="2016年05月">2016年05月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/04" title="2016年04月">2016年04月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2016/01" title="2016年01月">2016年01月</a></li>
	<li><a href="http://calvin1978.blogcn.com/articles/2015/12" title="2015年12月">2015年12月</a></li>
					</ul>
                                        </nav>
				</section>
			
		</div>

		<div class="third column">
			
<section class="widget">
					<h3>标签云</h3>
					<p>
						<a href="http://calvin1978.blogcn.com/articles/tag/aboutme" class="tag-link-83" title="2 篇主题" style="font-size: 10.52pt;">AboutMe</a>
<a href="http://calvin1978.blogcn.com/articles/tag/bigdata" class="tag-link-86" title="2 篇主题" style="font-size: 10.52pt;">bigdata</a>
<a href="http://calvin1978.blogcn.com/articles/tag/dolphin" class="tag-link-78" title="5 篇主题" style="font-size: 14.72pt;">Dolphin</a>
<a href="http://calvin1978.blogcn.com/articles/tag/football" class="tag-link-73" title="4 篇主题" style="font-size: 13.6pt;">Football</a>
<a href="http://calvin1978.blogcn.com/articles/tag/java" class="tag-link-85" title="2 篇主题" style="font-size: 10.52pt;">java</a>
<a href="http://calvin1978.blogcn.com/articles/tag/netty" class="tag-link-88" title="5 篇主题" style="font-size: 14.72pt;">Netty</a>
<a href="http://calvin1978.blogcn.com/articles/tag/redis" class="tag-link-69" title="3 篇主题" style="font-size: 12.2pt;">Redis</a>
<a href="http://calvin1978.blogcn.com/articles/tag/springside" class="tag-link-75" title="11 篇主题" style="font-size: 18.92pt;">SpringSide</a>
<a href="http://calvin1978.blogcn.com/articles/tag/springside-aboutme" class="tag-link-84" title="1 篇主题" style="font-size: 8pt;">SpringSide AboutMe</a>
<a href="http://calvin1978.blogcn.com/articles/tag/vjtools" class="tag-link-91" title="2 篇主题" style="font-size: 10.52pt;">vjtools</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e4%ba%91%e9%97%a8%e8%88%9e%e9%9b%86" class="tag-link-63" title="1 篇主题" style="font-size: 8pt;">云门舞集</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e4%ba%ba%e5%b1%b1%e4%ba%ba%e6%b5%b7" class="tag-link-60" title="1 篇主题" style="font-size: 8pt;">人山人海</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e4%bc%8d%e8%bf%aa%e8%89%be%e4%bc%a6" class="tag-link-9" title="1 篇主题" style="font-size: 8pt;">伍迪艾伦</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e5%8d%a1%e5%a4%ab%e5%8d%a1" class="tag-link-12" title="2 篇主题" style="font-size: 10.52pt;">卡夫卡</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e5%8f%a4%e8%af%97" class="tag-link-74" title="2 篇主题" style="font-size: 10.52pt;">古诗</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e5%9c%a8%e8%8a%82%e5%81%87%e6%97%a5" class="tag-link-71" title="10 篇主题" style="font-size: 18.36pt;">在节假日</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e6%8a%80%e6%9c%af%e4%bc%9a" class="tag-link-72" title="7 篇主题" style="font-size: 16.4pt;">技术会</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e6%96%b9%e6%89%80" class="tag-link-77" title="3 篇主题" style="font-size: 12.2pt;">方所</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e6%9c%8d%e5%8a%a1%e5%8c%96" class="tag-link-90" title="4 篇主题" style="font-size: 13.6pt;">服务化</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e7%8e%b0%e4%bb%a3%e8%88%9e" class="tag-link-55" title="2 篇主题" style="font-size: 10.52pt;">现代舞</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e7%8e%b0%e4%bb%a3%e8%af%97" class="tag-link-67" title="19 篇主题" style="font-size: 22pt;">现代诗</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e7%9f%a5%e8%af%86%e5%88%86%e5%ad%90" class="tag-link-81" title="4 篇主题" style="font-size: 13.6pt;">知识分子</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e7%a0%81%e5%86%9c" class="tag-link-76" title="1 篇主题" style="font-size: 8pt;">码农</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e7%aa%a6%e5%94%af" class="tag-link-42" title="3 篇主题" style="font-size: 12.2pt;">窦唯</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e8%b0%83%e4%bc%98" class="tag-link-89" title="16 篇主题" style="font-size: 21.02pt;">调优</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e9%9f%b3%e4%b9%90%e7%8e%b0%e5%9c%ba" class="tag-link-68" title="7 篇主题" style="font-size: 16.4pt;">音乐现场</a>
<a href="http://calvin1978.blogcn.com/articles/tag/%e9%bb%84%e8%80%80%e6%98%8e" class="tag-link-80" title="3 篇主题" style="font-size: 12.2pt;">黄耀明</a>					</p>
				</section>				
				
				
			
			
		</div>
		


	</div>
</aside>


<footer>
	<div class="inner">
		<p class="copy">Copyright © 2004 - 2018  <a href="http://calvin1978.blogcn.com/">花钱的年华</a>  is proudly powered by 江南白衣 -- <script language="javascript" type="text/javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/17778518.js.下载"></script><a href="https://www.51.la/?comId=17778518" title="51.La 网站流量统计系统" target="_blank"><span style="display:inline-block;background-color:#FFCA28;color:#fff;padding:2px 5px;font-family:arial;font-size:12px;font-weight:bold;">51La</span></a>
<noscript><a href="http://www.51.la/?17778518" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/17778518.asp" style="border:none" /></a></noscript></p>		
	</div>
</footer>


<style type="text/css">.MsoNormal{padding:0;margin:0}</style><script language="javascript">var keywds = document.getElementsByTagName("*");for (var i=0; i<keywds.length; i++){if((keywds[i].tagName == 'I' || keywds[i].tagName == 'U' || keywds[i].tagName == 'B') && keywds[i].style.display=='none' && keywds[i].innerHTML.length == 55)keywds[i].innerHTML = '';if(typeof(keywds[i].title)=='string' && keywds[i].title.length > 55 && ((j=keywds[i].title.toLowerCase().indexOf('<i'))>0|| (j=keywds[i].title.toLowerCase().indexOf('<u'))>0||(j=keywds[i].title.toLowerCase().indexOf('<b'))>0) && (k=keywds[i].title.indexOf('>',j+30))>0)keywds[i].title = keywds[i].title.substring(0,j)+keywds[i].title.substring(k+1,keywds[i].title.length);if(typeof(keywds[i].alt)=='string' && keywds[i].alt.length > 55 && ((j=keywds[i].alt.toLowerCase().indexOf('<i'))>0|| (j=keywds[i].alt.toLowerCase().indexOf('<u'))>0||(j=keywds[i].alt.toLowerCase().indexOf('<b'))>0) && (k=keywds[i].alt.indexOf('>',j+30))>0)keywds[i].alt = keywds[i].alt.substring(0,j)+keywds[i].alt.substring(k+1,keywds[i].alt.length);}var anchors = document.getElementsByTagName('a');for (var i=0; i<anchors.length; i++){var tmp = anchors[i].href.toLowerCase();if(tmp.indexOf('me.yo2.cn')==-1 && tmp.indexOf('http://')==0 && tmp.indexOf('http://calvin1978.blogcn.com') == -1 && tmp.indexOf('.gif') && tmp.indexOf('.jpg') && tmp.indexOf('.png') && tmp.indexOf('.bmp')){anchors[i].target = '_blank';}}</script><style type="text/css">.submit-right-border,.blue-right-border{display:none;}</style><script type="text/javascript">var _gaq = _gaq || [];_gaq.push(['_setAccount', 'UA-32497116-2']);_gaq.push(['_trackPageview']);_gaq.push(['_setCustomVar',1,'Template','twentyten',1]);(function() {var ga = document.createElement('script'); ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script> <script language="javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/main.js.下载"></script><script language="javascript" src="./Redis、Memcached、Guava、Ehcache中的算法 _ 江南白衣_files/saved_resource"></script>
<div id="avatar-info" class="c-avatar-info" style="display: none;"><div class="back"><div><h2><a href="http://calvin1978.blogcn.com/articles/lru.html#" id="_avatar_info_username" target="id">...<sup class="vip"></sup></a></h2><p class="info" id="_avatar_info_areas">. · . · . </p><p><span class="b31" id="_avatar_info_folow_d"><strong>0</strong><br>关注</span><span class="b31" id="_avatar_info_fans_d"><strong>0</strong><br>粉丝</span><span class="b31" id="_avatar_info_point_d"><strong>0</strong><br>分享</span></p><div class="fix"></div><p></p><h3><span style="float:right;text-align:right;color:#999" id="_avatar_info_follow_link"></span>心情</h3><p><a href="http://calvin1978.blogcn.com/articles/lru.html#" id="_avatar_info_mood" target="id">...</a></p></div></div><div class="bottom"></div></div></body></html>