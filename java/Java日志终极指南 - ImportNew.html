<!DOCTYPE html>
<!-- saved from url=(0035)http://www.importnew.com/16331.html -->
<html dir="ltr" lang="zh-CN" xmlns:wb="http://open.weibo.com/wb" class=" js rgba borderradius boxshadow textshadow opacity cssanimations cssgradients csstransitions fontface generatedcontent video audio js"><!--<![endif]--><!-- BEGIN head --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Java日志终极指南 - ImportNew_files/shares.php" charset="utf-8"></script>

	<!-- Title -->
	<title>Java日志终极指南 - ImportNew</title>
	
	<!-- Meta Tags -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- Favicon & Mobileicon -->
	<link rel="shortcut icon" href="http://www.importnew.com/wp-content/uploads/2014/12/d02a42d9cb3dec9320e5f550278911c7.ico">
	<link rel="apple-touch-icon" href="http://www.importnew.com/wp-content/themes/jobbolev4blog/mobileicon.png">
	
	<!-- RSS, Atom & Pingbacks -->
		<link rel="alternate" title="ImportNew RSS Feed" href="http://www.importnew.com/feed">
		<link rel="alternate" title="RSS .92" href="http://www.importnew.com/feed/rss">
	<link rel="alternate" title="Atom 0.3" href="http://www.importnew.com/feed/atom">
	<link rel="pingback" href="http://www.importnew.com/xmlrpc.php">
	
	<!-- Theme Hook -->
	<link rel="stylesheet" id="lightboxStyle-css" href="./Java日志终极指南 - ImportNew_files/colorbox.css" type="text/css" media="screen">
<link rel="stylesheet" id="core3.0-css" href="./Java日志终极指南 - ImportNew_files/shCore.css" type="text/css" media="all">
<link rel="stylesheet" id="core-Default3.0-css" href="./Java日志终极指南 - ImportNew_files/shCoreDefault.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-Default3.0-css" href="./Java日志终极指南 - ImportNew_files/shThemeDefault.css" type="text/css" media="all">
<div class="fit-vids-style">­<style>               .fluid-width-video-wrapper {                 width: 100%;                              position: relative;                       padding: 0;                            }                                                                                   .fluid-width-video-wrapper iframe,        .fluid-width-video-wrapper object,        .fluid-width-video-wrapper embed {           position: absolute;                       top: 0;                                   left: 0;                                  width: 100%;                              height: 100%;                          }                                       </style></div><script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/jquery.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/q2w3-fixed-widget.min.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/modernizr.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/comment-reply.js.下载"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.importnew.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.importnew.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="企业级 Java 应用最重要的4个性能指标" href="http://www.importnew.com/16342.html">
<link rel="next" title="写Java也得了解CPU–CPU缓存" href="http://www.importnew.com/16346.html">
<link rel="shortlink" href="http://www.importnew.com/?p=16331">

<!-- All in One SEO Pack 1.6.15.2 by Michael Torbert of Semper Fi Web Design[465,496] -->
<meta name="description" content="这篇教程从日志基础开始，涵盖了Java日志组件、配置、关键类介绍等。">
<meta name="keywords" content="日志">
<link rel="canonical" href="http://www.importnew.com/16331.html">
<!-- /all in one seo pack -->

<!-- Comment Rating plugin Version: 2.9.32 by Bob King, http://wealthynetizen.com/, dynamic comment voting & styling. --> 
<style type="text/css" media="screen">
   .ckrating_highly_rated {background-color:#FFFFCC !important;}
   .ckrating_poorly_rated {opacity:0.6;filter:alpha(opacity=60) !important;}
   .ckrating_hotly_debated {background-color:#FFF0F5 !important;}
</style>


<!-- WP SyntaxHighlighter Ver.1.7.3 CSS for code Begin -->
<style type="text/css">
.syntaxhighlighter,
.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
font-size: 12px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.syntaxhighlighter table caption {
/* For Title(Caption) */  
font-size: 14px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.syntaxhighlighter.nogutter td.code .line {
/* Set the left padding space when no-gutter in ver. 3.0 */  
padding-left: 3px !important;
}
.syntaxhighlighter {
/* For Chrome/Safari(WebKit) */  
/* Hide the superfluous vertical scrollbar in ver. 3.0 */  
overflow-y: hidden !important;
padding: 1px !important;
}
.widget-area.syntaxhighlighter a,
.widget-area.syntaxhighlighter div,
.widget-area.syntaxhighlighter code,
.widget-area.syntaxhighlighter table,
.widget-area.syntaxhighlighter table td,
.widget-area.syntaxhighlighter table tr,
.widget-area.syntaxhighlighter table tbody,
.widget-area.syntaxhighlighter table thead,
.widget-area.syntaxhighlighter table caption,
.widget-area.syntaxhighlighter textarea {
/* For Widget */  
font-size: 14px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.widget-area table caption {
/* For Widget */  
/* For Title(Caption) */  
font-size: 10px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
</style>
<!-- WP SyntaxHighlighter Ver.1.7.3 CSS for code End -->
	
	<!-- CSS -->
	<link rel="stylesheet" href="./Java日志终极指南 - ImportNew_files/style.css" media="screen">
	<!-- link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text:400,700italic,700,400italic" media="screen" / -->
	<style>
				*::selection { background: #0099cc; }
		*::-moz-selection { background: #0099cc; }
		body { background: #ffffff  }
		a, .tabs ul.nav li a:hover, .tabs ul.nav li.active a, .dropcap, .toggle.hover .toggle-title, li.comment cite a:hover, h3.widget-title, .post-meta .meta-title:hover, .the-latest a:hover h4, .aw_socialcounter_widget li a:hover, .aw_tabbed_widget #tab-latest-comments a:hover { color: #0099cc; }
		a:hover { color: #b30000; }
		input:focus, textarea:focus { border-color: #0099cc; }
		#searchsubmit, .highlight, .aw_tabbed_widget .tabs ul.nav li.active a, footer .aw_tabbed_widget .tabs ul.nav li.active a, #top .aw_tabbed_widget .tabs ul.nav li.active a, .aw_tabbed_widget .tabs ul.nav li a:hover, footer .aw_tabbed_widget .tabs ul.nav li a:hover, #top .aw_tabbed_widget .tabs ul.nav li a:hover, .aw_twitter_widget .twitter-icon, .testimonial-icon, #top-closed:hover, .flex-control-nav a:hover, .flex-control-nav a.flex-active { background-color: #0099cc; }
		.submit { background-color: #0099cc; border-color: #007399; }
		.submit:hover { background-color: #b30000; border-color: #860000; }
		#searchsubmit:hover { background-color: #b30000; }
		.toggle.hover .toggle-icon { border-top-color: #0099cc; }
		.toggle.hover.active .toggle-icon { border-bottom-color: #0099cc; }
		.flex-direction-nav li .flex-prev:hover { border-right-color: #0099cc; }
		.flex-direction-nav li .flex-next:hover { border-left-color: #0099cc; }
		@media only screen and (min-width: 768px) and (max-width: 959px) {
			.aw_tabbed_widget .tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
		@media screen and (max-width: 767px) {
			.tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
	</style>
		
	<!--[if IE 8]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
    <![endif]-->

	<!-- Links: RSS + Atom Syndication + Pingback etc. -->
	<link rel="alternate" type="application/rss+xml" title="ImportNew RSS Feed" href="http://www.importnew.com/feed">
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://www.importnew.com/feed/rss">
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://www.importnew.com/feed/atom">
	<link rel="pingback" href="http://www.importnew.com/xmlrpc.php">
    <script src="./Java日志终极指南 - ImportNew_files/wb.js.下载" type="text/javascript" charset="utf-8"></script><script charset="UTF-8" src="./Java日志终极指南 - ImportNew_files/query"></script>

<!-- END head -->
</head>

<!-- BEGIN body -->
<body class="single single-post postid-16331 single-format-standard chrome"><link href="./Java日志终极指南 - ImportNew_files/jiathis_counter.css" rel="stylesheet" type="text/css"><link href="./Java日志终极指南 - ImportNew_files/jiathis_share.css" rel="stylesheet" type="text/css"><iframe frameborder="0" style="position: absolute; display: none; opacity: 0;" src="./Java日志终极指南 - ImportNew_files/saved_resource.html"></iframe><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; top: 50%; left: 50%; overflow: auto;"></div><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; overflow: auto;"></div><iframe frameborder="0" src="./Java日志终极指南 - ImportNew_files/jiathis_utility.html" style="display: none;"></iframe>

		
	
	<!-- BEGIN #top-nav -->
	<nav id="top-nav" class="menu-nav">
		
		<!-- BEGIN .container -->
		<div class="container">

			            <div class="grid-12">
            </div>
			<div class="clear"></div>
		
		</div>
		<!-- END .container -->
    
	</nav>
	<!-- END #top-nav -->
	
	  	
	<!-- BEGIN #wrapper -->
	<div id="wrapper" class="container">

		<!-- BEGIN header -->
		<header>
		
						
			<div class="header-wrapper">
								
				<!-- BEGIN #logo -->
				<div id="logo" class="leaderboard-true">
				
										<a href="http://www.importnew.com/"><img src="./Java日志终极指南 - ImportNew_files/6c537425c9ad078efe656a346e5facec.png" width="137" height="85" alt="ImportNew"></a>
									
				</div>
				<!-- END #logo -->
				
				<!-- BEGIN #leaderboard -->
				<div id="leaderboard">
				
									
				</div>
				<!-- END #leaderboard -->
				
				<div class="clear"></div>
			
			</div>
			
						
			<div class="clear"></div>
			
			<!-- BEGIN #main-nav -->
			<nav id="main-nav" class="grid-12 menu-nav">

				<div class="menu-main-container"><ul id="main-nav-menu" class="menu sf-js-enabled"><li id="menu-item-14265" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14265"><a href="http://www.importnew.com/">首页</a></li>
<li id="menu-item-14278" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-14278"><a href="http://www.importnew.com/all-posts">所有文章</a></li>
<li id="menu-item-858" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-858"><a href="http://www.importnew.com/cat/news">资讯</a></li>
<li id="menu-item-1120" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1120"><a href="http://www.importnew.com/cat/web-development">Web</a></li>
<li id="menu-item-1923" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1923"><a href="http://www.importnew.com/cat/architecture">架构</a></li>
<li id="menu-item-832" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-832"><a href="http://www.importnew.com/cat/basic">基础技术</a></li>
<li id="menu-item-836" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-836"><a href="http://www.importnew.com/cat/books">书籍</a></li>
<li id="menu-item-2183" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2183"><a href="http://www.importnew.com/cat/tutorial">教程</a></li>
<li id="menu-item-20858" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20858"><a href="http://group.jobbole.com/category/tech/java/" class="external" rel="nofollow" target="_blank">Java小组</a></li>
<li id="menu-item-20859" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20859"><a href="http://hao.jobbole.com/?catid=32" class="external" rel="nofollow" target="_blank">工具资源</a></li>
</ul><select class="selectnav" id="selectnav1"><option value="">- 导航条 -</option><option value="http://www.importnew.com/">首页</option><option value="http://www.importnew.com/all-posts">所有文章</option><option value="http://www.importnew.com/cat/news">资讯</option><option value="http://www.importnew.com/cat/web-development">Web</option><option value="http://www.importnew.com/cat/architecture">架构</option><option value="http://www.importnew.com/cat/basic">基础技术</option><option value="http://www.importnew.com/cat/books">书籍</option><option value="http://www.importnew.com/cat/tutorial">教程</option><option value="http://group.jobbole.com/category/tech/java/">Java小组</option><option value="http://hao.jobbole.com/?catid=32">工具资源</option></select></div>				
				<div class="clear"></div>
            
			</nav>
			<!-- END #main-nav -->
			
			<div class="clear"></div>
		
		</header>
		<!-- END header -->
		
		

<!-- BEGIN .grid-8 -->
<div class="grid-8">

		
	<!-- BEGIN .post -->
<div class="post-16331 post type-post status-publish format-standard hentry category-basic tag-29 odd" id="post-16331">
	
	<!-- BEGIN .entry-header -->
	<div class="entry-header">
	
				
		<h1>Java日志终极指南</h1>
		
							
	</div>
	<!-- BEGIN .entry-header -->
	
	<!-- BEGIN .entry-meta -->
	<div class="entry-meta">
	
		<p class="entry-meta-hide-on-mobile">2015/07/20 | 分类： <a href="http://www.importnew.com/cat/basic" title="查看 基础技术 中的全部文章" rel="category tag">基础技术</a> | <a href="http://www.importnew.com/16331.html#respond" title="《Java日志终极指南》上的评论">0 条评论</a>

		 | 标签： <a href="http://www.importnew.com/tag/%e6%97%a5%e5%bf%97">日志</a></p>
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style" style="display: block; margin: 0 0px; clear: both;"><span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_tsina" title="分享到微博"><span class="jiathis_txt jtico jtico_tsina"></span></a>
<a class="jiathis_button_weixin" title="分享到微信"><span class="jiathis_txt jtico jtico_weixin"></span></a>
<a class="jiathis_button_qzone" title="分享到QQ空间"><span class="jiathis_txt jtico jtico_qzone"></span></a>
<a class="jiathis_button_fb" title="分享到Facebook"><span class="jiathis_txt jtico jtico_fb"></span></a>
<a class="jiathis_button_renren" title="分享到人人网"><span class="jiathis_txt jtico jtico_renren"></span></a>
<a class="jiathis_button_douban" title="分享到豆瓣"><span class="jiathis_txt jtico jtico_douban"></span></a>
<a class="jiathis_button_readitlater"></a>
<a class="jiathis_button_evernote" title="分享到印象笔记"><span class="jiathis_txt jtico jtico_evernote"></span></a>
<a class="jiathis_button_ydnote" title="分享到有道云笔记"><span class="jiathis_txt jtico jtico_ydnote"></span></a>
<a href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
<a class="jiathis_counter_style"><span class="jiathis_button_expanded jiathis_counter jiathis_bubble_style" id="jiathis_counter_25" title="累计分享48次">48</span></a>
</div>
<!-- JiaThis Button END -->


	</div>
	<!-- END .entry-meta -->

	<!-- BEGIN .entry -->
	<div class="entry">

        
		<div class="copyright-area">本文由 <a href="http://www.importnew.com/">ImportNew</a> - <a href="http://www.importnew.com/author/wing011203">Wing</a> 翻译自 <a target="_blank" href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/" class="external" rel="nofollow">loggly</a>。欢迎加入<a href="http://group.jobbole.com/category/feedback/trans-team/" class="external" rel="nofollow" target="_blank">翻译小组</a>。转载请见文末要求。</div>
<article id="java-logging-basics">
<header>
<h2>Java日志基础</h2>
</header>
<p>Java使用了一种自定义的、可扩展的方法来输出日志。虽然Java通过java.util.logging包提供了一套基本的日志处理API，但你可以很轻松的使用一种或者多种<span style="color: #000000;">其它</span>日志解决方案。这些解决方案尽管使用不同的方法来创建日志数据，但它们的最终目标是一样的，即将日志从你的应用程序输出到目标地址。</p>
<p>在这一节中，我们会探索Java日志背后的原理，并说明如何通过日志来让你成为一个更好的Java开发人员。</p>
</article>
<article id="java-logging-components">
<header>
<h2>Java日志组件</h2>
</header>
<p>Java日志API由以下三个<span style="color: #000000;">核心</span>组件组成：</p>
<ul>
<li><a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#loggers" class="external" rel="nofollow" target="_blank">Loggers</a>：Logger负责捕捉事件并将其发送给<span style="color: #000000;">合适的</span>Appender。</li>
<li><a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#appenders" class="external" rel="nofollow" target="_blank">Appenders</a>：也被称为Handlers，负责将日志事件记录到目标位置。在将日志事件输出之前，Appenders使用Layouts来对事件进行格式化处理。</li>
<li><a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#layouts" class="external" rel="nofollow" target="_blank">Layouts</a>：也被称为Formatters，它负责对日志事件中的数据进行转换和格式化。Layouts决定了数据在一条日志记录中的最终形式。</li>
</ul>
<p>当Logger记录一个事件时，它将事件转发给适当的Appender。然后Appender使用Layout来对日志记录进行格式化，并将其发送给控制台、文件或者<span style="color: #000000;">其它</span>目标位置。另外，Filters可以让你进一步指定一个Appender是否可以应用在一条特定的日志记录上。在日志配置中，Filters并不是必需的，但可以让你更灵活<span style="color: #000000;">地</span>控制日志消息的流动。</p>
<p><a href="http://www.importnew.com/?attachment_id=16335" rel="attachment wp-att-16335"><img class="aligncenter size-full wp-image-16335" title="image00" src="./Java日志终极指南 - ImportNew_files/f5aad4cacde983e6884fa3abf2df701e.png" alt=""></a></p>
<p>&nbsp;</p>
</article>
<article id="logging-frameworks">
<h2>日志框架</h2>
<p>在Java中，输出日志需要使用一个或者多个日志框架，这些框架提供了必要的对象、方法和配置来传输消息。Java在java.util.logging包中提供了一个默认的框架<span style="color: #000000;">。</span>除此之外，还有很多<span style="color: #000000;">其它</span>第三方框架，包括<a href="http://logging.apache.org/log4j" class="external" rel="nofollow" target="_blank">Log4j</a>、<a href="http://logback.qos.ch/" class="external" rel="nofollow" target="_blank">Logback</a>以及<a href="http://www.tinylog.org/" class="external" rel="nofollow" target="_blank">tinylog</a>。还有其它一些<span style="color: #000000;">开发</span>包，例如<a href="http://www.slf4j.org/" class="external" rel="nofollow" target="_blank">SLF4J</a>和<a href="http://commons.apache.org/proper/commons-logging/" class="external" rel="nofollow" target="_blank">Apache Commons Logging</a>，它们提供了一些抽象层，对你的代码和日志框架进行解耦，从而允许你在不同的日志框架中进行切换。</p>
<p>如何选择一个日志解决方案，这取决于你的日志需求的复杂度、和<span style="color: #000000;">其它</span>日志解决方案的兼容性、易用性以及个人喜好。Logback基于Log4j之前的版本开发（版本1），因此它们的功能集合都非常类似。然而，Log4j在最新版本（版本2）中引用了一些改进，例如支持多API，并提升了在用<a href="https://github.com/LMAX-Exchange/disruptor" class="external" rel="nofollow" target="_blank">Disruptor</a>库的性能。而tinylog，由于缺少了一些功能，运行特别快，非常适合小项目。</p>
<p>另外一个考虑因素是框架在基于Java的<span style="color: #000000;">各种不同</span>项目上的支持程度。例如Android程序只能使用<a href="http://code.google.com/p/android-logging-log4j/" class="external" rel="nofollow" target="_blank">Log4j</a>、<a href="http://tony19.github.io/logback-android/" class="external" rel="nofollow" target="_blank">Logback</a>或者第三方包来记录日志， Apache Tomcat可以使用Log4j来记录内部消息，但只能使用版本1的Log4j。</p>
<h3>抽象层</h3>
<p>诸如SLF4J<span style="color: #000000;">这样的抽象层</span>，会将你的应用程序从日志框架中解耦。应用程序可以在运行时选择绑定到一个特定的日志框架（例如java.util.logging、Log4j或者Logback），这通过在应用程序的类路径中添加对应的日志框架来实现。如果在类路径中配置的日志框架不可用，抽象层就会立刻取消调用日志的<span style="color: #000000;">相应</span>逻辑。抽象层可以让我们更加容易<span style="color: #000000;">地改</span>变项目现有的日志框架，或者集成那些使用了不同日志框架的项目。</p>
</article>
<article id="configuration">
<header>
<h2>配置</h2>
</header>
<p>尽管所有的Java日志框架都可以通过代码进行配置，但是大部分配置还是通过外部配置文件完成的。这些文件决定了日志消息在何时通过什么方式进行处理，日志框架可以在运行时加载这些文件。在这一节中提供的大部分配置示例都使用了配置文件。</p>
<p><strong>java.util.logging</strong></p>
<p>默认的Java日志框架将其配置存储到一个名为 logging.properties 的文件中。在<span style="color: #000000;">这个</span>文件中，每行是一个配置项，配置项使用点标记<span style="color: #000000;">（dot notation）的</span>形式。Java在其安装目录的lib文件夹下面安装了一个全局配置文件，但在启动一个Java程序时，你可以通过指定 java.util.logging.config.file 属性的方式来使用一个单独的日志配置文件，同样也可以在个人项目中创建和存储 logging.properties 文件。</p>
<p>下面的示例描述了如何在全局的logging.properties文件中定义一个Appender：</p>
<div><div id="highlighter_106690" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain"># default file output is in user's home directory.</code></div><div class="line number2 index1 alt1"><code class="text plain">java.util.logging.FileHandler.pattern = %h/java%u.log</code></div><div class="line number3 index2 alt2"><code class="text plain">java.util.logging.FileHandler.limit = 50000</code></div><div class="line number4 index3 alt1"><code class="text plain">java.util.logging.FileHandler.count = 1</code></div><div class="line number5 index4 alt2"><code class="text plain">java.util.logging.FileHandler.formatter = java.util.logging.XmlFormatter</code></div></div></td></tr></tbody></table></div></div>
<h3>Log4j</h3>
<p>Log4j<a href="https://logging.apache.org/log4j/1.2/manual.html#Configuration" class="external" rel="nofollow" target="_blank">版本1</a>使用的语法和 java.util.logging 的语法很类似。使用了Log4j的程序会在项目目录中寻找一个名为 log4j.properties 的文件。默认情况下，Log4j配置会将所有日志消息输出到控制台上。Log4j同样也支持XML格式的配置文件，对应的配置信息会存储到 log4j.xml 文件中。</p>
<p><span style="font-size: 13px;">Log4j<a href="http://logging.apache.org/log4j/2.x/manual/configuration.html" class="external" rel="nofollow" target="_blank">版本2</a>支持XML、JSON和YAML格式的配置，这些配置会分别存储到 log4j2.xml、log4j2.json 和 log4j2.yaml 文件中。和版本1类似，版本2也会在工程目录中寻找这些文件。你可以在每个版本的文档中找到相应的配置文件示例。</span></p>
<h3>Logback</h3>
<p>对于Logback来说，大部分配置都是在 <a href="http://logback.qos.ch/manual/configuration.html" class="external" rel="nofollow" target="_blank">logback.xml</a> 文件中完成的，这个文件使用了和Log4j类似的XML语法。Logback同时也支持通过Groovy语言的方式来进行配置，配置信息会存储到 <a href="http://logback.qos.ch/manual/groovy.html" class="external" rel="nofollow" target="_blank">logback.groovy</a> 文件中。你可以通过每种类型配置文件的链接找到对应的配置文件示例。</p>
</article>
<article id="loggers">
<header>
<h2>Loggers</h2>
</header>
<p>Loggers是用来触发日志事件的对象，在我们的Java应用程序中被创建和调用，然后Loggers才会将事件传递给Appender。一个类中可以包含针对不同事件的多个独立的Loggers，你也可以在一个Loggers里面内嵌一个Loggers，从而创建一种Loggers<a href="http://tutorials.jenkov.com/java-logging/logger-hierarchy.html" class="external" rel="nofollow" target="_blank">层次结构</a>。</p>
<h3>创建新Logger</h3>
<p>在不同的日志框架下面创建新Logger过程大同小异，尽管调用的具体方法名称可能不同。在使用 java.util.logging 时，你可以通过 Logger.getLogger().getLogger() 方法创建新Logger，这个方法接收一个string参数，用于指定Logger的名字。如果指定名字的Logger已经存在，那么只需要返回已经存在的Logger；否则，程序会创建一个新Logger。通常情况下，一种好的做法是<span style="color: #000000;">，</span>我们在当前类下使用 class.getName() 作为新Logger的名字。</p>
<div><div id="highlighter_363012" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">Logger logger = Logger.getLogger(MyClass.</code><code class="java keyword">class</code><code class="java plain">.getName());</code></div></div></td></tr></tbody></table></div></div>
<h3>记录日志事件</h3>
<p>Logger提供了几种方法来触发日志事件。然而<del><span style="color: #ff0000;">，</span></del>在你记录一个事件之前，你还需要设置级别。日志级别用来确定日志的严重程度，它可以用来过滤日志事件或者将其发送给不同的Appender（想了解更多信息，请参考“<a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#log-levels" class="external" rel="nofollow" target="_blank">日志级别</a>”一节），Logger.log() 方法除了日志消息以外，还需要一个日志级别作为参数：</p>
<div><div id="highlighter_563120" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">logger.log(Level.WARNING, “This is a warning!”);</code></div></div></td></tr></tbody></table></div></div>
<p>大部分日志框架都针对输出特定级别日志提供了快捷方式。例如，下面语句的作用和上面语句的作用是一样的：</p>
<div><div id="highlighter_407893" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">logger.warning(“This is a warning!”);</code></div></div></td></tr></tbody></table></div></div>
<p>你还可以阻止Logger输出低于指定日志级别的消息<span style="color: #000000;">。</span>在<span style="color: #000000;">下面的</span>示例中，Logger只能输出<del></del><span style="color: #000000;">高于</span>WARNING<del></del><span style="color: #000000;">级别的日志消息</span>，并丢弃日志级别<span style="color: #000000;">低于</span>WARNING的消息：</p>
<div><div id="highlighter_819031" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">logger.setLevel(Level.WARNING);</code></div></div></td></tr></tbody></table></div></div>
<p>我们还有另外一些方法可以用来记录额外的信息。logp()（精确<span style="color: #000000;">日志</span>）可以让你指定每条日志记录的源类<span style="color: #000000;">（source class）</span>和方法，而 logrb()<span style="color: #000000;">（使用资源绑定的日志）</span>可以让你指定用于<span style="color: #000000;">提取</span>日志消息的资源。entering() 和 exiting() 方法可以让你记录方法调用信息，从而<a href="http://www.loggly.com/ultimate-guide/logging/troubleshooting-with-java-logs/#tracing-transactions" class="external" rel="nofollow" target="_blank">追踪</a>程序的执行过程。</p>
</article>
<article id="appenders">
<header>
<h2>Appenders</h2>
</header>
<p>Appenders将日志消息转发给期望的输出<span style="color: #000000;">。</span>它负责接收日志事件，使用Layout格式化事件，然后将其发送给对应的<span style="color: #000000;">目标</span>。对于一个日志事件，我们可以使用多个Appenders来将事件发送到不同的目标位置。例如，我们可以在控制台上显示一个简单的日志事件的同时，将其通过邮件的方式发送给指定的接收者。</p>
<p>请注意，在java.util.logging中，Appenders被称作Handlers。</p>
<h3>增加Appender</h3>
<p>大部分日志框架的Appender都会执行类似的功能，但在实现方面大相径庭。如果使用 java.util.logging，你可以使用 Logger.addHandler() 方法将Appender添加到Logger中。例如，下面的代码添加了一个新的ConsoleHandler，它会将日志输出到控制台：</p>
<div><div id="highlighter_778499" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">logger.addHandler(</code><code class="java keyword">new</code> <code class="java plain">ConsoleHandler());</code></div></div></td></tr></tbody></table></div></div>
<p><span style="color: #000000;">一种</span>更常用的添加Appender的方式是使用配置文件<span style="color: #000000;">。</span>如果使用 java.util.logging，Appenders会定义一个以逗号隔开的列表，下面的示例将日志事件输出到控制台和文件：</p>
<div><div id="highlighter_211116" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">handlers=java.util.logging.ConsoleHandler, java.util.logging.FileHandler</code></div></div></td></tr></tbody></table></div></div>
<p>如果使用基于XML的配置文件，Appenders会被添加到&lt;Appenders&gt;元素下面，如果使用Log4j，我们可以<span style="color: #000000;">很容易地</span>添加一个新ConsoleAppender来将日志消息发送到System.out：</p>
<div><div id="highlighter_974186" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Console</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"console"</code> <code class="xml color1">target</code><code class="xml plain">=</code><code class="xml string">"SYSTEM_OUT"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"[%p] %t: %m%n"</code> <code class="xml plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">Console</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
</article>
<article id="types-of-appenders">
<header>
<h2>Appenders类型</h2>
</header>
<p>这一节描述了一些更通用的Appenders，以及它们在各种日志框架中是如何实现的。</p>
<h3>ConsoleAppender</h3>
<p>ConsoleAppender是最常用的Appenders之一，它只是将日志消息显示到控制台上。许多日志框架都将其作为默认的Appender，并且在基本的配置中进行预配置。例如，在Log4j中ConsoleAppender的配置参数如下所示。</p>
<table>
<tbody>
<tr>
<th><strong>参数</strong></th>
<th><strong>描述</strong></th>
</tr>
<tr>
<td>filter</td>
<td>用于决定是否需要使用该Appender来处理日志事件</td>
</tr>
<tr>
<td>layout</td>
<td>用于决定如何对日志记录进行格式化，默认情况下使用“%m%n”，它会在每一行显示一条日志记录</td>
</tr>
<tr>
<td>follow</td>
<td>用于决定Appender是否需要了解输出（system.out或者system.err）的变化，默认情况是不需要跟踪这种变化</td>
</tr>
<tr>
<td>name</td>
<td>用于设置Appender的名字</td>
</tr>
<tr>
<td>ignoreExceptions</td>
<td>用于决定是否需要记录在日志事件处理过程中出现的异常</td>
</tr>
<tr>
<td>target</td>
<td>用于指定输出目标位置，默认情况下使用SYSTEM_OUT，但也可以修改成SYSTEM_ERR</td>
</tr>
</tbody>
</table>
<p>一个完整的Log4j2的配置文件如下所示：</p>
<div><div id="highlighter_455529" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;?</code><code class="xml keyword">xml</code> <code class="xml color1">version</code><code class="xml plain">=</code><code class="xml string">"1.0"</code> <code class="xml color1">encoding</code><code class="xml plain">=</code><code class="xml string">"UTF-8"</code><code class="xml plain">?&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Configuration</code> <code class="xml color1">status</code><code class="xml plain">=</code><code class="xml string">"warn"</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyApp"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Console</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyAppender"</code> <code class="xml color1">target</code><code class="xml plain">=</code><code class="xml string">"SYSTEM_OUT"</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%m%n"</code><code class="xml plain">/&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">Console</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Loggers</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Root</code> <code class="xml color1">level</code><code class="xml plain">=</code><code class="xml string">"error"</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">AppenderRef</code> <code class="xml color1">ref</code><code class="xml plain">=</code><code class="xml string">"MyAppender"</code><code class="xml plain">/&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">Root</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">Loggers</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">Configuration</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>这个配置文件创建了一个名为MyAppender的ConsoleAppender，它使用PatternLayout来对日志事件进行格式化，然后再将其输出到System.out。&lt;Loggers&gt;元素对定义在程序代码中的Loggers进行了配置。在这里，我们只配置了一个LoggerConfig，即名为Root的Logger，它会接收哪些日志级别在ERROR以上的日志消息。如果我们使用logger.error()来记录一个消息，那么它就会出现在控制台上，就像这样：</p>
<div><div id="highlighter_78061" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">An unexpected error occurred.</code></div></div></td></tr></tbody></table></div></div>
<p>你也可以使用Logback实现完全一样的效果：</p>
<div><div id="highlighter_706394" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">appender</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyAppender"</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.core.ConsoleAppender"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">encoder</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pattern</code><code class="xml plain">&gt;%m%n&lt;/</code><code class="xml keyword">pattern</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">encoder</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">appender</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">root</code> <code class="xml color1">level</code><code class="xml plain">=</code><code class="xml string">"error"</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">appender-ref</code> <code class="xml color1">ref</code><code class="xml plain">=</code><code class="xml string">"MyAppender"</code> <code class="xml plain">/&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">root</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<h3>FileAppenders</h3>
<p>FileAppenders将日志记录写入到文件中，它负责打开、关闭文件，向文件中追加日志记录，并对文件进行加锁，以免数据被破坏或者<span style="color: #000000;">覆盖</span>。</p>
<p>在Log4j中，如果想创建一个FileAppender，需要指定目标文件的名字，写入方式是追加还是覆盖，以及是否需要在写入日志时对文件进行加锁：</p>
<div><div id="highlighter_861368" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">File</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyFileAppender"</code> <code class="xml color1">fileName</code><code class="xml plain">=</code><code class="xml string">"myLog.log"</code> <code class="xml color1">append</code><code class="xml plain">=</code><code class="xml string">"true"</code> <code class="xml color1">locking</code><code class="xml plain">=</code><code class="xml string">"true"</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%m%n"</code><code class="xml plain">/&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">File</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>这样我们创建了一个名为MyFileAppender的FileAppender，并且在向文件中追加日志时会对文件进行加锁操作。</p>
<p>如果使用Logback，你可以同时启用prudent模式来保证文件的完整性。虽然Prudent模式增加了写入文件所花费的时间，但它可以保证在多个FileAppender甚至多个Java程序向同一个文件写入日志时，文件的完整性。</p>
<div><div id="highlighter_979179" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">appender</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"FileAppender"</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.core.FileAppender"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">file</code><code class="xml plain">&gt;myLog.log&lt;/</code><code class="xml keyword">file</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">append</code><code class="xml plain">&gt;true&lt;/</code><code class="xml keyword">append</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">prudent</code><code class="xml plain">&gt;true&lt;/</code><code class="xml keyword">prudent</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">encoder</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pattern</code><code class="xml plain">&gt;%m%n&lt;/</code><code class="xml keyword">pattern</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">encoder</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">appender</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<h3>SyslogAppender</h3>
<p>SyslogAppenders将日志记录发送给本地或者远程系统的日志服务。<a href="http://www.networkmanagementsoftware.com/what-is-syslog" class="external" rel="nofollow" target="_blank">syslog</a>是一个接收日志事件服务，这些日志事件来自操作系统、进程、<span style="color: #000000;">其它</span>服务或者<span style="color: #000000;">其它</span>设备。事件的范围可以从诊断信息到用户登录硬件失败等。syslog的事件按照<span style="color: #000000;">设备</span>进行分类，它指定了正在记录的事件的类型。例如，auth facility表明这个事件是和安全以及认证有关。</p>
<p>Log4j和Logback都内置支持SyslogAppenders<span style="color: #000000;">。</span>在Log4j中，我们创建SyslogAppender时，需要指定syslog服务监听的主机号、端口号以及协议。下面的示例演示了如何设定<span style="color: #000000;">装置</span>：</p>
<div><div id="highlighter_155979" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Syslog</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"SyslogAppender"</code> <code class="xml color1">host</code><code class="xml plain">=</code><code class="xml string">"localhost"</code> <code class="xml color1">port</code><code class="xml plain">=</code><code class="xml string">"514"</code> <code class="xml color1">protocol</code><code class="xml plain">=</code><code class="xml string">"UDP"</code> <code class="xml color1">facility</code><code class="xml plain">=</code><code class="xml string">"Auth"</code> <code class="xml plain">/&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">Appenders</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>在Logback中，我们可以实现同样的效果：</p>
<div><div id="highlighter_373193" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">appender</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"SyslogAppender"</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.classic.net.SyslogAppender"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">syslogHost</code><code class="xml plain">&gt;localhost&lt;/</code><code class="xml keyword">syslogHost</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">port</code><code class="xml plain">&gt;514&lt;/</code><code class="xml keyword">port</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">facility</code><code class="xml plain">&gt;Auth&lt;/</code><code class="xml keyword">facility</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">appender</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<h3><span style="color: #000000;">其它</span>Appender</h3>
<p>我们已经介绍了一些经常用到的Appenders，还有很多<span style="color: #000000;">其它</span>Appender<span style="color: #000000;">。</span>它们添加了新功能或者在<span style="color: #000000;">其它</span>的一些Appender基础上实现了新功能。例如，Log4j中的RollingFileAppender扩展了FileAppender，它可以在满足特定条件时自动创建新的日志文件；SMTPAppender会将日志内容以邮件的形式发送出去；FailoverAppender会在处理日志的过程中，如果一个或者多个Appender失败，自动切换到其他Appender上。</p>
<p>如果想了解更多关于其他Appender的信息，可以查看<a href="https://logging.apache.org/log4j/2.x/manual/appenders.html" class="external" rel="nofollow" target="_blank">Log4j Appender参考</a>以及<a href="http://logback.qos.ch/manual/appenders.html" class="external" rel="nofollow" target="_blank">Logback Appender参考</a>。</p>
</article>
<article id="layouts">
<header>
<h2>Layouts</h2>
</header>
<p>Layouts将日志记录的内容从一种数据形式转换成另外一种。日志框架为纯文本、HTML、syslog、XML、JSON、序列化以及<span style="color: #000000;">其它</span>日志提供了Layouts。</p>
<p>请注意<span style="color: #000000;">：</span>在java.util.logging中Layouts也被称为Formatters。</p>
<p>例如，java.util.logging提供了两种Layouts：SimpleFormatter和XMLFormatter。默认情况下，ConsoleHandlers使用SimpleFormatter，它输出的纯文本日志记录就像这样：</p>
<div><div id="highlighter_794970" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">Mar 31, 2015 10:47:51 AM MyClass main</code></div><div class="line number2 index1 alt1"><code class="shell plain">SEVERE: An exception occurred.</code></div></div></td></tr></tbody></table></div></div>
<p>而默认情况下，FileHandlers使用XMLFormatter，它的输出就像这样：</p>
<div><div id="highlighter_427222" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;?</code><code class="xml keyword">xml</code> <code class="xml color1">version</code><code class="xml plain">=</code><code class="xml string">"1.0"</code> <code class="xml color1">encoding</code><code class="xml plain">=</code><code class="xml string">"UTF-8"</code> <code class="xml color1">standalone</code><code class="xml plain">=</code><code class="xml string">"no"</code><code class="xml plain">?&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;!DOCTYPE log SYSTEM "logger.dtd"&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">log</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">record</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">date</code><code class="xml plain">&gt;2015-03-31T10:47:51&lt;/</code><code class="xml keyword">date</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">millis</code><code class="xml plain">&gt;1427903275893&lt;/</code><code class="xml keyword">millis</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sequence</code><code class="xml plain">&gt;0&lt;/</code><code class="xml keyword">sequence</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">logger</code><code class="xml plain">&gt;MyClass&lt;/</code><code class="xml keyword">logger</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">level</code><code class="xml plain">&gt;SEVERE&lt;/</code><code class="xml keyword">level</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">class</code><code class="xml plain">&gt;MyClass&lt;/</code><code class="xml keyword">class</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">method</code><code class="xml plain">&gt;main&lt;/</code><code class="xml keyword">method</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">thread</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">thread</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">message</code><code class="xml plain">&gt;An exception occurred.&lt;/</code><code class="xml keyword">message</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">record</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">log</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<h3>配置Layout</h3>
<p>我们通常使用配置文件对Layouts进行配置<span style="color: #000000;">。</span>从Java 7开始，我们也可以使用<a href="http://stackoverflow.com/questions/194765/how-do-i-get-java-logging-output-to-appear-on-a-single-line#comment34641997_197361" class="external" rel="nofollow" target="_blank">system property</a>来配置SimpleFormatter。</p>
<p>例如，在Log4j和Logback中最常用的Layouts是PatternLayout。它可以让你决定日志事件中的哪些部分需要输出，这是通过转换模式（<a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#conversion-patterns" class="external" rel="nofollow" target="_blank">Conversion Pattern</a>）完成的，转换模式在每一条日志事件的数据中扮演了“占位符”的角色。例如，Log4j默认的PatternLayout使用了如下转换模式：</p>
<div><div id="highlighter_375892" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"</code><code class="xml plain">/&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>%d{HH:mm:ss.SSS} 将日期转换成时、分、秒和毫秒的形式，%level显示日志事件的严重程度，%C显示生成日志事件的类的名字，%t显示Logger的当前线程，%m显示时间的消息，最后，%n为下一个日志事件进行了换行。</p>
<h3>改变Layouts</h3>
<p>如果在java.util.logging中使用一个不同的Layout，需要将Appender的formatter属性设置成你想要的Layout<span style="color: #000000;">。</span>在代码中，你可以创建一个新的Handler，调用setFormatter方法，然后通过logger.AddHandler()方法将Handler放到Logger上面。下面的示例创建了一个ConsoleAppender，它使用XMLFormatter来对日志进行格式化，而不是使用默认的SimpleFormatter：</p>
<div><div id="highlighter_541810" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">Handler ch = </code><code class="java keyword">new</code> <code class="java plain">ConsoleHandler();</code></div><div class="line number2 index1 alt1"><code class="java plain">ch.setFormatter(</code><code class="java keyword">new</code> <code class="java plain">XMLFormatter());</code></div><div class="line number3 index2 alt2"><code class="java plain">logger.addHandler(ch);</code></div></div></td></tr></tbody></table></div></div>
<p>这样Logger会将<del></del><span style="color: #000000;">下面的</span>信息输出到控制台上：</p>
<div><div id="highlighter_146600" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;?</code><code class="xml keyword">xml</code> <code class="xml color1">version</code><code class="xml plain">=</code><code class="xml string">"1.0"</code> <code class="xml color1">encoding</code><code class="xml plain">=</code><code class="xml string">"UTF-8"</code> <code class="xml color1">standalone</code><code class="xml plain">=</code><code class="xml string">"no"</code><code class="xml plain">?&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;!DOCTYPE log SYSTEM "logger.dtd"&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">log</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">record</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">date</code><code class="xml plain">&gt;2015-03-31T10:47:51&lt;/</code><code class="xml keyword">date</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">millis</code><code class="xml plain">&gt;1427813271000&lt;/</code><code class="xml keyword">millis</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sequence</code><code class="xml plain">&gt;0&lt;/</code><code class="xml keyword">sequence</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">logger</code><code class="xml plain">&gt;MyClass&lt;/</code><code class="xml keyword">logger</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">level</code><code class="xml plain">&gt;SEVERE&lt;/</code><code class="xml keyword">level</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">class</code><code class="xml plain">&gt;MyClass&lt;/</code><code class="xml keyword">class</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">method</code><code class="xml plain">&gt;main&lt;/</code><code class="xml keyword">method</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">thread</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">thread</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">message</code><code class="xml plain">&gt;An exception occurred.&lt;/</code><code class="xml keyword">message</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">record</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>如果想了解更多信息，你可以查看<a href="https://logging.apache.org/log4j/2.x/manual/layouts.html" class="external" rel="nofollow" target="_blank">Log4j Layouts参考</a>以及<a href="http://logback.qos.ch/manual/layouts.html" class="external" rel="nofollow" target="_blank">Logback Layouts参考</a>。</p>
<h3>使用自定义Layouts</h3>
<p>自定义Layouts可以让你指定Appender应该如何输出日志记录。<a href="http://docs.oracle.com/javase/7/docs/api/index.html?java/util/logging/SimpleFormatter.html" class="external" rel="nofollow" target="_blank">从Java SE 7开始</a>，尽管你可以调整SimpleLogger的输出，但有一个限制，即只能够调整简单的纯文本消息。对于更高级的格式，例如HTML或者JSON，你需要一个自定义Layout或者一个单独的框架。</p>
<p>如果想了解更多使用java.util.logging创建自定义Layouts的信息，你可以查看Jakob Jenkov的Java日志指南中的<a href="http://tutorials.jenkov.com/java-logging/formatters.html" class="external" rel="nofollow" target="_blank">Java Logging: Formatters</a><span style="color: #000000;">章节</span>。</p>
</article>
<article id="log-levels">
<header>
<h2>日志级别</h2>
</header>
<p>日志级别提供了一种方式，我们可以用它来根据严重程度对日志进行分类和识别。java.util.logging 按照严重程度从重到轻，提供了以下级别：</p>
<ul>
<li>SEVERE<span style="color: #000000;">（最高级别）</span></li>
<li>WARNING</li>
<li>INFO</li>
<li>CONFIG</li>
<li>FINE</li>
<li>FINER</li>
<li>FINEST<span style="color: #000000;">（最低级别）</span></li>
</ul>
<p><span style="color: #1c1917; font-family: robotolight;">另外， 还有两个日志级别：ALL和OFF。ALL会让Logger输出所有消息，而OFF则会关闭日志功能。<br>
</span></p>
<h3>设置日志级别</h3>
<p>在设定日志级别后，Logger会自动忽略那些低于设定级别的日志消息。例如，下面的语句会让Logger忽略那些低于WARNING级别的日志消息：</p>
<div><div id="highlighter_135528" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">logger.setLevel(Level.WARNING);</code></div></div></td></tr></tbody></table></div></div>
<p>然后，Logger会记录任何WARNING或者更高级别的日志消息。我们也可以在配置文件中设置Logger的日志级别：</p>
<div><div id="highlighter_960410" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">Loggers</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Logger</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyLogger"</code> <code class="xml color1">level</code><code class="xml plain">=</code><code class="xml string">"warning"</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
</article>
<article id="conversion-patterns">
<header>
<h2>转换模式</h2>
</header>
<p>Log4j和Logback中的PatternLayout类都支持转换模式，它决定了我们如何从每一条日志事件中提取信息以及如何对信息进行格式化。下面显示了这些模式的一个子集，对于Log4j和Logback来说，虽然这些特定的字段都是一样的，但是并不是所有的字段都会使用相同的模式。想要了解更多信息，可以查看<a href="http://logging.apache.org/log4j/2.x/manual/layouts.html#Patterns" class="external" rel="nofollow" target="_blank">Log4j</a>和<a href="http://logback.qos.ch/manual/layouts.html#ClassicPatternLayout" class="external" rel="nofollow" target="_blank">Logback</a>的PatternLayout文档。</p>
<table width="586">
<tbody>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>Log4j/Logback 模式</strong></th>
</tr>
<tr>
<td>消息</td>
<td>%m</td>
</tr>
<tr>
<td>级别/严重程度</td>
<td>%p</td>
</tr>
<tr>
<td>异常</td>
<td>%ex</td>
</tr>
<tr>
<td>线程</td>
<td>%t</td>
</tr>
<tr>
<td>Logger</td>
<td>%c</td>
</tr>
<tr>
<td>方法</td>
<td>%M</td>
</tr>
</tbody>
</table>
<p>例如，下面的PatternLayout会在中括号内x显示日志级别，后面是线程名字和日志事件的消息：</p>
<div><div id="highlighter_261210" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m</code></div></div></td></tr></tbody></table></div></div>
<p>下面是使用了上述转换模式后的日志输出示例：</p>
<div><div id="highlighter_886840" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">[INFO] main: initializing worker threads</code></div><div class="line number2 index1 alt1"><code class="shell plain">[DEBUG] worker: listening on port 12222[INFO] worker: received request from 192.168.1.200[ERROR] worker: unknown request ID from 192.168.1.200</code></div></div></td></tr></tbody></table></div></div>
</article>
<article id="logging-stack-traces">
<header>
<h2>记录栈跟踪信息</h2>
</header>
<p>如果你在Java程序中使用过<a href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/#uncaught_exceptions" class="external" rel="nofollow" target="_blank">异常</a>，那么很有可能已经看到过栈跟踪信息<span style="color: #000000;">。</span>它提供了一个程序中方法调用的快照，让你准确定位程序执行的位置。例如，下面的栈跟踪信息是程序试图打开一个不存在的文件后生成的：</p>
<div><div id="highlighter_396429" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">[ERROR] main: Unable to </code><code class="shell functions">open</code> <code class="shell functions">file</code><code class="shell plain">! java.io.FileNotFoundException: foo.</code><code class="shell functions">file</code> <code class="shell plain">(No such </code><code class="shell functions">file</code> <code class="shell plain">or directory)</code></div><div class="line number2 index1 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.</code><code class="shell functions">open</code><code class="shell plain">(Native Method) ~[?:1.7.0_79]</code></div><div class="line number3 index2 alt2"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:146) ~[?:1.7.0_79]</code></div><div class="line number4 index3 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:101) ~[?:1.7.0_79]</code></div><div class="line number5 index4 alt2"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileReader.&lt;init&gt;(FileReader.java:58) ~[?:1.7.0_79]</code></div><div class="line number6 index5 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at FooClass.main(FooClass.java:47)</code></div></div></td></tr></tbody></table></div></div>
<p>这个示例使用了一个名为FooClass的类，它包含一个main方法<span style="color: #000000;">。</span>在程序第47行，FileReader独享试图打开一个名为foo.file的文件，由于在程序目录下没有名字是foo.file的文件，因此Java虚拟机<span style="color: #000000;">抛出</span>了一个FileNotFoundException。因为这个方法调用被放到了try-catch语块中，所以我们能够捕获这个异常并记录它，或者至少可以阻止程序崩溃。</p>
<h3>使用PatternLayout记录栈跟踪信息</h3>
<p>在写本篇文章时最新版本的Log4j和Logback中，如果在Layout中没有和可抛异常相关的信息，那么都会自动将%xEx（这种栈跟踪信息包含了每次方法调用的包信息）添加到PatternLayout中。如果对于普通的日志信息的模式如下：</p>
<div><div id="highlighter_925692" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m</code></div></div></td></tr></tbody></table></div></div>
<p>它会变为：</p>
<div><div id="highlighter_771368" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m%xEx</code></div></div></td></tr></tbody></table></div></div>
<p>这样不仅仅错误信息会被记录下来，完整的栈跟踪信息也会被记录：</p>
<div><div id="highlighter_784102" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">[ERROR] main: Unable to </code><code class="shell functions">open</code> <code class="shell functions">file</code><code class="shell plain">! java.io.FileNotFoundException: foo.</code><code class="shell functions">file</code> <code class="shell plain">(No such </code><code class="shell functions">file</code> <code class="shell plain">or directory)</code></div><div class="line number2 index1 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.</code><code class="shell functions">open</code><code class="shell plain">(Native Method) ~[?:1.7.0_79]</code></div><div class="line number3 index2 alt2"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:146) ~[?:1.7.0_79]</code></div><div class="line number4 index3 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:101) ~[?:1.7.0_79]</code></div><div class="line number5 index4 alt2"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.io.FileReader.&lt;init&gt;(FileReader.java:58) ~[?:1.7.0_79]</code></div><div class="line number6 index5 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at FooClass.main(FooClass.java:47)</code></div></div></td></tr></tbody></table></div></div>
<p>%xEx中的包查询是一个代价昂贵的操作，如果你频繁的记录异常信息，那么可能会碰到性能问题，例如：</p>
<div><div id="highlighter_469634" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java comments">// ...</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">} </code><code class="java keyword">catch</code> <code class="java plain">(FileNotFoundException ex) {</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">logger.error(“Unable to open file!”, ex);</code></div><div class="line number4 index3 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>一种解决方法是在模式中显式的包含%ex，这样就只会请求异常的栈跟踪信息：</p>
<div><div id="highlighter_90219" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m%ex</code></div></div></td></tr></tbody></table></div></div>
<p>另外一种方法是通过追加%xEx(none)的方法<span style="color: #000000;">排除（在Log4j）中</span>所有的异常信息：</p>
<div><div id="highlighter_348264" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m%xEx{none}</code></div></div></td></tr></tbody></table></div></div>
<p>或者在Logback中使用%nopex：</p>
<div><div id="highlighter_972859" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">[%p] %t: %m%nopex</code></div></div></td></tr></tbody></table></div></div>
<h3>使用结构化布局输出栈跟踪信息</h3>
<p>如你在“<a href="http://www.loggly.com/ultimate-guide/logging/parsing-java-logs/#parsing-multi-line-stack-traces" class="external" rel="nofollow" target="_blank">解析多行栈跟踪信息</a>”一节中所见，对于站跟踪信息来说，使用结构化布局来记录是最合适的方式，例如JSON和XML。 这些布局会自动将栈跟踪信息按照核心组件进行分解，这样我们可以很容易将其导出到其他程序或者日志服务中。对于上述站跟踪信息，如果使用JSON格式，部分信息显示如下：</p>
<div><div id="highlighter_471544" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">...</code></div><div class="line number2 index1 alt1"><code class="text plain">"loggerName" : "FooClass",</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"message" : "Foo, oh no! ",</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"thrown" : {</code></div><div class="line number5 index4 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"commonElementCount" : 0,</code></div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"localizedMessage" : "foo.file (No such file or directory)",</code></div><div class="line number7 index6 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"message" : "foo.file (No such file or directory)",</code></div><div class="line number8 index7 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"name" : "java.io.FileNotFoundException",</code></div><div class="line number9 index8 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"extendedStackTrace" : [ {</code></div><div class="line number10 index9 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"class" : "java.io.FileInputStream",</code></div><div class="line number11 index10 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"method" : "open",</code></div><div class="line number12 index11 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"file" : "FileInputStream.java",</code></div><div class="line number13 index12 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">...</code></div></div></td></tr></tbody></table></div></div>
<h3>记录未捕获异常</h3>
<p>通常情况下，我们通过捕获的方式来处理异常<span style="color: #000000;">。</span>如果一个异常没有被捕获，那么它可能会导致程序终止。如果能够留存任何日志，那么这是一个可以帮助我们调试为什么会发生异常<span style="color: #000000;">的好办法</span>，这样你就可以找到发生异常的根本原因并解决它。下面来说明我们如何建立一个默认的异常处理器来记录这些错误。</p>
<p><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html" class="external" rel="nofollow" target="_blank">Thread</a>类中有两个方法，我们可以用它来为未捕获的异常指定一个ExceptionHandler：</p>
<p><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#setDefaultUncaughtExceptionHandler%28java.lang.Thread.UncaughtExceptionHandler" class="external" rel="nofollow" target="_blank">setDefaultUncaughtExceptionHandler</a> 可以让你在任何线程上处理任何异常<span style="color: #000000;">。</span>setUncaughtExceptionHandler可以让你针对一个指定的线程设定一个不同的处理方法。而ThreadGroup则允许你设定一个处理方法。大部分人会使用默认的异常处理方法。</p>
<p>下面是一个示例，它设定了一个默认的异常处理方法，来创建一个日志事件。它要求你传入一个UncaughtExceptionHandler：</p>
<div><div id="highlighter_707412" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">java.util.logging.*;</code></div><div class="line number2 index1 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">ExceptionDemo {</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">Logger logger = Logger.getLogger(ExceptionDemo.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String[] args) {</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Thread.setDefaultUncaughtExceptionHandler(</code><code class="java keyword">new</code> <code class="java plain">Thread.UncaughtExceptionHandler() {</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">uncaughtException(Thread t, Throwable e) {</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">logger.log(Level.SEVERE, t + </code><code class="java string">" ExceptionDemo threw an exception: "</code><code class="java plain">, e);</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">};</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">});</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java keyword">class</code> <code class="java plain">adminThread </code><code class="java keyword">implements</code> <code class="java plain">Runnable {</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">run() {</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code> <code class="java keyword">new</code> <code class="java plain">RuntimeException();</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">Thread t = </code><code class="java keyword">new</code> <code class="java plain">Thread(</code><code class="java keyword">new</code> <code class="java plain">adminThread());</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">t.start();</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number18 index17 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>下面是一个未处理异常的输出示例：</p>
<div><div id="highlighter_673842" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell plain">May 29, 2015 2:21:15 PM ExceptionDemo$1 uncaughtException</code></div><div class="line number2 index1 alt1"><code class="shell plain">SEVERE: Thread[Thread-1,5,main] ExceptionDemo threw an exception:</code></div><div class="line number3 index2 alt2"><code class="shell plain">java.lang.RuntimeException</code></div><div class="line number4 index3 alt1"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at ExceptionDemo$1adminThread.run(ExceptionDemo.java:15)</code></div><div class="line number5 index4 alt2"><code class="shell spaces">&nbsp;&nbsp;</code><code class="shell plain">at java.lang.Thread.run(Thread.java:745)</code></div></div></td></tr></tbody></table></div></div>
</article>
<article id="json">
<header>
<h2>JSON</h2>
</header>
<p>JSON<span style="color: #000000;">（JavaScript Object Notation）</span>是一种用来存储结构化数据的格式，它将数据存储成键值对的集合，类似于HashMap或者Hashtable。JSON具有的可移植性和通用性，大部分现代语言都内置支持它或者通过已经准备好的第三方类库来支持它。</p>
<p>JSON支持许多基本数据类型，包括字符串、数字、布尔、数组和null。例如，你可以使用下面的JSON格式来表示一个电脑：</p>
<div><div id="highlighter_297681" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">{</code></div><div class="line number2 index1 alt1"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"manufacturer": "Dell",</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"model": "Inspiron",</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"hardware": {</code></div><div class="line number5 index4 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"cpu": "Intel Core i7",</code></div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"ram": 16384,</code></div><div class="line number7 index6 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">“cdrom”: null</code></div><div class="line number8 index7 alt1"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">},</code></div><div class="line number9 index8 alt2"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"peripherals": [</code></div><div class="line number10 index9 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">{</code></div><div class="line number11 index10 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"type": "monitor",</code></div><div class="line number12 index11 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"manufacturer": "Acer",</code></div><div class="line number13 index12 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">"model": "S231HL"</code></div><div class="line number14 index13 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number15 index14 alt2"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">]</code></div><div class="line number16 index15 alt1"><code class="text plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>JSON的可移植性使得它非常适合存储日志记录，使用JSON后，Java日志可以被任何数目的JSON解释器所读取。因为数据已经是结构化的，所以解析JSON日志要远比解析纯文本日志容易。</p>
<h3>Java中的JSON</h3>
<p>对于Java来说，有大量的JSON实现，其中一个是JSON.simple<span style="color: #000000;">。</span>JSON.simple是轻量级的、易于使用，并且全部符合JSON标准。</p>
<p>如果想将上面的computer对象转换成可用的Java对象，我们可以从文件中读取JSON内容，将其传递给JSON.simple，然后返回一个Object，接着我们可以将Object转换成JSONObject：</p>
<div><div id="highlighter_832884" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">Object computer = JSONValue.parse(</code><code class="java keyword">new</code> <code class="java plain">FileReader(</code><code class="java string">"computer.json"</code><code class="java plain">));</code></div><div class="line number2 index1 alt1"><code class="java plain">JSONObject computerJSON = (JSONObject)computer;</code></div></div></td></tr></tbody></table></div></div>
<p>另外，为了取得键值对的信息，你可以使用任何日志框架来记录一个JSONObject，JSONObject对象包含一个toString()方法， 它可以将JSON转换成文本：</p>
<div><div id="highlighter_494051" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">2015-05-06 14:54:32,878 INFO&nbsp; JSONTest main {"peripherals":[{"model":"S231HL","manufacturer":"Acer","type":"monitor"}],"model":"Inspiron","hardware":{"cdrom":null,"ram":16384,"cpu":"Intel Core i7"},"manufacturer":"Dell"}</code></div></div></td></tr></tbody></table></div></div>
<p>虽然这样做可以很容易的打印JSONObject，但如果你使用结构化的Layouts，例如JSONLayout或者XMLLayout，可能会导致意想不到的结果：</p>
<div><div id="highlighter_683048" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">...</code></div><div class="line number2 index1 alt1"><code class="text plain">"message" : "{"peripherals":[{"model":"S231HL","manufacturer":"Acer","type":"monitor"}],"model":"Inspiron","hardware":{"cdrom":null,"ram":16384,"cpu":"Intel Core i7"},"manufacturer":"Dell"}",</code></div><div class="line number3 index2 alt2"><code class="text plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>Log4j中的JSONLayout并<a href="http://stackoverflow.com/a/27111550" class="external" rel="nofollow" target="_blank">没有内置支持</a>内嵌JSON对象，但你可以通过创建自定义Layout的方式来<span style="color: #000000;">添加</span>一个JSONObject字段，这个Layout会继承或者替换JSONLayout<span style="color: #000000;">。</span>然而，如果你使用一个日志管理系统，需要记住许多日志管理系统会针对某些字段使用预定义的数据类型。如果你创建一个Layout并将JSONObject存储到message字段中，那么它可能会和日志系统中使用的String数据类型相冲突。一种解决办法是将JSON数据存储到一个字段中，然后将字符串类型的日志消息存储到另外一个字段中。</p>
<h3>其它JSON库</h3>
<p>除了JSON.simple，Java中还有很多<span style="color: #000000;">其它</span>JSON库。<a href="http://www.json.org/java/index.html" class="external" rel="nofollow" target="_blank">JSON-java</a>是由JSON创建者开发的一个参考实现，它包含了额外的一些功能，可以转换<span style="color: #000000;">其它</span>数据类型，包括web元素。但是目前JSON-java已经没有人来维护和提供支持了。</p>
<p>如果想将JSON对象转换成Java对象或者<span style="color: #000000;">逆向转换</span>，Google提供了一个Gson库<span style="color: #000000;">。</span>使用Gson时，可以很简单使用 toJson() 和 fromJson() 方法来解析JSON，这两个方法分别用来将Java对象转换成JSON字符串以及将JSON字符串转换成Java对象。Gson甚至可以应用在内存对象中，允许你映射到那些没有源代码的对象上。</p>
<h4>Jackson</h4>
<p><a href="https://github.com/FasterXML/jackson" class="external" rel="nofollow" target="_blank">Jackson</a>是一个强大的、流行的、功能丰富的库，它可以在Java中管理JSON对象。有一些框架甚至使用Jackson作为它们的JSONLayouts。尽管它很大并且复杂，但Jackson对于初学者和高级用户来说，是很容易使用的。</p>
<p>Logback通过logback-jackson和logback-json-classic库继承了Jackson，这两个库也是<a href="https://github.com/qos-ch/logback-contrib/wiki" class="external" rel="nofollow" target="_blank">logback-contrib</a>项目的一部分。在集成了Jackson后，你可以将日志以JSON的格式导出到任何Appender中。</p>
<p><a href="https://github.com/qos-ch/logback-extensions/wiki/Loggly" class="external" rel="nofollow" target="_blank">Logback Wiki</a>详细解释了如何将JSON添加到logback中，在Wiki页面中的示例使用了LogglyAppender，这里的配置也可以应用到其他Appender上。下面的示例说明了如何将JSON格式化的日志记录写入到名为myLog.json的文件中：</p>
<div><div id="highlighter_622835" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">...</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">appender</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"file"</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.core.FileAppender"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">file</code><code class="xml plain">&gt;myLog.json&lt;/</code><code class="xml keyword">file</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">encoder</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.core.encoder.LayoutWrappingEncoder"</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">layout</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.contrib.json.classic.JsonLayout"</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">jsonFormatter</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.contrib.jackson.JacksonJsonFormatter"</code><code class="xml plain">/&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">layout</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">encoder</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">appender</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;</code><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>你也可以通过<a href="http://wiki.fasterxml.com/JacksonInFiveMinutes" class="external" rel="nofollow" target="_blank">FasterXML Wiki</a>找到更多关于Jackson的深度介绍。</p>
<h3>了解更多JSON相关信息</h3>
<p>你可以通过<a href="http://www.json.org/" class="external" rel="nofollow" target="_blank">JSON主页</a>学习更多JSON相关信息，或者通过<a href="http://www.codecademy.com/courses/javascript-beginner-en-xTAfX/0/1" class="external" rel="nofollow" target="_blank">CodeAcademy</a>来通过学习一个交互式的快速上手教程（请注意这个课程是基于JavaScript的，而不是Java）<span style="color: #000000;">。</span>有一些在线工具例如<a href="http://jsonlint.com/" class="external" rel="nofollow" target="_blank">JSONLint</a>和<a href="https://www.jsoneditoronline.org/" class="external" rel="nofollow" target="_blank">JSON在线编辑器</a>可以帮助你解析、验证以及格式化JSON代码。</p>
</article>
<article id="ndc,-mdc,-and-threadcontext">
<header>
<h2>NDC<span style="color: #000000;">、</span>MDC以及ThreadContext</h2>
</header>
<p>当处理多线程应用程序，特别是web服务时，跟踪事件可能会变得困难。当针对多个同时存在的多个用户生成日志记录时，你如何区分哪个行为和哪个日志事件有关呢？如何两个用户没有成功打开一个相同的文件，或者在同一时间没有成功登陆，那么怎么处理日志记录？你可能需要一种方式来将日志记录和程序中的唯一标示符关联起来，这些标识符可能是用户ID，会话ID或者设备ID。而这就是NDC、MDC以及ThreadContext的用武之地。</p>
<p>NDC、MDC和ThreadContext通过向单独的日志记录中添加独一无二的数据戳，来创建日志足迹（log trails）。这些数据戳也被称为鱼标记（fish tagging），我们可以通过一个或者多个独一无二的值来区分日志。这些数据戳在每个线程级别上进行管理，并且一直持续到线程结束，或者直到数据戳被删掉。例如，如果你的Web应用程序为每个用户生成一个新的线程，那么你可以使用这个用户的ID来标记日志记录。当你想在一个复杂的系统中跟踪特定的请求、事务或者用户，这是一种非常有用的方法。</p>
<h3>嵌套诊断上下文（NDC）</h3>
<p>NDC或者嵌套诊断上下文（Nested Diagnostic Context）是基于栈的思想，信息可以被放到栈上或者从栈中移除。而栈中的值可以被Logger访问，并且Logger无需显示想日志方法中传入任何值。</p>
<p>下面的代码示例使用NDC和Log4j来将用户姓名和一条日志记录关联起来。NDC是一个静态类，因此我们可以直接访问它的方法，而无需实例化一个NDC对象。在这个示例中， NDC.oush(username) 和 NDC.push(sessionID) 方法在栈中存储了当前的用户名（admin）和会话ID（1234），而NDC.pop()方法将一些项从栈中移除，NDC.remove()方法让Java回收内存，以免造成内存溢出。</p>
<p><a href="http://www.importnew.com/?attachment_id=16336" rel="attachment wp-att-16336"><img class="aligncenter size-full wp-image-16336" title="image01" src="./Java日志终极指南 - ImportNew_files/a1f42cfeaf1a6dac0df29d971cc30533.png" alt=""></a></p>
<p>&nbsp;</p>
<div><div id="highlighter_800172" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">java.io.FileReader;</code></div><div class="line number2 index1 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.Log4j.Logger;</code></div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.Log4j.NDC;</code></div><div class="line number4 index3 alt1"><code class="java plain">...</code></div><div class="line number5 index4 alt2"><code class="java plain">String username = </code><code class="java string">"admin"</code><code class="java plain">;</code></div><div class="line number6 index5 alt1"><code class="java plain">String sessionID = </code><code class="java string">"1234"</code><code class="java plain">;</code></div><div class="line number7 index6 alt2"><code class="java plain">NDC.push(username);</code></div><div class="line number8 index7 alt1"><code class="java plain">NDC.push(sessionID);</code></div><div class="line number9 index8 alt2"><code class="java keyword">try</code> <code class="java plain">{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java comments">// tmpFile doesn't exist, causing an exception.</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">FileReader fr = </code><code class="java keyword">new</code> <code class="java plain">FileReader(</code><code class="java string">"tmpFile"</code><code class="java plain">);</code></div><div class="line number12 index11 alt1"><code class="java plain">}</code></div><div class="line number13 index12 alt2"><code class="java keyword">catch</code> <code class="java plain">(Exception ex) {</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">logger.error(</code><code class="java string">"Unable to open file."</code><code class="java plain">);</code></div><div class="line number15 index14 alt2"><code class="java plain">}</code></div><div class="line number16 index15 alt1"><code class="java keyword">finally</code> <code class="java plain">{</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">NDC.pop();</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">NDC.pop();</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">NDC.remove();</code></div><div class="line number20 index19 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Log4j的PatternLayout类通过%x转换字符从NDC中<span style="color: #000000;">提取</span>值<span style="color: #000000;">。</span>如果一个日志事件被触发，那么完整的NDC栈就被传到Log4j：</p>
<div><div id="highlighter_713272" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%x %-5p - %m%n"</code> <code class="xml plain">/&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>运行程序后，我们可以得出下面的输出：</p>
<div><div id="highlighter_87197" class="syntaxhighlighter notranslate shell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="shell string">"admin 1234 ERROR – Unable to open file."</code></div></div></td></tr></tbody></table></div></div>
<h3>映射诊断上下文（MDC）</h3>
<p>MDC或者映射诊断上下文和NDC很相似，不同之处在于MDC将值存储在键值对中，而不是栈中。这样你可以很容易的在Layout中引用一个单独的键。MDC.put(key,value) 方法将一个新的键值对添加到上下文中，而 MDC.remove(key) 方法会移除指定的键值对。</p>
<p>如果想在日志中同样显示用户名和会话ID，我们需要使用 MDC.put() 方法将这两个变量存储成键值对：</p>
<div><div id="highlighter_371602" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">java.io.FileReader;</code></div><div class="line number2 index1 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.Log4j.Logger;</code></div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.Log4j.MDC;</code></div><div class="line number4 index3 alt1"><code class="java plain">...</code></div><div class="line number5 index4 alt2"><code class="java plain">MDC.put(</code><code class="java string">"username"</code><code class="java plain">, </code><code class="java string">"admin"</code><code class="java plain">);</code></div><div class="line number6 index5 alt1"><code class="java plain">MDC.put(</code><code class="java string">"sessionID"</code><code class="java plain">, </code><code class="java string">"1234"</code><code class="java plain">);</code></div><div class="line number7 index6 alt2"><code class="java keyword">try</code> <code class="java plain">{</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java comments">// tmpFile doesn't exist, causing an exception.</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">FileReader fr = </code><code class="java keyword">new</code> <code class="java plain">FileReader(</code><code class="java string">"tmpFile"</code><code class="java plain">);</code></div><div class="line number10 index9 alt1"><code class="java plain">}</code></div><div class="line number11 index10 alt2"><code class="java keyword">catch</code> <code class="java plain">(Exception ex) {</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">logger.error(</code><code class="java string">"Unable to open file!"</code><code class="java plain">);</code></div><div class="line number13 index12 alt2"><code class="java plain">}</code></div><div class="line number14 index13 alt1"><code class="java keyword">finally</code> <code class="java plain">{</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">MDC.clear();</code></div><div class="line number16 index15 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>这里再一次强调，在不需要使用Context后，我们需要使用 MDC.clear() 方法将所有的键值对从MDC中移除，这样会降低内存的使用量，并阻止MDC在后面试图调用那些已经过期的数据。</p>
<p>在日志框架中访问MDC的值时，也稍微有些区别。对于存储在上下文中的任何键，我们可以使用%X(键)的方式来访问对应的值。这样，我们可以使用 %X(username) 和 %X(sessionID) 来获取对应的用户名和会话ID：</p>
<div><div id="highlighter_30617" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%X{username} %X{sessionID} %-5p - %m%n"</code> <code class="xml plain">/&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">"admin 1234 ERROR – Unable to open file!"</code></div></div></td></tr></tbody></table></div></div>
<p>如果我们没有指定任何键，那么MDC上下文就会被以 {(key, value),(key, value)} 的方式传递给Appender。</p>
<h4>Logback中的NDC和MDC</h4>
<p>和Log4j不同，Logback内置没有实现NDC。但是<a href="http://www.slf4j.org/extensions.html" class="external" rel="nofollow" target="_blank">slf4j-ext</a>包提供了一个NDC实现，它使用MDC作为基础。在Logback内部，你可以使用 MDC.put()<span style="color: #000000;">、</span>MDC.remove() 和 MDC.clear() 方法来访问和管理MDC：</p>
<div><div id="highlighter_266239" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">org.slf4j.MDC;</code></div><div class="line number2 index1 alt1"><code class="java plain">...</code></div><div class="line number3 index2 alt2"><code class="java plain">Logger logger = LoggerFactory.getLogger(MDCLogback.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number4 index3 alt1"><code class="java plain">...</code></div><div class="line number5 index4 alt2"><code class="java plain">MDC.put(</code><code class="java string">"username"</code><code class="java plain">, </code><code class="java string">"admin"</code><code class="java plain">);</code></div><div class="line number6 index5 alt1"><code class="java plain">MDC.put(</code><code class="java string">"sessionID"</code><code class="java plain">, </code><code class="java string">"1234"</code><code class="java plain">);</code></div><div class="line number7 index6 alt2"><code class="java keyword">try</code> <code class="java plain">{</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">FileReader fr = </code><code class="java keyword">new</code> <code class="java plain">FileReader(</code><code class="java string">"tmpFile"</code><code class="java plain">);</code></div><div class="line number9 index8 alt2"><code class="java plain">}</code></div><div class="line number10 index9 alt1"><code class="java keyword">catch</code> <code class="java plain">(Exception ex) {</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">logger.error(</code><code class="java string">"Unable to open file."</code><code class="java plain">);</code></div><div class="line number12 index11 alt1"><code class="java plain">}</code></div><div class="line number13 index12 alt2"><code class="java keyword">finally</code> <code class="java plain">{</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">MDC.clear();</code></div><div class="line number15 index14 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>在Logback中，你可以在Logback.xml中将如下模式应用到Appender上，它可以输出和上面Log4j相同的结果：</p>
<div><div id="highlighter_718462" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Pattern</code><code class="xml plain">&gt;[%X{username}] %X{sessionID} %-5p - %m%n&lt;/</code><code class="xml keyword">Pattern</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">"[admin] 1234 ERROR - Unable to open file."</code></div></div></td></tr></tbody></table></div></div>
<p>针对MDC的访问并不仅仅限制在PatternLayout上，例如，当使用JSONFormatter时，MDC中的所有值都会被导出：</p>
<div><div id="highlighter_548482" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">{</code></div><div class="line number2 index1 alt1"><code class="text plain">"timestamp":"1431970324945",</code></div><div class="line number3 index2 alt2"><code class="text plain">"level":"ERROR",</code></div><div class="line number4 index3 alt1"><code class="text plain">"thread":"main",</code></div><div class="line number5 index4 alt2"><code class="text plain">"mdc":{</code></div><div class="line number6 index5 alt1"><code class="text plain">"username":"admin",</code></div><div class="line number7 index6 alt2"><code class="text plain">"sessionID":"1234"</code></div><div class="line number8 index7 alt1"><code class="text plain">},</code></div><div class="line number9 index8 alt2"><code class="text plain">"logger":"MyClass",</code></div><div class="line number10 index9 alt1"><code class="text plain">"message":"Unable to open file.",</code></div><div class="line number11 index10 alt2"><code class="text plain">"context":"default"</code></div><div class="line number12 index11 alt1"><code class="text plain">}</code></div></div></td></tr></tbody></table></div></div>
<h3>ThreadContext</h3>
<p>Version 2 of Log4j merged MDC and NDC into a single concept known as the Thread Context. The Thread Context is an evolution of MDC and NDC, presenting them respectively as the Thread Context Map and Thread Context Stack. The Thread Context is managed through the static ThreadContext class, which is implemented similar to Log4j 1’s MDC and NDC classes.</p>
<p>Log4j版本2中将MDC和NDC合并到一个单独的组件中，这个组件被称为线程上下文。线程上下文是针对MDC和NDC的进化，它分别用线程上下文<span style="color: #000000;">Map映射</span>线程上下文栈来表示MDC和NDC。我们可以通过ThreadContext静态类来管理线程上下文，这个类在实现上类似于Log4j版本1中的MDC和NDC。</p>
<p>When using the Thread Context Stack, data is pushed to and popped from a stack just like with NDC:</p>
<p>当使用线程上下文栈时，我们可以向NDC那样向栈中添加或者删除数据：</p>
<div><div id="highlighter_781180" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.logging.Log4j.ThreadContext;</code></div><div class="line number2 index1 alt1"><code class="java plain">...</code></div><div class="line number3 index2 alt2"><code class="java plain">ThreadContext.push(username);</code></div><div class="line number4 index3 alt1"><code class="java plain">ThreadContext.push(sessionID);</code></div><div class="line number5 index4 alt2"><code class="java comments">// Logging methods go here</code></div><div class="line number6 index5 alt1"><code class="java plain">ThreadContext.pop();</code></div><div class="line number7 index6 alt2"><code class="java plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>当使用线程上下文<span style="color: #000000;">映射</span>时，我们可以像MDC那样将值和键结合在一起：</p>
<div><div id="highlighter_146251" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.logging.Log4j.ThreadContext;</code></div><div class="line number2 index1 alt1"><code class="java plain">...</code></div><div class="line number3 index2 alt2"><code class="java plain">ThreadContext.put(“username”,</code><code class="java string">"admin"</code><code class="java plain">);</code></div><div class="line number4 index3 alt1"><code class="java plain">ThreadContext.put(</code><code class="java string">"sessionID"</code><code class="java plain">, </code><code class="java string">"1234"</code><code class="java plain">);</code></div><div class="line number5 index4 alt2"><code class="java comments">// Logging methods go here</code></div><div class="line number6 index5 alt1"><code class="java plain">ThreadContext.clearMap();</code></div><div class="line number7 index6 alt2"><code class="java plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>ThreadContext类提供了一些方法，用于清除栈、清除MDC、清除存储在上下文中的所有值，对应的方法是ThreadContext.clearAll()<span style="color: #000000;">、</span>ThreadContext.clearMap()和ThreadContext.clearStack()。</p>
<p>和在MDC以及NDC中一样，我们可以使用Layouts在线程上下文中访问这些值。使用PatternLayout时，%x转换模式会从栈中获取值，%X和%X(键)会从图中获取值。</p>
<h4>ThreadContext过滤</h4>
<p>一些框架允许你基于某些属性对日志进行过滤<span style="color: #000000;">。</span>例如，Log4j的<a href="https://logging.apache.org/log4j/2.x/manual/filters.html#DynamicThresholdFilter" class="external" rel="nofollow" target="_blank">DynamicThresholdFilter</a> 会在键满足特定条件的情况下，自动调整日志级<span style="color: #000000;">别。再比如，</span>如果我们想要触发TRACE级别的日志消息，我们可以<span style="color: #000000;">创建</span>一个名为trace-logging-enabled的键，并向log4j配置文件中添加一个过滤器：</p>
<div><div id="highlighter_962968" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Configuration</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"MyApp"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">DynamicThresholdFilter</code> <code class="xml color1">key</code><code class="xml plain">=</code><code class="xml string">"trace-logging-enabled"</code> <code class="xml color1">onMatch</code><code class="xml plain">=</code><code class="xml string">"ACCEPT"</code> <code class="xml color1">onMismatch</code><code class="xml plain">=</code><code class="xml string">"NEUTRAL"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">KeyValuePair</code> <code class="xml color1">key</code><code class="xml plain">=</code><code class="xml string">"true"</code> <code class="xml color1">value</code><code class="xml plain">=</code><code class="xml string">"TRACE"</code> <code class="xml plain">/&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">DynamicThresholdFilter</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>如果ThreadContext包含一个名为trace-logging-enabled的键，onMatch 和 onMismatch 会决定如何处理它。关于 onMatch 和 onMismatch，我们有三个可选项：ACCEPT，它会处理过滤器的规则；DENY，它会忽略过滤器的规则；NEUTRAL，它会推迟到下一个过滤器。除了这些，我们还定义一个键值对，当值为true时，我们启用TRACE级别的日志。</p>
<p>现在，当trace-logging-enabled被设置成true时，即使根Logger设置的日志级别高于TRACE，Appender也会记录TRACE级别的消息。</p>
<p>你可能还想过滤一些特定的日志到特定的Appender中，Log4j中提供了ThreadContextMapFilter来实现这一点。如果我们想要限制某个特定的Appender<span style="color: #000000;">，</span>只记录针对某个用户的TRACE级别的消息，我们可以基于username键添加一个ThreadContextMapFilter：</p>
<div><div id="highlighter_576270" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Console</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"ConsoleAppender"</code> <code class="xml color1">target</code><code class="xml plain">=</code><code class="xml string">"SYSTEM_OUT"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">ThreadContextMapFilter</code> <code class="xml color1">onMatch</code><code class="xml plain">=</code><code class="xml string">"ACCEPT"</code> <code class="xml color1">onMismatch</code><code class="xml plain">=</code><code class="xml string">"DENY"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">KeyValuePair</code> <code class="xml color1">key</code><code class="xml plain">=</code><code class="xml string">"username"</code> <code class="xml color1">value</code><code class="xml plain">=</code><code class="xml string">"admin"</code> <code class="xml plain">/&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">ThreadContextMapFilter</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>如果想了解更多信息，你可以查看<a href="http://logging.apache.org/log4j/2.x/manual/filters.html#DynamicThresholdFilter" class="external" rel="nofollow" target="_blank">Log4j</a>和<a href="http://logback.qos.ch/apidocs/ch/qos/logback/classic/turbo/DynamicThresholdFilter.html" class="external" rel="nofollow" target="_blank">Logback</a>文档中关于DynamicThresholdFilter部分。</p>
</article>
<article id="markers">
<header>
<h2>Markers</h2>
<p>Markers允许你对单独的日志记录添加一些独一无二的数据<span style="color: #000000;">。</span>它可以用来对日志记录进行分组，触发一些行为<span style="color: #ff0000;"><span style="color: #000000;">，</span></span>或者对日志记录进行过滤<span style="color: #000000;">，</span>并将过滤结果输出到指定的Appender中。你甚至可以将Markers和ThreadContext结合在一起使用，以提高搜索和过滤日志数据的能力。</p>
</header>
<p>例如，假设我们有一个可以连接到数据库的类，如果在打开数据库的时候发生了异常，我们需要把异常记录成fatal错误。我们可以创建一个名为DB_ERROR的Marker，然后将其应用到日志事件中：</p>
<div><div id="highlighter_294559" class="syntaxhighlighter notranslate java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.logging.Log4j.Marker;</code></div><div class="line number2 index1 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.logging.Log4j.MarkerManager;</code></div><div class="line number3 index2 alt2"><code class="java plain">...</code></div><div class="line number4 index3 alt1"><code class="java keyword">final</code> <code class="java keyword">static</code> <code class="java plain">Marker DB_ERROR = MarkerManager.getMarker(</code><code class="java string">"DATABASE_ERROR"</code><code class="java plain">);</code></div><div class="line number5 index4 alt2"><code class="java plain">...</code></div><div class="line number6 index5 alt1"><code class="java plain">logger.fatal(DB_ERROR, </code><code class="java string">"An exception occurred."</code><code class="java plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>为了在日志输出中显示Marker信息，我们需要在PatternLayout中添加%marker转换模式：</p>
<div><div id="highlighter_367769" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">PatternLayout</code> <code class="xml color1">pattern</code><code class="xml plain">=</code><code class="xml string">"%p %marker: %m%n"</code> <code class="xml plain">/&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">[FATAL] DATABASE_ERROR: An exception occurred.</code></div></div></td></tr></tbody></table></div></div>
<p>或者对于JSON和XML格式的Layouts，会自动在输出中包含Marker信息：</p>
<div><div id="highlighter_602379" class="syntaxhighlighter notranslate text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">...</code></div><div class="line number2 index1 alt1"><code class="text plain">"thread" : "main",</code></div><div class="line number3 index2 alt2"><code class="text plain">"level" : "FATAL",</code></div><div class="line number4 index3 alt1"><code class="text plain">"loggerName" : "DBClass",</code></div><div class="line number5 index4 alt2"><code class="text plain">"marker" : {</code></div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;</code><code class="text plain">"name" : "DATABASE_ERROR"</code></div><div class="line number7 index6 alt2"><code class="text plain">},</code></div><div class="line number8 index7 alt1"><code class="text plain">"message" : "An exception occurred.",</code></div><div class="line number9 index8 alt2"><code class="text plain">...</code></div></div></td></tr></tbody></table></div></div>
<p>通过对Marker数据进行自动解析和排序，集中式的日志服务可以很容易对日志进行搜索处理。</p>
<h3>Markers过滤</h3>
<p>Marker过滤器可以让你决定哪些Marker由哪些Logger来处理。marker字段会比较在日志事件里面的Marker名字，如果名字匹配，那么Logger会执行后续的行为。例如，在<a href="https://logging.apache.org/log4j/2.x/manual/filters.html#MarkerFilter" class="external" rel="nofollow" target="_blank">Log4j</a>中，我们可以配置一个Appender来只显示哪些使用了DB_ERROR Marker的消息，这可以通过log4j2.xml中的Appender添加如下信息来实现：</p>
<div><div id="highlighter_118419" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">MarkerFilter</code> <code class="xml color1">marker</code><code class="xml plain">=</code><code class="xml string">"DATABASE_ERROR"</code> <code class="xml color1">onMatch</code><code class="xml plain">=</code><code class="xml string">"ACCEPT"</code> <code class="xml color1">onMismatch</code><code class="xml plain">=</code><code class="xml string">"DENY"</code> <code class="xml plain">/&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>如果日志记录中某一条的Marker可以匹配这里的marker字段，那么onMatch会决定如何处理这条记录。如果不能够匹配，或者日志记录中没有Marker信息，那么onMismatch就会决定如何处理这条记录。对于onMatch和onMismatch来说，有3个可选项：ACCEPT，它允许记录事件；DENY，它会阻塞事件；NEUTRAL，它不会对事件进行任何处理。</p>
<p>在Logback中，我们需要更多一些设置。首先，想Appender中添加一个新的EvaluatorFilter，并如上所述指定onMatch和onMismatch行为<span style="color: #000000;">。</span>然后，添加一个OnMarkerEvaluator并将Marker的名字传递给它：</p>
<div><div id="highlighter_680058" class="syntaxhighlighter notranslate xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">filter</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.core.filter.EvaluatorFilter"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">evaluator</code> <code class="xml color1">class</code><code class="xml plain">=</code><code class="xml string">"ch.qos.Logback.classic.boolex.OnMarkerEvaluator"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">marker</code><code class="xml plain">&gt;DATABASE_ERROR&lt;/</code><code class="xml keyword">marker</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">evaluator</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">onMatch</code><code class="xml plain">&gt;ACCEPT&lt;/</code><code class="xml keyword">onMatch</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">onMismatch</code><code class="xml plain">&gt;DENY&lt;/</code><code class="xml keyword">onMismatch</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">filter</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<h3>将Markers和NDC<span style="color: #000000;">、</span>MDC以及ThreadContext结合使用</h3>
<p>Marker的功能和ThreadContext类似，它们都是向日志记录中添加独一无二的数据，这些数据可以被Appender访问。如果把这两者结合使用，可以让你更容易的对日志数据进行索引和搜索。如果能够知道何时使用哪一种技术，会对我们有所帮助。</p>
<p>NDC<span style="color: #000000;">、</span>MDC和ThreadContext被用于将相关日志记录结合在一起。如果你的应用程序会处理多个同时存在的用户，ThreadContext可以让你将针对某个特定用户的一组日志记录组合在一起。因为ThreadContext针对每个线程都是不一样的，所以你可以使用同样的方法来对相关的日志记录进行自动分组。</p>
<p>另一方面，Marker通常用于标记或者高亮显示某些特殊事件。在上述示例中，我们使用DB_ERROR Marker来标明在方法中发生的SQL相关异常。我们可以使用DB_ERROR Marker来将这些事件的处理过程和其他事件区分开来，例如我们可以使用SMTP Appender来将这些事件通过邮件发送给数据库管理员。</p>
</article>
<article id="additional-resources">
<header>
<h2>额外资源</h2>
</header>
<h3>指南和教程</h3>
<ul>
<li><a href="http://tutorials.jenkov.com/java-logging/index.html" class="external" rel="nofollow" target="_blank">Java Logging</a>（Jakob Jenkov）——使用Java Logging API进行日志开发教程</li>
<li><a href="http://docs.oracle.com/javase/8/docs/technotes/guides/logging/overview.html" class="external" rel="nofollow" target="_blank">Java Logging Overview</a>（Oracle）—— Oracle提供的在Java中进行日志开发的指南</li>
<li><a href="http://www.tutorialspoint.com/log4j/index.htm" class="external" rel="nofollow" target="_blank">Log4J Tutorial</a>（Tutorials Point）——使用log4j 版本1进行日志开发的指南</li>
</ul>
<h3>日志抽象层</h3>
<ul>
<li><a href="http://commons.apache.org/proper/commons-logging/" class="external" rel="nofollow" target="_blank">Apache Commons Logging</a>（Apache）——针对Log4j<span style="color: #888888;">、</span>Avalon LogKit和java.util.logging的抽象层</li>
<li><a href="http://www.slf4j.org/" class="external" rel="nofollow" target="_blank">SLF4J</a>（QOS.ch）——一个流程的抽象层，应用在多个日志框架上，包括Log4j<span style="color: #888888;">、</span>Logback以及java.util.logging</li>
</ul>
<h3>日志框架</h3>
<ul>
<li><a href="http://docs.oracle.com/javase/8/docs/technotes/guides/logging/" class="external" rel="nofollow" target="_blank">Java Logging API</a>（Oracle）—— Java默认的日志框架</li>
<li><a href="http://logging.apache.org/log4j/2.x/" class="external" rel="nofollow" target="_blank">Log4j</a>（Apache）——开源日志框架</li>
<li><a href="http://logback.qos.ch/" class="external" rel="nofollow" target="_blank">Logback</a>（Logback Project）——开源项目，被设计成Log4j版本1的后续版本</li>
<li><a href="http://www.tinylog.org/" class="external" rel="nofollow" target="_blank">tinylog</a><span style="color: #000000;">（tinylog）——</span>轻量级开源logger</li>
</ul>
<p>&nbsp;</p>
</article>

        
        原文链接： <a target="_blank" href="http://www.loggly.com/ultimate-guide/logging/java-logging-basics/" class="external" rel="nofollow">loggly</a>    翻译： <a href="http://www.importnew.com/"> ImportNew.com </a> - <a href="http://www.importnew.com/author/wing011203">Wing</a><br>译文链接： <a href="http://www.importnew.com/16331.html">http://www.importnew.com/16331.html</a><br>[ <span style="color:#ff0000"><b>转载请保留原文出处、译者和译文链接。</b></span>]<br><br>
        <!-- BEGIN #author-bio -->

<div id="author-bio">
	
	<h3 class="widget-title">
	关于作者： <a href="http://www.importnew.com/author/wing011203">Wing</a>
	</h3>
	<div class="alignleft">
		<a href="http://www.importnew.com/author/wing011203">
					</a>
	</div>
	<p>（新浪微博：<strong><a href="http://weibo.com/u/5515504489" class="external" rel="nofollow" target="_blank">@Wing011203</a></strong>）</p>
	<p>
		<a style="text-decoration: none;" href="http://www.importnew.com/author/wing011203">查看Wing的更多文章 &gt;&gt; </a>
	</p>
	<div class="clear"></div>
	
</div>

<!-- END #author-bio -->
	</div>
	<!-- END .entry -->


<!-- JiaThis Button BEGIN -->
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina" title="分享到微博"><span class="jiathis_txt jtico jtico_tsina"></span></a>
<a class="jiathis_button_weixin" title="分享到微信"><span class="jiathis_txt jtico jtico_weixin"></span></a>
<a class="jiathis_button_qzone" title="分享到QQ空间"><span class="jiathis_txt jtico jtico_qzone"></span></a>
<a class="jiathis_button_fb" title="分享到Facebook"><span class="jiathis_txt jtico jtico_fb"></span></a>
<a class="jiathis_button_renren" title="分享到人人网"><span class="jiathis_txt jtico jtico_renren"></span></a>
<a class="jiathis_button_douban" title="分享到豆瓣"><span class="jiathis_txt jtico jtico_douban"></span></a>
<a class="jiathis_button_googleplus" title="分享到Google+"><span class="jiathis_txt jtico jtico_googleplus"></span></a>
<a class="jiathis_button_readitlater"></a>
<a class="jiathis_button_evernote" title="分享到印象笔记"><span class="jiathis_txt jtico jtico_evernote"></span></a>
<a class="jiathis_button_ydnote" title="分享到有道云笔记"><span class="jiathis_txt jtico jtico_ydnote"></span></a>
<a href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis external" target="_blank" rel="nofollow"></a>
<a class="jiathis_counter_style"><span class="jiathis_button_expanded jiathis_counter jiathis_bubble_style" id="jiathis_counter_108" title="累计分享48次">48</span></a>
</div>


<script type="text/javascript">
var jiathis_config={
	data_track_clickback:false,
	title:"《Java日志终极指南》",
	summary:"这篇教程从日志基础开始，涵盖了Java日志组件、配置、关键类介绍等。",
	pic:"http://incdn1.b0.upaiyun.com/2015/07/f5aad4cacde983e6884fa3abf2df701e.png",
	appkey:{
                "tsina":2284713194 //for importnew
        },
	ralateuid:{
		"tsina":2991905905 //for importnew
	},
	hideMore:false
}
</script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/jia.js.下载" charset="utf-8"></script><script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/plugin.client.js.下载" charset="utf-8"></script>
<!-- JiaThis Button END -->
<br><br>
<div id="text-13">			<div class="textwidget"><p><a href="http://blog.jobbole.com/106093/" target="_blank" class="external" rel="nofollow"><img src="./Java日志终极指南 - ImportNew_files/bfdcef89gw1f9cf7iwi24j20h802sjrz.jpg"></a></p>
</div>
		</div>
</div>
<!-- END .post -->	
	
<script type="text/javascript">
window._wp_rp_static_base_url = "http://dtmvdvtzf8rz0.cloudfront.net/static/";

</script>
<h3 class="related_post_title">相关文章</h3><ul class="related_post wp_rp" style="visibility:visible;"><li position="0"><a href="http://www.importnew.com/22360.html">关于日志记录的一些感想</a></li><li position="1"><a href="http://www.importnew.com/22290.html">从零开始玩转logback</a></li><li position="2"><a href="http://www.importnew.com/21690.html">日志打印的5点建议</a></li><li position="3"><a href="http://www.importnew.com/21093.html">Logstash实践: 分布式系统的日志监控</a></li><li position="4"><a href="http://www.importnew.com/19448.html">简化SLF4J和通用日志工具的区别 </a></li><li position="5"><a href="http://www.importnew.com/17315.html">Java日志记录的5条规则</a></li><li position="6"><a href="http://www.importnew.com/15722.html">在运行时开启GC日志</a></li><li position="7"><a href="http://www.importnew.com/3046.html">Log4j 2 介绍</a></li><li position="8"><a href="http://www.importnew.com/518.html">记录异常日志的7条规则</a></li><li position="9"><a href="http://www.importnew.com/22890.html">Quartz 入门详解</a></li></ul>

			
	
<!-- BEGIN #respond -->
<div id="respond">

	<h3 class="widget-title">发表评论</h3>
	
	<!-- BEGIN .cancel-comment-reply -->
	<p class="cancel-comment-reply">
		
		<a rel="nofollow" id="cancel-comment-reply-link" href="http://www.importnew.com/16331.html#respond" style="display:none;">点击这里取消回复。</a>		
	</p>
	<!-- END .cancel-comment-reply -->

		
	<!-- BEGIN #comment-form -->
	<form action="http://www.importnew.com/wp-comments-post.php" method="post" id="comment-form">
		
		<fieldset>
		
			<legend class="none">Comment form</legend>
			
			<!-- BEGIN .container -->
			<div class="container">
			
							
				<div class="grid-4 margin-20">
					<label for="author">Name<span class="red">*</span></label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="text" name="author" id="author" value="" tabindex="1" size="30" class="required" placeholder="姓名"></div>
				</div>
				<div class="clear"></div>
				
				<div class="grid-4 margin-20">
					<label for="email">邮箱<span class="red">*</span></label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="email" name="email" id="email" value="" tabindex="2" size="30" class="required email" placeholder="请填写邮箱"></div>
				</div>
				<div class="clear"></div>
				
				<div class="grid-4 margin-20">
					<label for="url">网站 (请以 http://开头)</label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="url" name="url" id="url" value="" tabindex="3" size="30" placeholder="请填写网站地址"></div>
				</div>
				<div class="clear"></div>
				
								
				<div class="grid-8 margin-20">
					<label for="comment" class="none margin-20">评论内容<span class="red">*</span></label>
					<div class="input-wrapper"><textarea name="comment" id="comment" rows="20" cols="30" class="required" tabindex="4" onkeydown="if(event.ctrlKey &amp;&amp; event.keyCode==13){document.getElementById(&#39;comment-form-submit&#39;).click(); return false;}" placeholder="请填写评论内容"></textarea></div>
				</div>
				<div class="clear"></div>
				
			</div>
			<!-- END .container -->
			
			<p>(<span class="red">*</span>) 表示必填项</p>
			<p></p><div class="submit-wrapper"><a id="comment-form-submit" class="submit">提交评论</a></div><p></p>
			<input type="hidden" name="comment_post_ID" value="16331" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
			<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="54e0a0b0f9"></p>			
		</fieldset>
		
	</form>
	<!-- END #comment-form -->
	
	
</div>
<!-- END #respond -->


			<p class="nocomments none">还没有评论。</p>
	 



		
				
	<!-- BEGIN .navigation -->
	<div class="navigation margin-20">
	
		<div class="alignleft"><a href="http://www.importnew.com/16342.html" rel="prev">« 企业级 Java 应用最重要的4个性能指标</a></div>
		<div class="alignright"><a href="http://www.importnew.com/16346.html" rel="next">写Java也得了解CPU–CPU缓存 »</a></div>
		<div class="clear"></div>

	</div>
	<!-- END .navigation -->
	
		
</div>
<!-- END .grid-8 -->

<!-- BEGIN #sidebar -->
<div id="sidebar" class="grid-4">

	<div id="search-3" class="widget widget_search"><!-- BEGIN #searchform -->
<form method="get" id="searchform" action="http://www.importnew.com/">

	<label class="none" for="s">Search for:</label>
	<div class="input-wrapper"><input type="text" value="" name="s" id="s" placeholder="Search"></div>
	<input type="submit" id="searchsubmit" value="Search">
	
</form>
<!-- END #searchform --></div><div id="text-14" class="widget widget_text">			<div class="textwidget"><p><a href="http://blog.jobbole.com/84342/?utm_source=www.importnew.com&amp;utm_medium=rightBanner-1&amp;utm_content=2015.9.16" target="_blank" class="external" rel="nofollow"><img src="./Java日志终极指南 - ImportNew_files/e5298966gw1evyjrd4iqcj208c03c0t0.jpg"></a></p>
</div>
		</div><div id="aw_tabbed_widget-2" class="widget aw_tabbed_widget"><div class="tabs"><ul class="nav clearfix"><li class="active"><a id="link-most-discussed" href="http://www.importnew.com/16331.html#tab-most-discussed" title="本周热门文章">本周热门文章</a></li><li><a id="link-latest-comments" href="http://www.importnew.com/16331.html#tab-latest-comments" title="本月热门">本月热门</a></li><li><a id="link-tags" href="http://www.importnew.com/16331.html#tab-tags" title="热门标签">热门标签</a></li></ul><div id="tab-most-discussed" class="tab" style="display: block;"><div class="floated-thumb">							
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">0</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25180.html" title="【译】Reddit如何统计每个帖子的浏览量">【译】Reddit如何统计每个帖子的浏...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">1</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25223.html" title="深入 JVM 分析 spring-boot 应用 hibernate-validator NoClassDefFoundError">深入 JVM 分析 spring-boot 应用 hibernate-val...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">2</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25295.html" title="JVM 类加载机制详解">JVM 类加载机制详解</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">3</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25189.html" title="谈谈对Canal（ 增量数据订阅与消费 ）的理解 ">谈谈对Canal（ 增量数据订阅与消费...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">4</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25228.html" title="Kafka 端到端审计">Kafka 端到端审计</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">5</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25242.html" title="为什么 QueueingConsumer 会被 Deprecated ?">为什么 QueueingConsumer 会被 Depr...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">6</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25247.html" title="kafka 数据可靠性深度解读">kafka 数据可靠性深度解读</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">7</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25271.html" title="八幅漫画理解使用 JSON Web Token 设计单点登录系统">八幅漫画理解使用 JSON Web To...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">8</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25286.html" title="深入学习 FutureTask">深入学习 FutureTask</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">9</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25302.html" title="如何实现一个Java Class 解析器">如何实现一个Java Class 解析器</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
						</div></div><div id="tab-latest-comments" class="tab" style="display: none;"><div class="floated-thumb">							
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">0</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25023.html" title="图解集合 2 ：LinkedList">图解集合 2 ：LinkedList</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">1</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25008.html" title="图解集合 1 ：ArrayList">图解集合 1 ：ArrayList</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">2</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24875.html" title="Spring Boot 启动流程详解（一）">Spring Boot 启动流程详解（一）</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">3</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24896.html" title="java 调试技能之 dubbo 调试 -- telnet">java 调试技能之 dubbo 调试 -- t...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">4</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24930.html" title="图解集合7：红黑树概念、红黑树的插入及旋转操作详细解读 ">图解集合7：红黑树概念、红黑树的插...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">5</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/25034.html" title="图解集合 3 : CopyOnWriteArrayList">图解集合 3 : CopyOnWriteArray...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">6</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24804.html" title="怎样写一个 RefererFilter ">怎样写一个 RefererFilter </a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">7</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24851.html" title="Spring Boot异常处理详解">Spring Boot异常处理详解</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">8</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24789.html" title="Java语法糖 2 ：自动装箱和自动拆箱">Java语法糖 2 ：自动装箱和自动拆箱</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta  no-thumb">
							
								<p>
								    <span class="numb">9</span>
								    <a class="meta-title" target="_blank" href="http://www.importnew.com/24822.html" title="HashMap 和 HashTable 到底哪不同 ？">HashMap 和 HashTable 到底哪...</a><br>
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
						</div></div><div id="tab-tags" class="tab" style="display: none;"><p><a href="http://www.importnew.com/tag/android23days" class="tag-link-240" title="8 个话题" style="font-size: 8.5645161290323px;">android23days</a>
<a href="http://www.importnew.com/tag/android" class="tag-link-36" title="66 个话题" style="font-size: 18.5px;">Android开发</a>
<a href="http://www.importnew.com/tag/aop" class="tag-link-204" title="18 个话题" style="font-size: 12.290322580645px;">AOP</a>
<a href="http://www.importnew.com/tag/arraylist" class="tag-link-314" title="7 个话题" style="font-size: 8px;">ArrayList</a>
<a href="http://www.importnew.com/tag/concurrenthashmap" class="tag-link-355" title="13 个话题" style="font-size: 10.822580645161px;">ConcurrentHashMap</a>
<a href="http://www.importnew.com/tag/eclipse" class="tag-link-81" title="30 个话题" style="font-size: 14.661290322581px;">Eclipse</a>
<a href="http://www.importnew.com/tag/gc" class="tag-link-87" title="39 个话题" style="font-size: 15.903225806452px;">GC</a>
<a href="http://www.importnew.com/tag/gson" class="tag-link-643" title="7 个话题" style="font-size: 8px;">Gson</a>
<a href="http://www.importnew.com/tag/guava" class="tag-link-554" title="11 个话题" style="font-size: 10.032258064516px;">Guava</a>
<a href="http://www.importnew.com/tag/hadoop" class="tag-link-140" title="13 个话题" style="font-size: 10.822580645161px;">Hadoop</a>
<a href="http://www.importnew.com/tag/hashmap" class="tag-link-284" title="30 个话题" style="font-size: 14.661290322581px;">HashMap</a>
<a href="http://www.importnew.com/tag/hashset" class="tag-link-60" title="9 个话题" style="font-size: 9.1290322580645px;">HashSet</a>
<a href="http://www.importnew.com/tag/hbase" class="tag-link-128" title="14 个话题" style="font-size: 11.161290322581px;">HBase</a>
<a href="http://www.importnew.com/tag/hibernate" class="tag-link-109" title="14 个话题" style="font-size: 11.161290322581px;">Hibernate</a>
<a href="http://www.importnew.com/tag/intellij" class="tag-link-213" title="8 个话题" style="font-size: 8.5645161290323px;">IntelliJ</a>
<a href="http://www.importnew.com/tag/io" class="tag-link-70" title="13 个话题" style="font-size: 10.822580645161px;">io</a>
<a href="http://www.importnew.com/tag/java" class="tag-link-35" title="127 个话题" style="font-size: 21.661290322581px;">Java</a>
<a href="http://www.importnew.com/tag/java8" class="tag-link-354" title="33 个话题" style="font-size: 15.112903225806px;">java8</a>
<a href="http://www.importnew.com/tag/java-8" class="tag-link-50" title="32 个话题" style="font-size: 15px;">java 8</a>
<a href="http://www.importnew.com/tag/java9" class="tag-link-436" title="9 个话题" style="font-size: 9.1290322580645px;">Java9</a>
<a href="http://www.importnew.com/tag/javaee" class="tag-link-379" title="7 个话题" style="font-size: 8px;">javaee</a>
<a href="http://www.importnew.com/tag/javaee%e4%b8%8emaven%e6%95%99%e7%a8%8b" class="tag-link-462" title="7 个话题" style="font-size: 8px;">JavaEE与Maven教程</a>
<a href="http://www.importnew.com/tag/java-nio" class="tag-link-750" title="13 个话题" style="font-size: 10.822580645161px;">Java NIO</a>
<a href="http://www.importnew.com/tag/java%e4%b9%b1%e7%a0%81" class="tag-link-807" title="8 个话题" style="font-size: 8.5645161290323px;">Java乱码</a>
<a href="http://www.importnew.com/tag/java%e7%bc%96%e7%a8%8b%e5%85%a5%e9%97%a8" class="tag-link-639" title="24 个话题" style="font-size: 13.645161290323px;">Java编程入门</a>
<a href="http://www.importnew.com/tag/java%e8%99%9a%e6%8b%9f%e6%9c%ba" class="tag-link-671" title="7 个话题" style="font-size: 8px;">java虚拟机</a>
<a href="http://www.importnew.com/tag/jdbc" class="tag-link-122" title="16 个话题" style="font-size: 11.725806451613px;">JDBC</a>
<a href="http://www.importnew.com/tag/jdk" class="tag-link-44" title="12 个话题" style="font-size: 10.370967741935px;">JDK</a>
<a href="http://www.importnew.com/tag/jpa" class="tag-link-161" title="8 个话题" style="font-size: 8.5645161290323px;">JPA</a>
<a href="http://www.importnew.com/tag/jsoup" class="tag-link-703" title="9 个话题" style="font-size: 9.1290322580645px;">Jsoup</a>
<a href="http://www.importnew.com/tag/junit" class="tag-link-337" title="8 个话题" style="font-size: 8.5645161290323px;">JUnit</a>
<a href="http://www.importnew.com/tag/jvm" class="tag-link-80" title="133 个话题" style="font-size: 21.887096774194px;">JVM</a>
<a href="http://www.importnew.com/tag/lambda" class="tag-link-92" title="9 个话题" style="font-size: 9.1290322580645px;">Lambda</a>
<a href="http://www.importnew.com/tag/linkedhashmap" class="tag-link-306" title="7 个话题" style="font-size: 8px;">LinkedHashMap</a>
<a href="http://www.importnew.com/tag/log4j" class="tag-link-117" title="7 个话题" style="font-size: 8px;">log4j</a>
<a href="http://www.importnew.com/tag/mapreduce" class="tag-link-106" title="7 个话题" style="font-size: 8px;">MapReduce</a>
<a href="http://www.importnew.com/tag/maven" class="tag-link-385" title="16 个话题" style="font-size: 11.725806451613px;">maven</a>
<a href="http://www.importnew.com/tag/mybatis" class="tag-link-820" title="25 个话题" style="font-size: 13.758064516129px;">Mybatis</a>
<a href="http://www.importnew.com/tag/netty" class="tag-link-130" title="19 个话题" style="font-size: 12.516129032258px;">Netty</a>
<a href="http://www.importnew.com/tag/nio" class="tag-link-69" title="18 个话题" style="font-size: 12.290322580645px;">nio</a>
<a href="http://www.importnew.com/tag/oracle" class="tag-link-153" title="9 个话题" style="font-size: 9.1290322580645px;">oracle</a>
<a href="http://www.importnew.com/tag/orm" class="tag-link-451" title="10 个话题" style="font-size: 9.5806451612903px;">ORM</a>
<a href="http://www.importnew.com/tag/redis" class="tag-link-772" title="10 个话题" style="font-size: 9.5806451612903px;">redis</a>
<a href="http://www.importnew.com/tag/restful" class="tag-link-196" title="12 个话题" style="font-size: 10.370967741935px;">RESTful</a>
<a href="http://www.importnew.com/tag/scala" class="tag-link-89" title="18 个话题" style="font-size: 12.290322580645px;">Scala</a>
<a href="http://www.importnew.com/tag/servlet" class="tag-link-320" title="9 个话题" style="font-size: 9.1290322580645px;">Servlet</a>
<a href="http://www.importnew.com/tag/socket" class="tag-link-559" title="11 个话题" style="font-size: 10.032258064516px;">Socket</a>
<a href="http://www.importnew.com/tag/solr" class="tag-link-429" title="10 个话题" style="font-size: 9.5806451612903px;">solr</a>
<a href="http://www.importnew.com/tag/spring" class="tag-link-53" title="137 个话题" style="font-size: 22px;">Spring</a>
<a href="http://www.importnew.com/tag/spring4" class="tag-link-771" title="8 个话题" style="font-size: 8.5645161290323px;">Spring4</a>
<a href="http://www.importnew.com/tag/spring-boot" class="tag-link-779" title="8 个话题" style="font-size: 8.5645161290323px;">spring boot</a>
<a href="http://www.importnew.com/tag/springmvc" class="tag-link-614" title="20 个话题" style="font-size: 12.741935483871px;">SpringMVC</a>
<a href="http://www.importnew.com/tag/spring-mvc" class="tag-link-443" title="13 个话题" style="font-size: 10.822580645161px;">Spring MVC</a>
<a href="http://www.importnew.com/tag/string" class="tag-link-252" title="33 个话题" style="font-size: 15.112903225806px;">String</a>
<a href="http://www.importnew.com/tag/synchronized" class="tag-link-737" title="8 个话题" style="font-size: 8.5645161290323px;">synchronized</a>
<a href="http://www.importnew.com/tag/threadlocal" class="tag-link-376" title="12 个话题" style="font-size: 10.370967741935px;">ThreadLocal</a>
<a href="http://www.importnew.com/tag/tomcat" class="tag-link-225" title="21 个话题" style="font-size: 12.967741935484px;">Tomcat</a>
<a href="http://www.importnew.com/tag/volatile" class="tag-link-433" title="10 个话题" style="font-size: 9.5806451612903px;">volatile</a>
<a href="http://www.importnew.com/tag/web-service" class="tag-link-103" title="7 个话题" style="font-size: 8px;">Web Service</a>
<a href="http://www.importnew.com/tag/zookeeper" class="tag-link-828" title="10 个话题" style="font-size: 9.5806451612903px;">Zookeeper</a>
<a href="http://www.importnew.com/tag/%e4%ba%8b%e5%8a%a1" class="tag-link-339" title="9 个话题" style="font-size: 9.1290322580645px;">事务</a>
<a href="http://www.importnew.com/tag/%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86" class="tag-link-273" title="18 个话题" style="font-size: 12.290322580645px;">内存管理</a>
<a href="http://www.importnew.com/tag/%e5%88%86%e5%b8%83%e5%bc%8f" class="tag-link-598" title="9 个话题" style="font-size: 9.1290322580645px;">分布式</a>
<a href="http://www.importnew.com/tag/%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86" class="tag-link-644" title="7 个话题" style="font-size: 8px;">动态代理</a>
<a href="http://www.importnew.com/tag/%e5%8f%82%e6%95%b0%e5%a4%aa%e5%a4%9a%e6%80%8e%e4%b9%88%e5%8a%9e" class="tag-link-470" title="8 个话题" style="font-size: 8.5645161290323px;">参数太多怎么办</a>
<a href="http://www.importnew.com/tag/%e5%8f%8d%e5%b0%84" class="tag-link-301" title="10 个话题" style="font-size: 9.5806451612903px;">反射</a>
<a href="http://www.importnew.com/tag/%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6" class="tag-link-575" title="15 个话题" style="font-size: 11.387096774194px;">垃圾回收</a>
<a href="http://www.importnew.com/tag/%e5%9f%ba%e7%a1%80%e6%8a%80%e6%9c%af" class="tag-link-58" title="65 个话题" style="font-size: 18.387096774194px;">基础技术</a>
<a href="http://www.importnew.com/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b" class="tag-link-46" title="22 个话题" style="font-size: 13.193548387097px;">多线程</a>
<a href="http://www.importnew.com/tag/%e5%ad%97%e7%ac%a6%e4%b8%b2" class="tag-link-636" title="8 个话题" style="font-size: 8.5645161290323px;">字符串</a>
<a href="http://www.importnew.com/tag/%e5%ad%97%e8%8a%82%e7%a0%81" class="tag-link-38" title="8 个话题" style="font-size: 8.5645161290323px;">字节码</a>
<a href="http://www.importnew.com/tag/%e5%ae%89%e5%85%a8" class="tag-link-235" title="7 个话题" style="font-size: 8px;">安全</a>
<a href="http://www.importnew.com/tag/%e5%b7%a5%e5%85%b7" class="tag-link-126" title="7 个话题" style="font-size: 8px;">工具</a>
<a href="http://www.importnew.com/tag/%e5%b9%b6%e5%8f%91" class="tag-link-401" title="49 个话题" style="font-size: 17.032258064516px;">并发</a>
<a href="http://www.importnew.com/tag/%e5%b9%b6%e5%8f%91%e7%bc%96%e7%a8%8b" class="tag-link-64" title="26 个话题" style="font-size: 13.983870967742px;">并发编程</a>
<a href="http://www.importnew.com/tag/%e5%ba%8f%e5%88%97%e5%8c%96" class="tag-link-298" title="11 个话题" style="font-size: 10.032258064516px;">序列化</a>
<a href="http://www.importnew.com/tag/%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" class="tag-link-214" title="18 个话题" style="font-size: 12.290322580645px;">异常处理</a>
<a href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd" class="tag-link-47" title="17 个话题" style="font-size: 12.064516129032px;">性能</a>
<a href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96" class="tag-link-88" title="17 个话题" style="font-size: 12.064516129032px;">性能优化</a>
<a href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd%e8%b0%83%e4%bc%98" class="tag-link-282" title="9 个话题" style="font-size: 9.1290322580645px;">性能调优</a>
<a href="http://www.importnew.com/tag/%e6%95%99%e7%a8%8b" class="tag-link-156" title="17 个话题" style="font-size: 12.064516129032px;">教程</a>
<a href="http://www.importnew.com/tag/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" class="tag-link-283" title="12 个话题" style="font-size: 10.370967741935px;">数据结构</a>
<a href="http://www.importnew.com/tag/%e6%97%a5%e5%bf%97" class="tag-link-29" title="10 个话题" style="font-size: 9.5806451612903px;">日志</a>
<a href="http://www.importnew.com/tag/%e6%9e%b6%e6%9e%84" class="tag-link-139" title="9 个话题" style="font-size: 9.1290322580645px;">架构</a>
<a href="http://www.importnew.com/tag/%e6%b3%9b%e5%9e%8b" class="tag-link-246" title="15 个话题" style="font-size: 11.387096774194px;">泛型</a>
<a href="http://www.importnew.com/tag/%e6%b3%a8%e8%a7%a3" class="tag-link-360" title="13 个话题" style="font-size: 10.822580645161px;">注解</a>
<a href="http://www.importnew.com/tag/%e6%b5%8b%e8%af%95" class="tag-link-237" title="8 个话题" style="font-size: 8.5645161290323px;">测试</a>
<a href="http://www.importnew.com/tag/%e6%b8%b8%e6%88%8f" class="tag-link-184" title="9 个话题" style="font-size: 9.1290322580645px;">游戏</a>
<a href="http://www.importnew.com/tag/%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" class="tag-link-280" title="7 个话题" style="font-size: 8px;">源码分析</a>
<a href="http://www.importnew.com/tag/%e7%ae%97%e6%b3%95" class="tag-link-270" title="8 个话题" style="font-size: 8.5645161290323px;">算法</a>
<a href="http://www.importnew.com/tag/%e7%b1%bb%e5%8a%a0%e8%bd%bd" class="tag-link-556" title="7 个话题" style="font-size: 8px;">类加载</a>
<a href="http://www.importnew.com/tag/%e7%ba%bf%e7%a8%8b" class="tag-link-374" title="11 个话题" style="font-size: 10.032258064516px;">线程</a>
<a href="http://www.importnew.com/tag/%e7%ba%bf%e7%a8%8b%e6%b1%a0" class="tag-link-297" title="13 个话题" style="font-size: 10.822580645161px;">线程池</a>
<a href="http://www.importnew.com/tag/%e7%bc%93%e5%ad%98" class="tag-link-353" title="9 个话题" style="font-size: 9.1290322580645px;">缓存</a>
<a href="http://www.importnew.com/tag/%e8%99%9a%e6%8b%9f%e6%9c%ba" class="tag-link-685" title="11 个话题" style="font-size: 10.032258064516px;">虚拟机</a>
<a href="http://www.importnew.com/tag/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f" class="tag-link-30" title="52 个话题" style="font-size: 17.258064516129px;">设计模式</a>
<a href="http://www.importnew.com/tag/%e8%b5%84%e8%ae%af" class="tag-link-108" title="9 个话题" style="font-size: 9.1290322580645px;">资讯</a>
<a href="http://www.importnew.com/tag/%e9%9b%86%e5%90%88" class="tag-link-311" title="15 个话题" style="font-size: 11.387096774194px;">集合</a>
<a href="http://www.importnew.com/tag/%e9%9d%a2%e8%af%95" class="tag-link-31" title="23 个话题" style="font-size: 13.41935483871px;">面试</a>
<a href="http://www.importnew.com/tag/%e9%9d%a2%e8%af%95%e9%a2%98" class="tag-link-27" title="11 个话题" style="font-size: 10.032258064516px;">面试题</a></p></div></div></div><div id="text-18" class="widget widget_text">			<div class="textwidget"><p><a href="http://date.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=rightBanner-2&amp;utm_content=2015.9.16" target="_blank" class="external" rel="nofollow"><img src="./Java日志终极指南 - ImportNew_files/bfdcef89gw1esk2g5dvq1j208c03cglu.jpg"></a></p>
</div>
		</div><div id="recent_comments_widget-2" class="widget recent_comments_widget">		<h3 class="widget-title">最新评论</h3>
		<ul>
		
					
			<li id="rc-comment-561049" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/24254.html#comment-561049" rel="nofollow">Spring源码分析：Bean加载流程...</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				可以的, 转载请保留出处和原文链接								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-561048" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/7336.html#comment-561048" rel="nofollow">使用Java创建RESTful Web Se...</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				404-&gt;HTTP 404或Not Found错误信息是HTTP的其中一种“标准回应信息”（HTTP...								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-561047" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/25008.html#comment-561047" rel="nofollow">图解集合 1 ：ArrayList</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				可以动手实验的								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-561045" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/14841.html#comment-561045" rel="nofollow">Java 8：不要再用循环了</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				Hi，请到伯乐在线的小组发帖提问，支持微信登录。链接是： http://group.jobbole....								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-561043" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/25008.html#comment-561043" rel="nofollow">图解集合 1 ：ArrayList</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				可以列一下各版本的差别, 欢迎投稿								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-561042" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/25023.html#comment-561042" rel="nofollow">图解集合 2 ：LinkedList</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				没有特指								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-560954" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/25023.html#comment-560954" rel="nofollow">图解集合 2 ：LinkedList</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				这个系列是java哪个版本的？								<span class="rc-reviewer"> loong</span>
								</div>
			</li>
			
						
			<li id="rc-comment-560796" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="./Java日志终极指南 - ImportNew_files/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a class="rc-post" target="_blank" href="http://www.importnew.com/25008.html#comment-560796" rel="nofollow">图解集合 1 ：ArrayList</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				作者应该声明 JDK版本呀。 每个差别很大的 这个扩容方案								<span class="rc-reviewer"> 冷冷</span>
								</div>
			</li>
			
					
		</ul>
        </div><div id="text-19" class="widget widget_text">			<div class="textwidget"><p><a href="http://fanyi.jobbole.com/" target="_blank" class="external" rel="nofollow"><img src="./Java日志终极指南 - ImportNew_files/bfdcef89gw1esnyzyrczej208c03cgm3.jpg"></a></p>
</div>
		</div>	
	<!-- BEGIN .container -->
	<div class="container">
	
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<div class="clear"></div>
			
	</div>
	<!-- END .container -->

</div>
<!-- END #sidebar -->
<div class="clear"></div>	


</div>
<!-- END #wrapper -->

<!-- BEGIN footer -->
<footer>

	<!-- BEGIN .container -->
	<div class="container">
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-15" class="widget widget_text"><h3 class="widget-title">关于ImportNew</h3>			<div class="textwidget"><p>ImportNew 专注于 Java 技术分享。于2012年11月11日 11:11正式上线。是的，这是一个很特别的时刻 :) </p>
<p>ImportNew 由两个 Java 关键字 import 和 new 组成，意指：Java 开发者学习新知识的网站。 import 可认为是学习和吸收， new 则可认为是新知识、新技术圈子和新朋友……</p>
<div id="aw_socialcounter_widget-2" class="widget aw_socialcounter_widget">
<ul>
<li>
<a target="_blank" href="http://weibo.com/importnew" class="external" rel="nofollow"><img class="alignleft" src="./Java日志终极指南 - ImportNew_files/sina_32.png" alt="关注我们的新浪微博" title="关注我们的新浪微博"></a><p></p>
<div class="view-rss"><a target="_blank" href="http://www.importnew.com/feed/" class="rss-link"><img class="alignleft" src="./Java日志终极指南 - ImportNew_files/rss_32.png" alt="RSS订阅" title="RSS订阅"></a></div>
</li>
</ul>
</div>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-17" class="widget widget_text"><h3 class="widget-title">联系我们</h3>			<div class="textwidget"><p>Email：<a href="mailto:ImportNew.com@gmail.com">ImportNew.com@gmail.com</a><br>
新浪微博：<a href="http://weibo.com/importnew" target="_blank" class="external" rel="nofollow">@ImportNew</a><br>
推荐微信号<br>
<img src="./Java日志终极指南 - ImportNew_files/ImportNew_weixin.png" width="100" height="110"><img src="./Java日志终极指南 - ImportNew_files/android_weixin.png" width="100" height="110"><img src="./Java日志终极指南 - ImportNew_files/Linux_weixin.png" width="100" height="110"></p>
<p>反馈建议：ImportNew.com@gmail.com<br>
广告与商务合作QQ：2302462408 </p>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-16" class="widget widget_text"><h3 class="widget-title">推荐关注</h3>			<div class="textwidget"><p><a href="http://group.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">小组</a> – 好的话题、有启发的回复、值得信赖的圈子<br>
<a href="http://top.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">头条</a> – 写了文章？看干货？去头条！<br>
<a href="http://date.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">相亲</a> – 为IT单身男女服务的征婚传播平台<br>
<a href="http://hao.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">资源</a> – 优秀的工具资源导航<br>
<a href="http://fanyi.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">翻译</a> – 活跃 &amp; 专业的翻译小组<br>
<a href="http://blog.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">博客</a> – 国内外的精选博客文章<br>
<a href="http://design.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">设计</a> – UI,网页，交互和用户体验<br>
<a href="http://web.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">前端</a> – JavaScript, HTML5, CSS<br>
<a href="http://android.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">安卓</a> – 专注Android技术分享<br>
<a href="http://ios.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">iOS</a> – 专注iOS技术分享<br>
<a href="http://www.importnew.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank">Java</a> – 专注Java技术分享<br>
<a href="http://python.jobbole.com/?utm_source=www.importnew.com&amp;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">Python</a> – 专注Python技术分享</p>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<div class="clear"></div>
	
	</div>
	<!-- END .container -->

	<!-- BEGIN #bottom -->
	<div id="bottom">
	
		<!-- BEGIN .container -->
		<div class="container">
		
			<!-- BEGIN .grid-12 -->
			<div class="grid-12">
	
				<p>© 2017 ImportNew</p>
			
			</div>
			<!-- END .grid-12 -->
			
			<div class="clear"></div>
						
		</div>
		<!-- END .container -->
		
	</div>
	<!-- END #bottom -->
	
</footer>
<!-- END footer -->


	
<!-- Lightbox Plus v2.3 - 2011.08.11 - Message: 0-->
<script type="text/javascript">
jQuery(document).ready(function($){
  $("a[rel*=lightbox]").colorbox({opacity:0.8});
});
</script>

<!-- WP SyntaxHighlighter Ver.1.7.3 Begin -->
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shCore.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shLegacy.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shAutoloader.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushAppleScript.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushAS3.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushBash.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushColdFusion.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushCpp.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushCSharp.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushCss.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushDelphi.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushDiff.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushErlang.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushGroovy.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushJava.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushJavaFX.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushJScript.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushPerl.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushPhp.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushPlain.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushPowerShell.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushPython.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushRuby.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushSass.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushScala.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushSql.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushVb.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/shBrushXml.js.下载"></script>
<script type="text/javascript">//<![CDATA[
	SyntaxHighlighter.autoloader(
	"applescript	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAppleScript.js?ver=3.0"
	,"as3 actionscript3	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0"
	,"bash shell	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0"
	,"cf coldfusion	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0"
	,"cpp c	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0"
	,"c# c-sharp csharp	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0"
	,"css	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0"
	,"delphi pas pascal	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0"
	,"diff patch	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0"
	,"erl erlang	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0"
	,"groovy	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0"
	,"java	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0"
	,"jfx javafx	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0"
	,"js jscript javascript	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0"
	,"perl pl	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0"
	,"php	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0"
	,"plain text	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0"
	,"ps powershell	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0"
	,"py python	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0"
	,"rails ror ruby rb	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0"
	,"sass scss	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSass.js?ver=3.0"
	,"scala	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0"
	,"sql	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0"
	,"vb vbnet	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0"
	,"xml xhtml xslt html	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0"
	);
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['quick-code'] = true;
	SyntaxHighlighter.defaults['title'] = '';
	SyntaxHighlighter.defaults['class-name'] = 'notranslate';
	SyntaxHighlighter.defaults['collapse'] = false;
	SyntaxHighlighter.defaults['first-line'] = 1;
	SyntaxHighlighter.defaults['gutter'] = true;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['smart-tabs'] = true;
	SyntaxHighlighter.defaults['tab-size'] = 4;
	SyntaxHighlighter.defaults['toolbar'] = false;
 SyntaxHighlighter.config.stripBrs = true;
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = "Can't find brush for: ";
	SyntaxHighlighter.config.strings.brushNotHtmlScript = "Brush wasn't configured for html-script option: ";
	SyntaxHighlighter.all();
	dp.SyntaxHighlighter.HighlightAll('code')
//]]></script>
<!-- WP SyntaxHighlighter Ver.1.7.3 End -->
<link rel="stylesheet" id="wp_rp_scrollup-css" href="http://dtmvdvtzf8rz0.cloudfront.net/static/css-img/scrollup.css?ver=3.4.2" type="text/css" media="all">
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/ck-karma.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/jquery.colorbox-min.js.下载"></script>
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/www.importnew.com\/wp-admin\/admin-ajax.php","post_id":"16331"};
/* ]]> */
</script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/postviews-cache.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/ready.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/easing.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/superfish.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/validate.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/touchwipe.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/caroufredsel.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/flexslider.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/jplayer.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/fitvids.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/selectnav.js.下载"></script>
<script type="text/javascript" src="./Java日志终极指南 - ImportNew_files/effects.js.下载"></script>
<script type="text/javascript" src="http://dtmvdvtzf8rz0.cloudfront.net/static/js/scrollup.js?ver=3.4.2"></script>


<div id="full-btm" style="position:fixed; left:50%; top:550px;  z-index:100; text-align:center; cursor:pointer;">
<a><img src="./Java日志终极指南 - ImportNew_files/back-btm.png" width="20" border="0" alt="跳到底部" title="跳到底部"></a>
</div>

<script type="text/javascript">
jQuery('#full-btm').click(function(){
    jQuery('html, body').animate({scrollTop:jQuery(document).height()}, 'slow');
    return false;
});
</script>

<div id="full-top" style="position:fixed; left:50%; top:520px; margin-left:495px; z-index:100; text-align:center; cursor:pointer;">
<a><img src="./Java日志终极指南 - ImportNew_files/back-top.png" width="20" border="0" alt="返回顶部" title="返回顶部"></a>
</div>

<script type="text/javascript">
jQuery('#full-top').click(function(){
    jQuery('html, body').animate({scrollTop:0}, 'slow');
    return false;
});
</script>

<!-- script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','/_assets/js/analytics.js','ga');

    ga('create', 'UA-15621043-1', 'jobbole.com');
    ga('send', 'pageview');

</script -->


<!-- END body -->


<!-- END html -->
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

 Served from: importnew.com @ 2017-06-24 14:46:03 by W3 Total Cache --><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="padding-bottom: 50px; padding-right: 50px; display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div></body></html>