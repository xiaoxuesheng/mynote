!function(){function initAudio(){var t,e,r=document.getElementsByTagName("tt-audio");if(0!==r.length)for(t=0,e=r.length;e>t;t++){var n=r[t];showPlayer(n),getAudioUrl(n)}}function showPlayer(t){var e=t.getAttribute("data-id"),r=t.getAttribute("title"),n=t.getAttribute("time"),o=t.getAttribute("content"),i={id:e,title:r,time:formatSeconds(n),content:o,isIE8:isIE8};t.innerHTML=TEMPLATE(i)}function getAudioUrl(t){var e=t.getAttribute("data-id");http({method:"GET",type:"jsonp",url:"//i.snssdk.com/audio/urls/1/toutiao/mp4/"+e,success:function(e){try{var r=Base64.decode(e.data.audio_list.audio_1.main_url.replace(/\n/gi,""));playjplayer(t,r)}catch(n){loadError(t)}},error:function(){loadError(t)}})}function playjplayer(t,e){var r=this,n=t.getAttribute("data-id"),o=t.getAttribute("time"),i=t,a=i.querySelector(".audio-progress"),u=i.clientWidth,c=i.querySelector(".player"),d=document.createElement("audio");d.src=e,c.appendChild(d),d.addEventListener("timeupdate",function(){var t=this.currentTime,e=t/o*u;a.style.width=e+"px"}),d.addEventListener("pause",function(){this.currentTime=0,a.style.width="0",this.parentNode.parentNode.className="",r.isPlay=!1}),d.addEventListener("play",function(){this.parentNode.parentNode.className="play",r.isPlay=!0}),i.addEventListener("click",function(){if(r.currentId==n)r.isPlay?(d.pause(),d.currentTime=0):d.play();else{var t=document.getElementById(r.currentId);if(t){var e=t.getElementsByTagName("audio")[0];e.pause(),e.currentTime=0}d.play(),r.currentId=n}})}function loadError(t){var e=t.querySelector(".audio-error");e.innerHTML=errorInfo,t.addEventListener("click",function(){e.innerHTML="",getAudioUrl(this),this.removeEventListener("click",arguments.callee)})}function formatSeconds(t){var e="",r=parseInt(t),n=0;return r>60&&(n=parseInt(r/60),r=parseInt(r%60)),10>n&&(n="0"+n),n+=":",e+=n,10>r&&(r="0"+r),e+=r}!function(t){"use strict";var e,r=t.Base64,n="2.1.9";if("undefined"!=typeof module&&module.exports)try{e=require("buffer").Buffer}catch(o){}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(t){for(var e={},r=0,n=t.length;n>r;r++)e[t.charAt(r)]=r;return e}(i),u=String.fromCharCode,c=function(t){if(t.length<2){var e=t.charCodeAt(0);return 128>e?t:2048>e?u(192|e>>>6)+u(128|63&e):u(224|e>>>12&15)+u(128|e>>>6&63)+u(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return u(240|e>>>18&7)+u(128|e>>>12&63)+u(128|e>>>6&63)+u(128|63&e)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,s=function(t){return t.replace(d,c)},l=function(t){var e=[0,2,1][t.length%3],r=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),n=[i.charAt(r>>>18),i.charAt(r>>>12&63),e>=2?"=":i.charAt(r>>>6&63),e>=1?"=":i.charAt(63&r)];return n.join("")},f=t.btoa?function(e){return t.btoa(e)}:function(t){return t.replace(/[\s\S]{1,3}/g,l)},p=e?function(t){return(t.constructor===e.constructor?t:new e(t)).toString("base64")}:function(t){return f(s(t))},h=function(t,e){return e?p(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):p(String(t))},g=function(t){return h(t,!0)},v=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),A=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),r=e-65536;return u((r>>>10)+55296)+u((1023&r)+56320);case 3:return u((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return u((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},m=function(t){return t.replace(v,A)},y=function(t){var e=t.length,r=e%4,n=(e>0?a[t.charAt(0)]<<18:0)|(e>1?a[t.charAt(1)]<<12:0)|(e>2?a[t.charAt(2)]<<6:0)|(e>3?a[t.charAt(3)]:0),o=[u(n>>>16),u(n>>>8&255),u(255&n)];return o.length-=[0,0,2,1][r],o.join("")},_=t.atob?function(e){return t.atob(e)}:function(t){return t.replace(/[\s\S]{1,4}/g,y)},b=e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return m(_(t))},E=function(t){return b(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},C=function(){var e=t.Base64;return t.Base64=r,e};if(t.Base64={VERSION:n,atob:_,btoa:f,fromBase64:E,toBase64:h,utob:s,encode:h,encodeURI:g,btou:m,decode:E,noConflict:C},"function"==typeof Object.defineProperty){var B=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",B(function(){return E(this)})),Object.defineProperty(String.prototype,"toBase64",B(function(t){return h(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",B(function(){return h(this,!0)}))}}t.Meteor&&(Base64=t.Base64)}(this);var TEMPLATE=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",isIE8===!0&&(__p+='\n<div class="audio">\n'),__p+='\n    <div class="audio-top">\n        <p class="audio-title">'+(null==(__t=title)?"":__t)+'</p>\n        <p class="audio-time">'+(null==(__t=time)?"":__t)+'</p>\n    </div>\n    <div class="audio-content">'+(null==(__t=content)?"":__t)+'</div>\n    <div class="audio-progress"></div>\n    <div class="player" id="'+(null==(__t=id)?"":__t)+'"></div>\n    <p class="audio-error"></p>\n',isIE8===!0&&(__p+="\n</div>\n"),__p+="\n\n    \n\n\n";return __p},errorInfo="音频加载失败，请点击重试",userAgent=window.navigator.userAgent.toLowerCase(),isIE8=/msie 8\.0/i.test(userAgent);isIE8||initAudio()}(window,document,void 0);